===== Exp configuration =====

neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		2
nb_hiddens:		256
nb_steps:		200
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-26-16-41
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-26-16-41/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=256, bias=False)
      (V): Linear(in_features=256, out_features=256, bias=False)
      (norm): BatchNorm1d(256, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): ReadoutLayer(
      (W): Linear(in_features=256, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 251452

------ Begin training ------

Epoch 1: train loss=4.067061420530081, acc=0.18280294667119565, mean act rate=0.03987942636013031, lr=0.01, time=0:00:36.346145
Epoch 1: valid loss=2.5111386908425226, acc=0.26558554292929293, mean act rate=0.04565564543008804

Best model saved with valid acc=0.26558554292929293

-----------------------------

Epoch 2: train loss=1.3834924809634686, acc=0.5398533033288043, mean act rate=0.04626420512795448, lr=0.01, time=0:00:31.463499
Epoch 2: valid loss=1.529154121875763, acc=0.4895833333333333, mean act rate=0.04606225714087486

Best model saved with valid acc=0.4895833333333333

-----------------------------

Epoch 3: train loss=0.7793733486905694, acc=0.7433763586956521, mean act rate=0.04355641454458237, lr=0.01, time=0:00:31.220112
Epoch 3: valid loss=0.7954366207122803, acc=0.7367424242424243, mean act rate=0.04920647665858269

Best model saved with valid acc=0.7367424242424243

-----------------------------

Epoch 4: train loss=0.5128358947113156, acc=0.831070609714674, mean act rate=0.04794049263000488, lr=0.01, time=0:00:31.212065
Epoch 4: valid loss=0.6749040418201022, acc=0.7811316287878788, mean act rate=0.05752198398113251

Best model saved with valid acc=0.7811316287878788

-----------------------------

Epoch 5: train loss=0.36854817415587604, acc=0.8737209154211957, mean act rate=0.05429759621620178, lr=0.01, time=0:00:31.194040
Epoch 5: valid loss=0.45925115711159176, acc=0.8400804924242424, mean act rate=0.0577092282474041

Best model saved with valid acc=0.8400804924242424

-----------------------------

Epoch 6: train loss=0.2641103968489915, acc=0.9154901919157609, mean act rate=0.056233834475278854, lr=0.01, time=0:00:31.121438
Epoch 6: valid loss=0.5729475220044454, acc=0.8156171085858586, mean act rate=0.06487463414669037

-----------------------------

Epoch 7: train loss=0.20711351151112467, acc=0.9379192849864131, mean act rate=0.05843734368681908, lr=0.01, time=0:00:31.636169
Epoch 7: valid loss=0.48135684927304584, acc=0.8468276515151515, mean act rate=0.06109372898936272

Best model saved with valid acc=0.8468276515151515

-----------------------------

Epoch 8: train loss=0.14943742868490517, acc=0.9556247877038043, mean act rate=0.05762731283903122, lr=0.01, time=0:00:31.484600
Epoch 8: valid loss=0.5293281674385071, acc=0.827533143939394, mean act rate=0.06027327477931976

-----------------------------

Epoch 9: train loss=0.11491560394642875, acc=0.9693868885869565, mean act rate=0.059264861047267914, lr=0.01, time=0:00:31.991732
Epoch 9: valid loss=0.4172727291782697, acc=0.8736584595959597, mean act rate=0.061748456209897995

Best model saved with valid acc=0.8736584595959597

-----------------------------

Epoch 10: train loss=0.10408243967685848, acc=0.9706075917119565, mean act rate=0.05985818803310394, lr=0.01, time=0:00:31.543478
Epoch 10: valid loss=0.513329901629024, acc=0.8519570707070707, mean act rate=0.0632566586136818

-----------------------------

Epoch 11: train loss=0.18654897046508268, acc=0.9420909052309783, mean act rate=0.06111792474985123, lr=0.01, time=0:00:31.728837
Epoch 11: valid loss=0.37534213231669533, acc=0.8818655303030303, mean act rate=0.0625511035323143

Best model saved with valid acc=0.8818655303030303

-----------------------------

Epoch 12: train loss=0.09818687266670167, acc=0.9724386463994565, mean act rate=0.059372372925281525, lr=0.01, time=0:00:31.824353
Epoch 12: valid loss=0.40804563297165763, acc=0.8847853535353535, mean act rate=0.06134037300944328

Best model saved with valid acc=0.8847853535353535

-----------------------------

Epoch 13: train loss=0.07333968181046657, acc=0.9818115234375, mean act rate=0.05909934639930725, lr=0.01, time=0:00:31.690349
Epoch 13: valid loss=0.551371329360538, acc=0.846551452020202, mean act rate=0.06227893754839897

-----------------------------

Epoch 14: train loss=0.053651751833967865, acc=0.9868907099184783, mean act rate=0.059940747916698456, lr=0.01, time=0:00:31.745332
Epoch 14: valid loss=0.43009228507677716, acc=0.8836410984848485, mean act rate=0.06220166012644768

-----------------------------

Epoch 15: train loss=0.052050839833100326, acc=0.9853780995244565, mean act rate=0.06196551024913788, lr=0.01, time=0:00:32.222296
Epoch 15: valid loss=0.3138389165202777, acc=0.8998579545454546, mean act rate=0.06689023971557617

Best model saved with valid acc=0.8998579545454546

-----------------------------

Epoch 16: train loss=0.044865271454909816, acc=0.9883077870244565, mean act rate=0.06177487596869469, lr=0.01, time=0:00:31.842163
Epoch 16: valid loss=0.47158866541253197, acc=0.8647806186868687, mean act rate=0.06609854847192764

-----------------------------

Epoch 17: train loss=0.03657634256524034, acc=0.9898681640625, mean act rate=0.06156729534268379, lr=0.01, time=0:00:31.479270
Epoch 17: valid loss=0.6371651275290383, acc=0.8429608585858586, mean act rate=0.06378727406263351

-----------------------------

Epoch 18: train loss=0.03872840561962221, acc=0.9885519276494565, mean act rate=0.06132008135318756, lr=0.01, time=0:00:31.681726
Epoch 18: valid loss=0.557264068060451, acc=0.8549558080808081, mean act rate=0.061916738748550415

-----------------------------

Epoch 19: train loss=0.020490890798100736, acc=0.9951171875, mean act rate=0.06150371953845024, lr=0.006999999999999999, time=0:00:31.871563
Epoch 19: valid loss=0.3199687699476878, acc=0.907394255050505, mean act rate=0.06630386412143707

Best model saved with valid acc=0.907394255050505

-----------------------------

Epoch 20: train loss=0.015275810361345066, acc=0.99609375, mean act rate=0.06284735351800919, lr=0.006999999999999999, time=0:00:31.979226
Epoch 20: valid loss=0.6226754701799817, acc=0.8522332702020202, mean act rate=0.0646246001124382

-----------------------------

Epoch 21: train loss=0.014306860270153265, acc=0.9971923828125, mean act rate=0.06345467269420624, lr=0.006999999999999999, time=0:00:31.982422
Epoch 21: valid loss=0.5743464231491089, acc=0.8483664772727273, mean act rate=0.06772679090499878

-----------------------------

Epoch 22: train loss=0.015353254548244877, acc=0.99658203125, mean act rate=0.06497373431921005, lr=0.006999999999999999, time=0:00:32.052896
Epoch 22: valid loss=0.3946385011076927, acc=0.8847064393939393, mean act rate=0.06896228343248367

-----------------------------

Epoch 23: train loss=0.009705301461508498, acc=0.9986572265625, mean act rate=0.06620290875434875, lr=0.004899999999999999, time=0:00:32.631728
Epoch 23: valid loss=0.4003446482949787, acc=0.8883759469696969, mean act rate=0.0693730041384697

-----------------------------

Epoch 24: train loss=0.008154740535246674, acc=0.9984130859375, mean act rate=0.06657242029905319, lr=0.004899999999999999, time=0:00:32.071675
Epoch 24: valid loss=0.4075136159857114, acc=0.8888099747474747, mean act rate=0.06963790208101273

-----------------------------

Epoch 25: train loss=0.007284407010956784, acc=0.9991455078125, mean act rate=0.06673865020275116, lr=0.004899999999999999, time=0:00:32.927536
Epoch 25: valid loss=0.4448252585199144, acc=0.8797348484848485, mean act rate=0.06970176845788956

-----------------------------

Epoch 26: train loss=0.0060956884790357435, acc=0.9992198114809783, mean act rate=0.06664090603590012, lr=0.003429999999999999, time=0:00:32.040270
Epoch 26: valid loss=0.38572658681207234, acc=0.8965830176767676, mean act rate=0.06952304393053055

-----------------------------

Epoch 27: train loss=0.004739101175800897, acc=0.9996337890625, mean act rate=0.06660643965005875, lr=0.003429999999999999, time=0:00:32.060902
Epoch 27: valid loss=0.37126315219534767, acc=0.8970565025252526, mean act rate=0.06987712532281876

-----------------------------

Epoch 28: train loss=0.004811008970136754, acc=0.999267578125, mean act rate=0.06719215959310532, lr=0.003429999999999999, time=0:00:32.134011
Epoch 28: valid loss=0.41161610765589607, acc=0.8914535984848485, mean act rate=0.06998087465763092

-----------------------------

Epoch 29: train loss=0.0045161905964050675, acc=0.9993896484375, mean act rate=0.06686965376138687, lr=0.002400999999999999, time=0:00:31.887136
Epoch 29: valid loss=0.40088032682736713, acc=0.8925189393939394, mean act rate=0.07005017250776291

-----------------------------

Epoch 30: train loss=0.004915400289974059, acc=0.999267578125, mean act rate=0.06704298406839371, lr=0.002400999999999999, time=0:00:31.979153
Epoch 30: valid loss=0.436682248281108, acc=0.8864030934343434, mean act rate=0.06999889761209488

-----------------------------

Epoch 31: train loss=0.004329685464654176, acc=0.99951171875, mean act rate=0.06719924509525299, lr=0.002400999999999999, time=0:00:32.442036
Epoch 31: valid loss=0.4711592470606168, acc=0.8777619949494949, mean act rate=0.06994247436523438

-----------------------------

Epoch 32: train loss=0.004356347343673406, acc=0.999267578125, mean act rate=0.06709461659193039, lr=0.0016806999999999992, time=0:00:32.202747
Epoch 32: valid loss=0.3991021439433098, acc=0.8976878156565657, mean act rate=0.06990737468004227

-----------------------------

Epoch 33: train loss=0.003710522037181363, acc=0.99951171875, mean act rate=0.06689153611660004, lr=0.0016806999999999992, time=0:00:32.090750
Epoch 33: valid loss=0.40592116200261646, acc=0.8985558712121213, mean act rate=0.07034914195537567

-----------------------------

Epoch 34: train loss=0.0031970124946383294, acc=0.999755859375, mean act rate=0.06724349409341812, lr=0.0016806999999999992, time=0:00:32.123168
Epoch 34: valid loss=0.4004710622959667, acc=0.8922427398989898, mean act rate=0.07018126547336578

-----------------------------

Epoch 35: train loss=0.0028371767957651173, acc=1.0, mean act rate=0.06727690249681473, lr=0.0011764899999999994, time=0:00:32.166344
Epoch 35: valid loss=0.40653113938040203, acc=0.8881392045454546, mean act rate=0.07045750319957733

-----------------------------

Epoch 36: train loss=0.002354798665692215, acc=0.9998779296875, mean act rate=0.06747132539749146, lr=0.0011764899999999994, time=0:00:32.279652
Epoch 36: valid loss=0.4364364983306991, acc=0.8887705176767677, mean act rate=0.07039277255535126

-----------------------------

Epoch 37: train loss=0.003225718078283535, acc=0.999755859375, mean act rate=0.06748317927122116, lr=0.0011764899999999994, time=0:00:32.315252
Epoch 37: valid loss=0.4157148442334599, acc=0.8909801136363638, mean act rate=0.07039709389209747

-----------------------------

Epoch 38: train loss=0.002720001383750059, acc=0.9996337890625, mean act rate=0.06738872826099396, lr=0.0008235429999999996, time=0:00:32.116485
Epoch 38: valid loss=0.3970705419778824, acc=0.8914141414141414, mean act rate=0.07051227241754532

-----------------------------

Epoch 39: train loss=0.002496616380994965, acc=0.9996337890625, mean act rate=0.06747178733348846, lr=0.0008235429999999996, time=0:00:32.644667
Epoch 39: valid loss=0.44743453545702827, acc=0.889480744949495, mean act rate=0.07062951475381851

-----------------------------

Epoch 40: train loss=0.0024116609902193886, acc=1.0, mean act rate=0.06757071614265442, lr=0.0008235429999999996, time=0:00:32.246724
Epoch 40: valid loss=0.43424583392010796, acc=0.8912168560606061, mean act rate=0.07057446986436844

-----------------------------

Epoch 41: train loss=0.0021864484779143822, acc=0.9998779296875, mean act rate=0.06760647147893906, lr=0.0005764800999999997, time=0:00:32.530547
Epoch 41: valid loss=0.4245869608389007, acc=0.8925189393939394, mean act rate=0.0706818625330925

-----------------------------

Epoch 42: train loss=0.0026411931021357304, acc=0.9998779296875, mean act rate=0.06759345531463623, lr=0.0005764800999999997, time=0:00:32.390272
Epoch 42: valid loss=0.4231083136465814, acc=0.887310606060606, mean act rate=0.0705525130033493

-----------------------------

Epoch 43: train loss=0.0023993848808459006, acc=0.999755859375, mean act rate=0.06762184947729111, lr=0.0005764800999999997, time=0:00:32.417261
Epoch 43: valid loss=0.4194612138801151, acc=0.8942155934343435, mean act rate=0.07065276056528091

-----------------------------

Epoch 44: train loss=0.002654852040905098, acc=0.999755859375, mean act rate=0.06752610951662064, lr=0.00040353606999999974, time=0:00:32.109246
Epoch 44: valid loss=0.4299483895301819, acc=0.8879419191919191, mean act rate=0.07045421004295349

-----------------------------

Epoch 45: train loss=0.0024914252608141396, acc=1.0, mean act rate=0.06748667359352112, lr=0.00040353606999999974, time=0:00:32.388572
Epoch 45: valid loss=0.40675223370393115, acc=0.8918876262626263, mean act rate=0.0705271065235138

-----------------------------

Epoch 46: train loss=0.002680020308616804, acc=0.999755859375, mean act rate=0.06739633530378342, lr=0.00040353606999999974, time=0:00:32.264193
Epoch 46: valid loss=0.4346071978410085, acc=0.8892440025252526, mean act rate=0.07042954862117767

-----------------------------

Epoch 47: train loss=0.0028749876382789807, acc=0.99951171875, mean act rate=0.06736744195222855, lr=0.0002824752489999998, time=0:00:32.911600
Epoch 47: valid loss=0.4562503322958946, acc=0.8845091540404041, mean act rate=0.07036691904067993

-----------------------------

Epoch 48: train loss=0.002539958707529877, acc=0.999755859375, mean act rate=0.06733755022287369, lr=0.0002824752489999998, time=0:00:32.417561
Epoch 48: valid loss=0.465973190135426, acc=0.8864030934343434, mean act rate=0.07041198760271072

-----------------------------

Epoch 49: train loss=0.00218086556515118, acc=0.9998779296875, mean act rate=0.06734130531549454, lr=0.0002824752489999998, time=0:00:34.057727
Epoch 49: valid loss=0.4385492561591996, acc=0.8868371212121212, mean act rate=0.07037391513586044

-----------------------------

Epoch 50: train loss=0.0027399595728638815, acc=0.999755859375, mean act rate=0.06739465147256851, lr=0.00019773267429999984, time=0:00:32.958668
Epoch 50: valid loss=0.4346790528959698, acc=0.892282196969697, mean act rate=0.07045728713274002

-----------------------------


Best valid acc at epoch 19: 0.907394255050505


------ Training finished ------

Loading best model, epoch=19, valid acc=0.907394255050505

------ Begin Testing ------

Test loss=0.33169861551788116, acc=0.8989504419191918, mean act rate=0.0662214607000351

-----------------------------


This dataset uses the same split for validation and testing.

