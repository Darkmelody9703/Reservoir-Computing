===== Exp configuration =====
date:		08-19-19-38
save_dir:		./log/08-19-19-38
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		5
scheduler_patience:		5
scheduler_factor:		0.7
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		2.0
reg_fmin:		0.01
reg_fmax:		0.1
seed:		1692445093
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		batchnorm
train_input:		False
nb_hiddens:		1024
noise_test:		0.0
device:		cuda

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (norm_read): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1075280

**************  Trial 1  **************
Epoch 1: loss=14.9638|3.2978, acc=21.0765|6.7580, fr=0.3543, lr=0.0150, time=11.348406
-----------------------------

Epoch 2: loss=9.7661|2.8496, acc=12.3590|20.6714, fr=0.3911, lr=0.0150, time=09.536825
-----------------------------

Epoch 3: loss=9.1867|2.3318, acc=21.9103|30.3445, fr=0.3639, lr=0.0150, time=09.514406
-----------------------------

Epoch 4: loss=8.8042|1.8698, acc=32.1849|39.9293, fr=0.3526, lr=0.0150, time=09.539549
-----------------------------

Epoch 5: loss=8.6964|1.8306, acc=35.2501|41.5636, fr=0.3440, lr=0.0150, time=09.554012
-----------------------------

Epoch 6: loss=8.4054|1.3278, acc=43.5875|56.0954, fr=0.3412, lr=0.0150, time=09.488864
-----------------------------

Epoch 7: loss=8.1436|1.1482, acc=51.7901|62.5883, fr=0.3552, lr=0.0150, time=09.602692
-----------------------------

Epoch 8: loss=8.0204|0.9782, acc=58.5704|69.1696, fr=0.3606, lr=0.0150, time=09.541353
-----------------------------

Epoch 9: loss=7.9369|0.9549, acc=64.0142|70.4505, fr=0.3697, lr=0.0150, time=09.636933
-----------------------------

Epoch 10: loss=7.8640|0.8081, acc=66.5890|75.6625, fr=0.3729, lr=0.0150, time=09.573182
-----------------------------

Epoch 11: loss=7.8913|0.9024, acc=66.7852|72.3057, fr=0.3837, lr=0.0150, time=09.666835
-----------------------------

Epoch 12: loss=7.8154|0.7697, acc=70.3899|77.3852, fr=0.3751, lr=0.0150, time=10.530152
-----------------------------

Epoch 13: loss=7.6917|0.7115, acc=75.5640|78.6219, fr=0.3877, lr=0.0150, time=10.089264
-----------------------------

Epoch 14: loss=7.6723|0.6473, acc=76.3855|81.4046, fr=0.3777, lr=0.0150, time=09.706842
-----------------------------

Epoch 15: loss=7.6136|0.7154, acc=79.1442|78.8869, fr=0.3799, lr=0.0150, time=09.596493
-----------------------------

Epoch 16: loss=7.5989|0.6014, acc=79.4630|82.4205, fr=0.3885, lr=0.0150, time=09.563059
-----------------------------

Epoch 17: loss=7.5360|0.5753, acc=82.6508|83.4364, fr=0.3884, lr=0.0150, time=09.528409
-----------------------------

Epoch 18: loss=7.5099|0.5971, acc=83.8401|82.7739, fr=0.3929, lr=0.0150, time=09.601881
-----------------------------

Epoch 19: loss=7.4869|0.5497, acc=84.6126|84.8057, fr=0.3969, lr=0.0150, time=10.095241
-----------------------------

Epoch 20: loss=7.4490|0.5874, acc=86.3904|82.3322, fr=0.4006, lr=0.0150, time=10.889264
-----------------------------

Epoch 21: loss=7.4395|0.5912, acc=86.9053|83.1714, fr=0.4061, lr=0.0150, time=09.898610
-----------------------------

Epoch 22: loss=7.4280|0.5519, acc=87.5674|84.6290, fr=0.3993, lr=0.0150, time=09.573098
-----------------------------

Epoch 23: loss=7.4131|0.5919, acc=88.0579|83.9223, fr=0.4105, lr=0.0150, time=09.507220
-----------------------------

Epoch 24: loss=7.3805|0.5257, acc=89.4188|84.8940, fr=0.4188, lr=0.0150, time=10.614894
-----------------------------

Epoch 25: loss=7.3564|0.5671, acc=90.2648|83.9664, fr=0.4324, lr=0.0150, time=10.017121
-----------------------------

Epoch 26: loss=7.3512|0.5196, acc=90.7185|85.6007, fr=0.4453, lr=0.0150, time=09.583047

Best model saved with valid acc=85.60070671378092
-----------------------------

Epoch 27: loss=7.3541|0.5774, acc=89.7131|83.2155, fr=0.4542, lr=0.0150, time=09.619845
-----------------------------

Epoch 28: loss=7.3499|0.5266, acc=90.1790|85.3799, fr=0.4519, lr=0.0150, time=09.833518
-----------------------------

Epoch 29: loss=7.3458|0.6330, acc=90.5959|80.9629, fr=0.4432, lr=0.0150, time=10.095718
-----------------------------

Epoch 30: loss=7.3253|0.5153, acc=91.4174|85.1148, fr=0.4488, lr=0.0150, time=09.595595
-----------------------------

Epoch 31: loss=7.3243|0.5574, acc=91.5277|84.4965, fr=0.4666, lr=0.0150, time=10.309592
-----------------------------

Epoch 32: loss=7.3386|0.5842, acc=90.5468|84.8057, fr=0.4528, lr=0.0150, time=10.358448
-----------------------------

Epoch 33: loss=7.2842|0.6215, acc=93.0235|83.1272, fr=0.4586, lr=0.0105, time=10.306862
-----------------------------

Epoch 34: loss=7.2397|0.5429, acc=94.0657|84.0989, fr=0.4839, lr=0.0105, time=09.558692
-----------------------------

Epoch 35: loss=7.2233|0.4855, acc=94.4949|87.2350, fr=0.4929, lr=0.0105, time=09.780298

Best model saved with valid acc=87.23498233215548
-----------------------------

Epoch 36: loss=7.2263|0.5335, acc=94.5439|86.1749, fr=0.4792, lr=0.0105, time=10.043920
-----------------------------

Epoch 37: loss=7.2243|0.5552, acc=94.7033|85.3357, fr=0.4958, lr=0.0105, time=10.084166
-----------------------------

Epoch 38: loss=7.2353|0.5648, acc=94.7891|84.4965, fr=0.4997, lr=0.0105, time=10.680342
-----------------------------

Epoch 39: loss=7.2509|0.4678, acc=94.0780|87.1908, fr=0.4954, lr=0.0105, time=09.926209
-----------------------------

Epoch 40: loss=7.2333|0.5271, acc=95.0343|85.6007, fr=0.5055, lr=0.0105, time=10.066379
-----------------------------

Epoch 41: loss=7.2269|0.4819, acc=95.3409|87.0583, fr=0.5114, lr=0.0105, time=10.002204
-----------------------------

Epoch 42: loss=7.2053|0.5454, acc=95.9539|85.3357, fr=0.5335, lr=0.0073, time=10.054522
-----------------------------

Epoch 43: loss=7.1971|0.4916, acc=95.7945|87.1025, fr=0.5459, lr=0.0073, time=09.786603
-----------------------------

Epoch 44: loss=7.1819|0.4987, acc=96.0275|86.3516, fr=0.5591, lr=0.0073, time=09.907739
-----------------------------

Epoch 45: loss=7.1818|0.5204, acc=96.1256|86.1749, fr=0.5606, lr=0.0073, time=09.471768
-----------------------------

Epoch 46: loss=7.1748|0.5555, acc=96.1869|85.1590, fr=0.5691, lr=0.0073, time=09.611809
-----------------------------

Epoch 47: loss=7.1634|0.4646, acc=96.6282|87.7650, fr=0.5653, lr=0.0073, time=09.468843

Best model saved with valid acc=87.76501766784452
-----------------------------

Epoch 48: loss=7.1661|0.5326, acc=96.6650|86.0866, fr=0.5779, lr=0.0073, time=09.659692
-----------------------------

Epoch 49: loss=7.1680|0.5217, acc=96.1256|86.8816, fr=0.5806, lr=0.0073, time=09.508491
-----------------------------

Epoch 50: loss=7.1677|0.5385, acc=96.1378|85.1148, fr=0.5887, lr=0.0073, time=13.256214
-----------------------------

Epoch 51: loss=7.1656|0.5050, acc=96.2727|87.1025, fr=0.5855, lr=0.0073, time=09.924264
-----------------------------

Epoch 52: loss=7.1568|0.5474, acc=96.7509|85.1590, fr=0.5988, lr=0.0073, time=09.946986
-----------------------------

Epoch 53: loss=7.1558|0.5370, acc=96.7018|85.1148, fr=0.6024, lr=0.0073, time=09.716998
-----------------------------

Epoch 54: loss=7.1501|0.5494, acc=97.0819|85.5124, fr=0.5878, lr=0.0051, time=09.584190
-----------------------------

Epoch 55: loss=7.1306|0.5640, acc=97.5969|86.0424, fr=0.6126, lr=0.0051, time=09.707134
-----------------------------

Epoch 56: loss=7.1270|0.5139, acc=97.7808|86.2633, fr=0.6269, lr=0.0051, time=10.021667
-----------------------------

Epoch 57: loss=7.1264|0.5391, acc=97.5969|85.1148, fr=0.6319, lr=0.0051, time=10.157618
-----------------------------

Epoch 58: loss=7.1275|0.4913, acc=97.7685|87.5442, fr=0.6341, lr=0.0051, time=09.367515
-----------------------------

Epoch 59: loss=7.1189|0.4634, acc=98.0383|88.7809, fr=0.6384, lr=0.0051, time=10.109616

Best model saved with valid acc=88.78091872791519
-----------------------------

Epoch 60: loss=7.1250|0.5515, acc=97.7563|84.9382, fr=0.6407, lr=0.0051, time=10.054972
-----------------------------

Epoch 61: loss=7.1208|0.5079, acc=97.8666|86.5724, fr=0.6404, lr=0.0051, time=10.230888
-----------------------------

Epoch 62: loss=7.1162|0.5471, acc=97.9524|86.3958, fr=0.6490, lr=0.0051, time=09.438655
-----------------------------

Epoch 63: loss=7.1176|0.4987, acc=97.9156|86.8816, fr=0.6448, lr=0.0051, time=09.324378
-----------------------------

Epoch 64: loss=7.1173|0.4880, acc=98.0750|87.4558, fr=0.6547, lr=0.0051, time=09.644972
-----------------------------

Epoch 65: loss=7.1134|0.5152, acc=98.0383|87.3233, fr=0.6573, lr=0.0051, time=10.416198
-----------------------------

Epoch 66: loss=7.1153|0.5099, acc=97.8666|86.9700, fr=0.6385, lr=0.0036, time=10.284050
-----------------------------

Epoch 67: loss=7.1046|0.5226, acc=98.1609|86.2633, fr=0.6549, lr=0.0036, time=09.857817
-----------------------------

Epoch 68: loss=7.0993|0.5066, acc=98.3938|86.8816, fr=0.6678, lr=0.0036, time=10.044597
-----------------------------

Epoch 69: loss=7.1050|0.5110, acc=98.2344|86.8816, fr=0.6493, lr=0.0036, time=10.238928
-----------------------------

Epoch 70: loss=7.0983|0.5009, acc=98.3448|87.7650, fr=0.6705, lr=0.0036, time=09.935211
-----------------------------

Epoch 71: loss=7.0976|0.5312, acc=98.5777|86.8375, fr=0.6600, lr=0.0036, time=10.014529
-----------------------------

Epoch 72: loss=7.0948|0.5429, acc=98.6023|86.4399, fr=0.6673, lr=0.0025, time=09.650412
-----------------------------

Epoch 73: loss=7.0926|0.5097, acc=98.5655|87.4117, fr=0.6798, lr=0.0025, time=09.575167
-----------------------------

Epoch 74: loss=7.0915|0.5158, acc=98.4674|86.7491, fr=0.6801, lr=0.0025, time=09.941006
-----------------------------

Epoch 75: loss=7.0870|0.5642, acc=98.6023|85.7774, fr=0.6763, lr=0.0025, time=09.646826
-----------------------------

Epoch 76: loss=7.0866|0.5155, acc=98.7494|87.2792, fr=0.6796, lr=0.0025, time=09.766734
-----------------------------

Epoch 77: loss=7.0839|0.4956, acc=98.8475|87.7650, fr=0.6805, lr=0.0025, time=09.786761
-----------------------------

Epoch 78: loss=7.0827|0.5295, acc=98.8597|87.1025, fr=0.6909, lr=0.0018, time=09.754811
-----------------------------

Epoch 79: loss=7.0780|0.5106, acc=98.8843|86.8375, fr=0.6968, lr=0.0018, time=09.795783
-----------------------------

Epoch 80: loss=7.0787|0.5156, acc=98.7984|87.6325, fr=0.7004, lr=0.0018, time=10.151487
-----------------------------

Epoch 81: loss=7.0779|0.5394, acc=98.7984|86.7933, fr=0.7045, lr=0.0018, time=09.661698
-----------------------------

Epoch 82: loss=7.0788|0.5139, acc=98.7003|87.0141, fr=0.6992, lr=0.0018, time=09.898149
-----------------------------

Epoch 83: loss=7.0739|0.4890, acc=98.9701|87.5442, fr=0.7095, lr=0.0018, time=09.966129
-----------------------------

Epoch 84: loss=7.0749|0.5054, acc=99.0804|87.9859, fr=0.7068, lr=0.0012, time=09.690032
-----------------------------

Epoch 85: loss=7.0740|0.5120, acc=98.8475|86.8375, fr=0.7045, lr=0.0012, time=10.300351
-----------------------------

Epoch 86: loss=7.0716|0.4934, acc=99.2030|87.1908, fr=0.7107, lr=0.0012, time=10.159753
-----------------------------

Epoch 87: loss=7.0711|0.5104, acc=99.0804|87.8092, fr=0.7141, lr=0.0012, time=09.447822
-----------------------------

Epoch 88: loss=7.0679|0.5362, acc=99.1295|85.7774, fr=0.7180, lr=0.0012, time=09.914121
-----------------------------

Epoch 89: loss=7.0686|0.5373, acc=99.0069|86.6166, fr=0.7195, lr=0.0012, time=09.695216
-----------------------------

Epoch 90: loss=7.0662|0.5226, acc=99.2276|87.1025, fr=0.7262, lr=0.0009, time=09.868547
-----------------------------

Epoch 91: loss=7.0660|0.5214, acc=99.1295|86.4399, fr=0.7349, lr=0.0009, time=10.791688
-----------------------------

Epoch 92: loss=7.0659|0.5290, acc=98.9946|87.2792, fr=0.7328, lr=0.0009, time=09.556138
-----------------------------

Epoch 93: loss=7.0628|0.5284, acc=99.1663|87.7208, fr=0.7447, lr=0.0009, time=09.748538
-----------------------------

Epoch 94: loss=7.0609|0.5367, acc=99.2153|85.9982, fr=0.7519, lr=0.0009, time=09.549723
-----------------------------

Epoch 95: loss=7.0639|0.5206, acc=99.0436|87.0141, fr=0.7531, lr=0.0009, time=10.168659
-----------------------------

Epoch 96: loss=7.0618|0.5235, acc=99.2030|87.0583, fr=0.7597, lr=0.0006, time=10.385072
-----------------------------

Epoch 97: loss=7.0637|0.5076, acc=99.0682|87.8534, fr=0.7499, lr=0.0006, time=09.906427
-----------------------------

Epoch 98: loss=7.0583|0.5133, acc=99.1908|88.0300, fr=0.7633, lr=0.0006, time=09.613172
-----------------------------

Epoch 99: loss=7.0584|0.5338, acc=99.2521|86.7933, fr=0.7702, lr=0.0006, time=09.396203
-----------------------------

Epoch 100: loss=7.0576|0.5326, acc=99.2398|86.7933, fr=0.7727, lr=0.0006, time=09.293454
-----------------------------


Best valid acc at epoch 59: 88.78091872791519

------ Training finished ------


**************  Trial 2  **************
