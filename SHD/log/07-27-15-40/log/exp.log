===== Exp configuration =====
neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		3
nb_hiddens:		1024
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-27-15-40
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-27-15-40/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
dropout:		0.75
dropout_stop:		0.95
dropout_stepping:		0.04
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): RadLIFLayer(
      (W): Linear(in_features=1024, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (2): ReadoutLayer(
      (W): Linear(in_features=1024, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 3895356

------ Begin training ------

Epoch 1: train loss=1.883218890056014, acc=0.44851286514945654, fr=0.07665245980024338, lr=0.01, time=0:00:33.456846
Epoch 1: valid loss=1.2303345269627042, acc=0.6102035984848485, fr=0.08269529789686203, mask=0.875, time=0:00:04.323025

Best model saved with valid acc=0.6102035984848485

-----------------------------

Epoch 2: train loss=0.5378192006610334, acc=0.8270688264266304, fr=0.07744063436985016, lr=0.01, time=0:00:30.909241
Epoch 2: valid loss=0.6205656495359209, acc=0.8153803661616162, fr=0.08145594596862793, mask=0.8809070587158203, time=0:00:04.379868

Best model saved with valid acc=0.8153803661616162

-----------------------------

Epoch 3: train loss=0.27847550879232585, acc=0.9126825747282609, fr=0.07803674787282944, lr=0.01, time=0:00:30.795204
Epoch 3: valid loss=0.4740489655070835, acc=0.8591382575757576, fr=0.08373038470745087, mask=0.8857078552246094, time=0:00:04.493025

Best model saved with valid acc=0.8591382575757576

-----------------------------

Epoch 4: train loss=0.20501139643602073, acc=0.9323518172554348, fr=0.0775149017572403, lr=0.01, time=0:00:30.857598
Epoch 4: valid loss=0.3347370781832271, acc=0.8863241792929293, fr=0.07987659424543381, mask=0.8902416229248047, time=0:00:04.396283

Best model saved with valid acc=0.8863241792929293

-----------------------------

Epoch 5: train loss=0.14213651057798415, acc=0.9556460173233696, fr=0.07720571011304855, lr=0.01, time=0:00:29.146989
Epoch 5: valid loss=0.41163117521338993, acc=0.8782354797979798, fr=0.0803477019071579, mask=0.8945102691650391, time=0:00:04.394615

-----------------------------

Epoch 6: train loss=0.12212362786522135, acc=0.9620892068614131, fr=0.07559370994567871, lr=0.01, time=0:00:28.982770
Epoch 6: valid loss=0.31982554329766166, acc=0.8993055555555556, fr=0.0785398855805397, mask=0.8987979888916016, time=0:00:04.286883

Best model saved with valid acc=0.8993055555555556

-----------------------------

Epoch 7: train loss=0.08629315986763686, acc=0.973388671875, fr=0.07435121387243271, lr=0.01, time=0:00:29.169569
Epoch 7: valid loss=0.4227510434057977, acc=0.8769728535353535, fr=0.07762711495161057, mask=0.902862548828125, time=0:00:04.435353

-----------------------------

Epoch 8: train loss=0.06697965276543982, acc=0.9793966542119565, fr=0.07470390945672989, lr=0.01, time=0:00:29.142656
Epoch 8: valid loss=0.4848284787601895, acc=0.8717645202020202, fr=0.07809556275606155, mask=0.9067821502685547, time=0:00:04.371506

-----------------------------

Epoch 9: train loss=0.06768328850739636, acc=0.9772471552309783, fr=0.07366231083869934, lr=0.01, time=0:00:29.234612
Epoch 9: valid loss=0.4412653297185898, acc=0.8836410984848485, fr=0.07577282190322876, mask=0.9105367660522461, time=0:00:04.386192

-----------------------------

Epoch 10: train loss=0.044958739235880785, acc=0.9873046875, fr=0.07233481854200363, lr=0.006999999999999999, time=0:00:29.613434
Epoch 10: valid loss=0.5004223866595162, acc=0.8791429924242424, fr=0.07516844570636749, mask=0.9139785766601562, time=0:00:04.410229

-----------------------------

Epoch 11: train loss=0.027903115344088292, acc=0.9918212890625, fr=0.07173354923725128, lr=0.006999999999999999, time=0:00:31.317066
Epoch 11: valid loss=0.35564832472138935, acc=0.9055792297979798, fr=0.07446495443582535, mask=0.9174041748046875, time=0:00:05.995326

Best model saved with valid acc=0.9055792297979798

-----------------------------

Epoch 12: train loss=0.022598551971896086, acc=0.9938752547554348, fr=0.07169163227081299, lr=0.006999999999999999, time=0:00:36.811185
Epoch 12: valid loss=0.4601973270376523, acc=0.9007654671717172, fr=0.07489266991615295, mask=0.920689582824707, time=0:00:05.976356

-----------------------------

Epoch 13: train loss=0.01762678446539212, acc=0.9955577021059783, fr=0.0713840052485466, lr=0.006999999999999999, time=0:00:33.191733
Epoch 13: valid loss=0.3738742048541705, acc=0.9131549873737375, fr=0.07442952692508698, mask=0.9238166809082031, time=0:00:04.909005

Best model saved with valid acc=0.9131549873737375

-----------------------------

Epoch 14: train loss=0.021031366297393106, acc=0.9936788807744565, fr=0.07065728306770325, lr=0.006999999999999999, time=0:00:34.452063
Epoch 14: valid loss=0.53670348558161, acc=0.8847458964646465, fr=0.07345744967460632, mask=0.9268407821655273, time=0:00:04.952372

-----------------------------

Epoch 15: train loss=0.01698361303715501, acc=0.995361328125, fr=0.07075801491737366, lr=0.006999999999999999, time=0:00:29.168204
Epoch 15: valid loss=0.5336052229007086, acc=0.8836016414141414, fr=0.07373176515102386, mask=0.9298124313354492, time=0:00:04.437118

-----------------------------

Epoch 16: train loss=0.018482617890185793, acc=0.9948995838994565, fr=0.07073007524013519, lr=0.006999999999999999, time=0:00:29.523470
Epoch 16: valid loss=0.38807536992761826, acc=0.9137468434343435, fr=0.0736239030957222, mask=0.932612419128418, time=0:00:04.855560

Best model saved with valid acc=0.9137468434343435

-----------------------------

Epoch 17: train loss=0.014852555599645711, acc=0.995361328125, fr=0.0707390233874321, lr=0.006999999999999999, time=0:00:29.031116
Epoch 17: valid loss=0.4327511050634914, acc=0.9077099116161617, fr=0.07355353236198425, mask=0.9353628158569336, time=0:00:04.324530

-----------------------------

Epoch 18: train loss=0.015466969853150658, acc=0.99609375, fr=0.06987612694501877, lr=0.006999999999999999, time=0:00:28.534386
Epoch 18: valid loss=0.38364949491288924, acc=0.9116161616161617, fr=0.07249817997217178, mask=0.9379358291625977, time=0:00:04.310332

-----------------------------

Epoch 19: train loss=0.014531312894177972, acc=0.9962423573369565, fr=0.06922312080860138, lr=0.006999999999999999, time=0:00:30.530450
Epoch 19: valid loss=0.39545517414808273, acc=0.9103535353535354, fr=0.07269862294197083, mask=0.9404106140136719, time=0:00:04.732395

-----------------------------

Epoch 20: train loss=0.009703710824396694, acc=0.9971923828125, fr=0.06923048198223114, lr=0.004899999999999999, time=0:00:32.452801
Epoch 20: valid loss=0.3775136065151956, acc=0.9148910984848485, fr=0.07232262939214706, mask=0.9427785873413086, time=0:00:04.494778

Best model saved with valid acc=0.9148910984848485

-----------------------------

Epoch 21: train loss=0.009291917434893548, acc=0.9970225458559783, fr=0.06902922689914703, lr=0.004899999999999999, time=0:00:29.804156
Epoch 21: valid loss=0.4223782825801108, acc=0.9016335227272728, fr=0.07148145139217377, mask=0.9450969696044922, time=0:00:04.617567

-----------------------------

Epoch 22: train loss=0.005627110447676387, acc=0.99853515625, fr=0.06846215575933456, lr=0.004899999999999999, time=0:00:29.680816
Epoch 22: valid loss=0.3209226181109746, acc=0.9165877525252526, fr=0.07151023298501968, mask=0.9472436904907227, time=0:00:04.551521

Best model saved with valid acc=0.9165877525252526

-----------------------------

Epoch 23: train loss=0.006500837816020066, acc=0.9989013671875, fr=0.06838499009609222, lr=0.004899999999999999, time=0:00:29.855792
Epoch 23: valid loss=0.35310888704326415, acc=0.913983585858586, fr=0.07088707387447357, mask=0.9493169784545898, time=0:00:04.618159

-----------------------------

Epoch 24: train loss=0.005946069637047913, acc=0.998291015625, fr=0.0678773894906044, lr=0.004899999999999999, time=0:00:29.821677
Epoch 24: valid loss=0.3496888097789552, acc=0.9150883838383839, fr=0.07065429538488388, mask=0.9512958526611328, time=0:00:04.642057

-----------------------------

Epoch 25: train loss=0.004676450738770654, acc=0.9990499745244565, fr=0.06819045543670654, lr=0.004899999999999999, time=0:00:29.975694
Epoch 25: valid loss=0.4844798031780455, acc=0.8999368686868687, fr=0.07098174095153809, mask=0.9512958526611328, time=0:00:04.462970

-----------------------------

Epoch 26: train loss=0.009457841772018583, acc=0.9981689453125, fr=0.06745872646570206, lr=0.003429999999999999, time=0:00:29.763954
Epoch 26: valid loss=0.3442063070833683, acc=0.9214015151515151, fr=0.07044727355241776, mask=0.9512958526611328, time=0:00:04.502742

Best model saved with valid acc=0.9214015151515151

-----------------------------

Epoch 27: train loss=0.0061857554956077365, acc=0.9982432489809783, fr=0.06750399619340897, lr=0.003429999999999999, time=0:00:29.851082
Epoch 27: valid loss=0.3734465253849824, acc=0.9198626893939394, fr=0.07021525502204895, mask=0.9512958526611328, time=0:00:04.830244

-----------------------------

Epoch 28: train loss=0.004713527770036308, acc=0.9990234375, fr=0.06774437427520752, lr=0.003429999999999999, time=0:00:29.912871
Epoch 28: valid loss=0.3392758034169674, acc=0.9237294823232324, fr=0.07065606117248535, mask=0.9512958526611328, time=0:00:04.571348

Best model saved with valid acc=0.9237294823232324

-----------------------------

Epoch 29: train loss=0.0038192162232917326, acc=0.9991455078125, fr=0.06792070716619492, lr=0.003429999999999999, time=0:00:29.605573
Epoch 29: valid loss=0.3369198400113318, acc=0.919152462121212, fr=0.07065391540527344, mask=0.9512958526611328, time=0:00:04.610019

-----------------------------

Epoch 30: train loss=0.0021159203565730422, acc=0.999755859375, fr=0.06768814474344254, lr=0.003429999999999999, time=0:00:29.851541
Epoch 30: valid loss=0.40322700805134243, acc=0.912878787878788, fr=0.07035569846630096, mask=0.9512958526611328, time=0:00:04.595195

-----------------------------

Epoch 31: train loss=0.0016798736951386672, acc=0.999755859375, fr=0.06776639819145203, lr=0.003429999999999999, time=0:00:29.763635
Epoch 31: valid loss=0.326287102782064, acc=0.9211253156565657, fr=0.07063718140125275, mask=0.9512958526611328, time=0:00:04.507253

-----------------------------

Epoch 32: train loss=0.0020465489976686513, acc=0.999267578125, fr=0.06793726980686188, lr=0.002400999999999999, time=0:00:30.437660
Epoch 32: valid loss=0.39324085497193867, acc=0.9148516414141414, fr=0.07077784091234207, mask=0.9512958526611328, time=0:00:04.610548

-----------------------------

Epoch 33: train loss=0.0016066804346337449, acc=0.9998779296875, fr=0.06814500689506531, lr=0.002400999999999999, time=0:00:30.361216
Epoch 33: valid loss=0.32486631472905475, acc=0.9200599747474748, fr=0.07101990282535553, mask=0.9512958526611328, time=0:00:04.539792

-----------------------------

Epoch 34: train loss=0.001960943429139661, acc=0.9998779296875, fr=0.0680902823805809, lr=0.002400999999999999, time=0:00:29.757782
Epoch 34: valid loss=0.34006105611721676, acc=0.9215593434343435, fr=0.07084537297487259, mask=0.9512958526611328, time=0:00:04.584192

-----------------------------

Epoch 35: train loss=0.0014691428791593353, acc=0.9996337890625, fr=0.06803480535745621, lr=0.0016806999999999992, time=0:00:31.940088
Epoch 35: valid loss=0.30842825977338684, acc=0.9267676767676769, fr=0.07075851410627365, mask=0.9512958526611328, time=0:00:04.385103

Best model saved with valid acc=0.9267676767676769

-----------------------------

Epoch 36: train loss=0.0012200632761505403, acc=0.999755859375, fr=0.06797190010547638, lr=0.0016806999999999992, time=0:00:29.264167
Epoch 36: valid loss=0.3466694868273205, acc=0.9135495580808082, fr=0.07081849873065948, mask=0.9512958526611328, time=0:00:04.309908

-----------------------------

Epoch 37: train loss=0.002126097132986615, acc=0.99951171875, fr=0.0680384412407875, lr=0.0016806999999999992, time=0:00:29.851729
Epoch 37: valid loss=0.34000210670961273, acc=0.9219933712121213, fr=0.07091129571199417, mask=0.9512958526611328, time=0:00:04.929416

-----------------------------

Epoch 38: train loss=0.0013141733859356464, acc=0.9998779296875, fr=0.06814615428447723, lr=0.0016806999999999992, time=0:00:29.142960
Epoch 38: valid loss=0.32707730846272576, acc=0.9232954545454546, fr=0.07089397311210632, mask=0.9512958526611328, time=0:00:04.458640

-----------------------------

Epoch 39: train loss=0.0010665309112027899, acc=0.9998779296875, fr=0.06818261742591858, lr=0.0011764899999999994, time=0:00:28.912731
Epoch 39: valid loss=0.3490617457363341, acc=0.9213226010101009, fr=0.07101297378540039, mask=0.9512958526611328, time=0:00:04.369547

-----------------------------

Epoch 40: train loss=0.0006866413904162982, acc=1.0, fr=0.06812344491481781, lr=0.0011764899999999994, time=0:00:29.041647
Epoch 40: valid loss=0.3671027624772655, acc=0.9200599747474748, fr=0.07092946767807007, mask=0.9512958526611328, time=0:00:04.554111

-----------------------------

Epoch 41: train loss=0.0011720054787929257, acc=0.999755859375, fr=0.06818084418773651, lr=0.0011764899999999994, time=0:00:30.872885
Epoch 41: valid loss=0.3391817741923862, acc=0.923058712121212, fr=0.0709766298532486, mask=0.9512958526611328, time=0:00:04.555850

-----------------------------

Epoch 42: train loss=0.0008799950609272855, acc=1.0, fr=0.06823688745498657, lr=0.0008235429999999996, time=0:00:29.936371
Epoch 42: valid loss=0.35665051142374676, acc=0.9183238636363638, fr=0.071049265563488, mask=0.9512958526611328, time=0:00:04.537024

-----------------------------

Epoch 43: train loss=0.0007345888878944606, acc=1.0, fr=0.06826254725456238, lr=0.0008235429999999996, time=0:00:30.010495
Epoch 43: valid loss=0.35455867648124695, acc=0.9219933712121213, fr=0.07110217213630676, mask=0.9512958526611328, time=0:00:04.603449

-----------------------------

Epoch 44: train loss=0.0005902148802761076, acc=1.0, fr=0.06831999123096466, lr=0.0008235429999999996, time=0:00:29.863331
Epoch 44: valid loss=0.380905382335186, acc=0.9146148989898991, fr=0.07110672444105148, mask=0.9512958526611328, time=0:00:04.539138

-----------------------------

Epoch 45: train loss=0.0009447122856727219, acc=0.9998779296875, fr=0.06835480779409409, lr=0.0005764800999999997, time=0:00:30.929983
Epoch 45: valid loss=0.3797327068944772, acc=0.9198232323232324, fr=0.07116273045539856, mask=0.9512958526611328, time=0:00:04.791471

-----------------------------

Epoch 46: train loss=0.000943503878431784, acc=1.0, fr=0.06838157773017883, lr=0.0005764800999999997, time=0:00:33.480963
Epoch 46: valid loss=0.3724828213453293, acc=0.9154829545454546, fr=0.07118133455514908, mask=0.9512958526611328, time=0:00:04.785890

-----------------------------

Epoch 47: train loss=0.0007087524778626175, acc=0.9998779296875, fr=0.06842903792858124, lr=0.0005764800999999997, time=0:00:31.507577
Epoch 47: valid loss=0.35623431619670654, acc=0.9250315656565657, fr=0.07124347984790802, mask=0.9512958526611328, time=0:00:05.215881

-----------------------------

Epoch 48: train loss=0.0011458772401056194, acc=0.9996337890625, fr=0.06848607212305069, lr=0.00040353606999999974, time=0:00:31.686409
Epoch 48: valid loss=0.34245091925064725, acc=0.9187578914141414, fr=0.07123961299657822, mask=0.9512958526611328, time=0:00:04.726978

-----------------------------

Epoch 49: train loss=0.0007203053495459244, acc=1.0, fr=0.06849179416894913, lr=0.00040353606999999974, time=0:00:31.352987
Epoch 49: valid loss=0.34845877314607304, acc=0.9243607954545454, fr=0.07132147997617722, mask=0.9512958526611328, time=0:00:04.567228

-----------------------------

Epoch 50: train loss=0.0007058992257498176, acc=1.0, fr=0.06847742199897766, lr=0.00040353606999999974, time=0:00:30.449064
Epoch 50: valid loss=0.34800733046399224, acc=0.9202572601010102, fr=0.07126910984516144, mask=0.9512958526611328, time=0:00:04.528152

-----------------------------


Best valid acc at epoch 35: 0.9267676767676769


------ Training finished ------

Loading best model, epoch=35, valid acc=0.9267676767676769

------ Begin Testing ------

Test loss=0.3143303216331535, acc=0.9204940025252526, mean act rate=0.07071353495121002

-----------------------------


This dataset uses the same split for validation and testing.

