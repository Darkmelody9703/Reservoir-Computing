===== Exp configuration =====
date:		08-19-19-55
save_dir:		./log/08-19-19-55
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		1
scheduler_patience:		5
scheduler_factor:		0.7
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		2.0
reg_fmin:		0.01
reg_fmax:		0.1
seed:		1692446123
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		layernorm
train_input:		False
nb_hiddens:		1024
noise_test:		0.0
device:		cuda

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
  (norm_read): LayerNorm((20,), eps=1e-05, elementwise_affine=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1075280

**************  Trial 1  **************
Epoch 1: loss=20.7317|5.2200, acc=5.9711|5.0795, fr=0.3474, lr=0.0150, time=11.161364
-----------------------------

Epoch 2: loss=11.8669|4.2213, acc=6.2653|8.5689, fr=0.3195, lr=0.0150, time=10.084646
-----------------------------

Epoch 3: loss=11.0248|3.5018, acc=8.7052|10.4240, fr=0.3444, lr=0.0150, time=09.617575
-----------------------------

Epoch 4: loss=10.4024|3.0811, acc=11.5620|12.6325, fr=0.3252, lr=0.0150, time=09.696236
-----------------------------

Epoch 5: loss=10.1313|2.8716, acc=13.6709|23.0565, fr=0.3145, lr=0.0150, time=09.409449
-----------------------------

Epoch 6: loss=9.9947|2.6793, acc=22.0451|24.3816, fr=0.3070, lr=0.0150, time=09.403047
-----------------------------

Epoch 7: loss=9.7864|2.3550, acc=26.2261|33.7014, fr=0.3075, lr=0.0150, time=09.360212
-----------------------------

Epoch 8: loss=9.5768|2.1079, acc=31.7067|40.2385, fr=0.3264, lr=0.0150, time=09.346420
-----------------------------

Epoch 9: loss=9.4340|1.9758, acc=38.6096|39.5318, fr=0.3423, lr=0.0150, time=09.888822
-----------------------------

Epoch 10: loss=9.2837|1.7049, acc=43.5630|50.5742, fr=0.3531, lr=0.0150, time=09.539196
-----------------------------

Epoch 11: loss=9.1414|1.4796, acc=49.5709|55.1237, fr=0.3537, lr=0.0150, time=10.650135
-----------------------------

Epoch 12: loss=9.1678|1.4755, acc=49.8038|55.5212, fr=0.3801, lr=0.0150, time=10.529039
-----------------------------

Epoch 13: loss=8.8954|1.2724, acc=59.8455|61.3074, fr=0.3853, lr=0.0150, time=09.509406
-----------------------------

Epoch 14: loss=8.7246|1.1783, acc=64.4924|63.4717, fr=0.3922, lr=0.0150, time=09.355476
-----------------------------

Epoch 15: loss=8.6184|0.9927, acc=68.8082|69.6996, fr=0.4055, lr=0.0150, time=09.362012
-----------------------------

Epoch 16: loss=8.5178|0.9583, acc=73.3816|70.6714, fr=0.4106, lr=0.0150, time=09.831566
-----------------------------

Epoch 17: loss=8.4851|0.7839, acc=74.6567|78.1802, fr=0.4009, lr=0.0150, time=09.991044
-----------------------------

Epoch 18: loss=8.4081|0.7395, acc=79.3649|77.5618, fr=0.4045, lr=0.0150, time=09.602343
-----------------------------

Epoch 19: loss=8.3639|0.7296, acc=81.5228|78.4894, fr=0.4132, lr=0.0150, time=09.484222
-----------------------------

Epoch 20: loss=8.3113|0.6925, acc=84.1957|78.5777, fr=0.4149, lr=0.0150, time=09.650189
-----------------------------

Epoch 21: loss=8.2695|0.6214, acc=86.1084|82.2880, fr=0.4149, lr=0.0150, time=09.954214
-----------------------------

Epoch 22: loss=8.2205|0.6454, acc=86.9421|80.7862, fr=0.4272, lr=0.0150, time=09.874947
-----------------------------

Epoch 23: loss=8.1887|0.6228, acc=88.6219|83.0830, fr=0.4336, lr=0.0150, time=10.475666
-----------------------------

Epoch 24: loss=8.1574|0.6593, acc=89.2962|80.0353, fr=0.4444, lr=0.0150, time=10.176369
-----------------------------

Epoch 25: loss=8.1390|0.5686, acc=90.4120|84.2756, fr=0.4584, lr=0.0150, time=09.508748
-----------------------------

Epoch 26: loss=8.1199|0.6256, acc=91.2212|81.7580, fr=0.4581, lr=0.0150, time=09.841004
-----------------------------

Epoch 27: loss=8.0997|0.6039, acc=91.9814|83.1714, fr=0.4595, lr=0.0150, time=10.209375
-----------------------------

Epoch 28: loss=8.0947|0.5701, acc=92.4350|83.5247, fr=0.4529, lr=0.0150, time=10.179323
-----------------------------

Epoch 29: loss=8.0893|0.5295, acc=93.0848|85.1148, fr=0.4656, lr=0.0150, time=09.694572

Best model saved with valid acc=85.1148409893993
-----------------------------

Epoch 30: loss=8.0611|0.5474, acc=94.2374|85.1148, fr=0.4912, lr=0.0150, time=09.741230
-----------------------------

Epoch 31: loss=8.0542|0.5696, acc=94.7278|83.6572, fr=0.4915, lr=0.0150, time=09.774141
-----------------------------

Epoch 32: loss=8.0513|0.5777, acc=95.0589|83.2597, fr=0.4865, lr=0.0150, time=09.756599
-----------------------------

Epoch 33: loss=8.0439|0.5493, acc=94.9853|83.3039, fr=0.4910, lr=0.0150, time=10.791111
-----------------------------

Epoch 34: loss=8.0277|0.4870, acc=95.4144|87.1466, fr=0.5088, lr=0.0150, time=10.471551

Best model saved with valid acc=87.14664310954063
-----------------------------

Epoch 35: loss=8.0101|0.5106, acc=96.0642|87.3675, fr=0.5159, lr=0.0150, time=10.426715

Best model saved with valid acc=87.36749116607774
-----------------------------

Epoch 36: loss=8.0082|0.5473, acc=95.8190|85.3357, fr=0.5122, lr=0.0150, time=10.319731
-----------------------------

Epoch 37: loss=7.9915|0.5879, acc=96.1991|82.7739, fr=0.5065, lr=0.0150, time=09.881695
-----------------------------

Epoch 38: loss=7.9714|0.5451, acc=96.9348|84.7615, fr=0.5202, lr=0.0150, time=10.211173
-----------------------------

Epoch 39: loss=7.9759|0.5268, acc=96.9716|85.9541, fr=0.5420, lr=0.0150, time=10.577411
-----------------------------

Epoch 40: loss=7.9867|0.5652, acc=96.7263|84.8057, fr=0.5339, lr=0.0150, time=10.318434
-----------------------------

Epoch 41: loss=7.9757|0.5318, acc=97.5233|86.0424, fr=0.5458, lr=0.0150, time=10.038011
-----------------------------

Epoch 42: loss=7.9715|0.5328, acc=98.0996|86.0424, fr=0.5470, lr=0.0105, time=10.598807
-----------------------------

Epoch 43: loss=7.9531|0.5459, acc=98.1118|84.6290, fr=0.5540, lr=0.0105, time=10.345351
-----------------------------

Epoch 44: loss=7.9419|0.5343, acc=98.1486|85.7774, fr=0.5646, lr=0.0105, time=10.509463
-----------------------------

Epoch 45: loss=7.9401|0.5224, acc=98.4429|86.7491, fr=0.5718, lr=0.0105, time=09.640745
-----------------------------

Epoch 46: loss=7.9373|0.5281, acc=98.3448|85.7774, fr=0.5747, lr=0.0105, time=09.727774
-----------------------------

Epoch 47: loss=7.9428|0.5599, acc=98.3203|84.8940, fr=0.5652, lr=0.0105, time=10.232988
-----------------------------

Epoch 48: loss=7.9313|0.5200, acc=98.6145|87.2350, fr=0.5836, lr=0.0073, time=09.840997
-----------------------------

Epoch 49: loss=7.9230|0.5075, acc=98.7371|86.7491, fr=0.5922, lr=0.0073, time=11.416864
-----------------------------

Epoch 50: loss=7.9147|0.5445, acc=98.8352|85.9982, fr=0.6038, lr=0.0073, time=11.472452
-----------------------------

Epoch 51: loss=7.9187|0.5103, acc=99.0804|86.6166, fr=0.6035, lr=0.0073, time=10.637966
-----------------------------

Epoch 52: loss=7.9066|0.5185, acc=99.3011|86.6166, fr=0.6008, lr=0.0073, time=09.473470
-----------------------------

Epoch 53: loss=7.9097|0.5356, acc=99.1172|86.6608, fr=0.6012, lr=0.0073, time=09.467859
-----------------------------

Epoch 54: loss=7.9024|0.5297, acc=99.1172|86.5724, fr=0.6096, lr=0.0051, time=09.941290
-----------------------------

Epoch 55: loss=7.8936|0.4955, acc=99.4237|87.5442, fr=0.6267, lr=0.0051, time=09.566182

Best model saved with valid acc=87.54416961130742
-----------------------------

Epoch 56: loss=7.8968|0.5460, acc=99.2889|86.2191, fr=0.6295, lr=0.0051, time=09.832077
-----------------------------

Epoch 57: loss=7.8933|0.5170, acc=99.2153|86.8375, fr=0.6299, lr=0.0051, time=09.212805
-----------------------------

Epoch 58: loss=7.8926|0.5220, acc=99.4728|86.9258, fr=0.6219, lr=0.0051, time=09.485838
-----------------------------

Epoch 59: loss=7.8901|0.5174, acc=99.4483|86.3958, fr=0.6221, lr=0.0051, time=09.554702
-----------------------------

Epoch 60: loss=7.8882|0.5393, acc=99.4483|86.0866, fr=0.6279, lr=0.0051, time=09.745590
-----------------------------

Epoch 61: loss=7.8877|0.5259, acc=99.3747|87.3675, fr=0.6329, lr=0.0051, time=09.852991
-----------------------------

Epoch 62: loss=7.8852|0.5363, acc=99.5218|86.2191, fr=0.6346, lr=0.0036, time=09.744837
-----------------------------

Epoch 63: loss=7.8856|0.5131, acc=99.5586|87.1908, fr=0.6300, lr=0.0036, time=09.446115
-----------------------------

Epoch 64: loss=7.8816|0.5497, acc=99.5218|85.8657, fr=0.6301, lr=0.0036, time=09.764721
-----------------------------

Epoch 65: loss=7.8822|0.5144, acc=99.3624|87.3675, fr=0.6331, lr=0.0036, time=09.307304
-----------------------------

Epoch 66: loss=7.8804|0.5118, acc=99.5954|86.6166, fr=0.6340, lr=0.0036, time=10.317507
-----------------------------

Epoch 67: loss=7.8792|0.5129, acc=99.6199|87.0141, fr=0.6346, lr=0.0036, time=11.068183
-----------------------------

Epoch 68: loss=7.8756|0.5109, acc=99.6322|87.8092, fr=0.6439, lr=0.0025, time=10.147416

Best model saved with valid acc=87.80918727915194
-----------------------------

Epoch 69: loss=7.8735|0.5138, acc=99.6444|87.2350, fr=0.6405, lr=0.0025, time=10.595680
-----------------------------

Epoch 70: loss=7.8726|0.5093, acc=99.6567|87.9417, fr=0.6453, lr=0.0025, time=10.440423

Best model saved with valid acc=87.9416961130742
-----------------------------

Epoch 71: loss=7.8716|0.5030, acc=99.7303|88.1184, fr=0.6516, lr=0.0025, time=09.551609

Best model saved with valid acc=88.11837455830388
-----------------------------

Epoch 72: loss=7.8693|0.4970, acc=99.6812|88.0742, fr=0.6592, lr=0.0025, time=09.489138
-----------------------------

Epoch 73: loss=7.8683|0.5115, acc=99.6812|87.5442, fr=0.6602, lr=0.0025, time=09.375019
-----------------------------

Epoch 74: loss=7.8701|0.5135, acc=99.6444|87.5883, fr=0.6607, lr=0.0025, time=09.383156
-----------------------------

Epoch 75: loss=7.8689|0.5252, acc=99.7180|86.9258, fr=0.6571, lr=0.0025, time=09.391390
-----------------------------

Epoch 76: loss=7.8695|0.4887, acc=99.5831|88.5159, fr=0.6541, lr=0.0025, time=09.966795

Best model saved with valid acc=88.51590106007068
-----------------------------

Epoch 77: loss=7.8671|0.4842, acc=99.6199|88.3834, fr=0.6654, lr=0.0025, time=09.591733
-----------------------------

Epoch 78: loss=7.8661|0.4891, acc=99.6690|88.6042, fr=0.6692, lr=0.0025, time=09.357182

Best model saved with valid acc=88.60424028268551
-----------------------------

Epoch 79: loss=7.8653|0.5047, acc=99.7425|87.5442, fr=0.6721, lr=0.0025, time=09.499740
-----------------------------

Epoch 80: loss=7.8627|0.5162, acc=99.7303|87.1025, fr=0.6745, lr=0.0025, time=09.573535
-----------------------------

Epoch 81: loss=7.8615|0.5025, acc=99.7057|87.5442, fr=0.6851, lr=0.0025, time=10.077176
-----------------------------

Epoch 82: loss=7.8446|0.5133, acc=99.8038|87.9859, fr=0.6889, lr=0.0025, time=09.798974
-----------------------------

Epoch 83: loss=7.8400|0.5189, acc=99.8161|87.3675, fr=0.6930, lr=0.0025, time=09.909022
-----------------------------

Epoch 84: loss=7.8387|0.5032, acc=99.7670|88.3392, fr=0.6854, lr=0.0025, time=10.087922
-----------------------------

Epoch 85: loss=7.8373|0.4904, acc=99.7793|88.2951, fr=0.6988, lr=0.0018, time=09.861552
-----------------------------

Epoch 86: loss=7.8346|0.5142, acc=99.8038|87.7208, fr=0.7007, lr=0.0018, time=09.862256
-----------------------------

Epoch 87: loss=7.8351|0.5088, acc=99.7548|87.6767, fr=0.7100, lr=0.0018, time=09.625838
-----------------------------

Epoch 88: loss=7.8353|0.5035, acc=99.8161|87.4558, fr=0.7082, lr=0.0018, time=09.602441
-----------------------------

Epoch 89: loss=7.8338|0.5157, acc=99.7057|86.7933, fr=0.7109, lr=0.0018, time=09.372530
-----------------------------

Epoch 90: loss=7.8312|0.4987, acc=99.8651|87.6325, fr=0.7136, lr=0.0018, time=09.458817
-----------------------------

Epoch 91: loss=7.8312|0.5083, acc=99.8406|87.8534, fr=0.7169, lr=0.0012, time=09.637808
-----------------------------

Epoch 92: loss=7.8318|0.5093, acc=99.7793|87.4117, fr=0.7175, lr=0.0012, time=09.466630
-----------------------------

Epoch 93: loss=7.8305|0.5104, acc=99.7548|87.9417, fr=0.7212, lr=0.0012, time=09.512993
-----------------------------

Epoch 94: loss=7.8276|0.5087, acc=99.8651|88.1184, fr=0.7302, lr=0.0012, time=09.459141
-----------------------------

Epoch 95: loss=7.8275|0.5158, acc=99.8283|87.8092, fr=0.7373, lr=0.0012, time=09.852001
-----------------------------

Epoch 96: loss=7.8269|0.5286, acc=99.8529|87.0141, fr=0.7331, lr=0.0012, time=09.715364
-----------------------------

Epoch 97: loss=7.8262|0.5162, acc=99.8038|87.8975, fr=0.7390, lr=0.0009, time=09.500669
-----------------------------

Epoch 98: loss=7.8275|0.4982, acc=99.7916|87.5883, fr=0.7441, lr=0.0009, time=09.537789
-----------------------------

Epoch 99: loss=7.8262|0.5181, acc=99.8161|88.2951, fr=0.7329, lr=0.0009, time=09.576638
-----------------------------

Epoch 100: loss=7.8249|0.5065, acc=99.8406|87.5883, fr=0.7436, lr=0.0009, time=09.493979
-----------------------------


Best valid acc at epoch 78: 88.60424028268551

------ Training finished ------

