===== Exp configuration =====
neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		3
nb_hiddens:		1024
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-29-23-08
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-29-23-08/
dataset_name:		shd
data_folder:		data/raw/
batch_size:		128
nb_epochs:		50
dropout:		0.0
dropout_stop:		0.95
dropout_stepping:		0.02
ckpt_freq:		5
clustering:		False
noise_test:		0.2
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): RadLIFLayer(
      (W): Linear(in_features=1024, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (2): ReadoutLayer(
      (W): Linear(in_features=1024, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 3895356

------ Begin training ------

Epoch 1: train loss=2.1307, acc=0.3610, fr=0.1376, lr=0.0100, time=0:00:31.761712, cin=0.006847, 0.014987, cout=0.056574, 0.084697
Epoch 1: valid loss=1.6573, acc=0.5242, fr=0.1659, mask=0.8750, time=0:00:05.963758

Best model saved with valid acc=0.5241871843434344

-----------------------------

Epoch 2: train loss=0.6512, acc=0.7858, fr=0.1597, lr=0.0100, time=0:00:30.761093, cin=0.003683, 0.012588, cout=0.048583, 0.074345
Epoch 2: valid loss=0.5438, acc=0.8189, fr=0.1678, mask=0.8785, time=0:00:05.805295

Best model saved with valid acc=0.8188525883838385

-----------------------------

Epoch 3: train loss=0.3429, acc=0.8850, fr=0.1588, lr=0.0100, time=0:00:29.895912, cin=0.002687, 0.014356, cout=0.043392, 0.067416
Epoch 3: valid loss=0.9310, acc=0.7396, fr=0.1645, mask=0.8809, time=0:00:05.735996

-----------------------------

Epoch 4: train loss=0.2190, acc=0.9310, fr=0.1583, lr=0.0100, time=0:00:33.040285, cin=0.003154, 0.010716, cout=0.029780, 0.065239
Epoch 4: valid loss=0.6093, acc=0.8441, fr=0.1654, mask=0.8832, time=0:00:05.851712

Best model saved with valid acc=0.8440656565656566

-----------------------------

Epoch 5: train loss=0.1712, acc=0.9467, fr=0.1577, lr=0.0100, time=0:00:30.097028, cin=0.003315, 0.009305, cout=0.028268, 0.047906
Epoch 5: valid loss=0.4657, acc=0.8579, fr=0.1628, mask=0.8856, time=0:00:05.704081

Best model saved with valid acc=0.8578756313131313

-----------------------------

Epoch 6: train loss=0.1192, acc=0.9635, fr=0.1579, lr=0.0100, time=0:00:29.429958, cin=0.004224, 0.009973, cout=0.026243, 0.040879
Epoch 6: valid loss=0.5601, acc=0.8310, fr=0.1644, mask=0.8879, time=0:00:05.581275

-----------------------------

Epoch 7: train loss=0.1034, acc=0.9666, fr=0.1589, lr=0.0100, time=0:00:29.589999, cin=0.003177, 0.009416, cout=0.022659, 0.037063
Epoch 7: valid loss=0.5762, acc=0.8434, fr=0.1661, mask=0.8901, time=0:00:05.761104

-----------------------------

Epoch 8: train loss=0.0860, acc=0.9718, fr=0.1593, lr=0.0100, time=0:00:29.342445, cin=0.004038, 0.007364, cout=0.017276, 0.034954
Epoch 8: valid loss=0.8335, acc=0.7939, fr=0.1655, mask=0.8923, time=0:00:05.701167

-----------------------------

Epoch 9: train loss=0.0473, acc=0.9863, fr=0.1596, lr=0.0070, time=0:00:29.771967, cin=0.004192, 0.007433, cout=0.017090, 0.036017
Epoch 9: valid loss=0.3152, acc=0.9071, fr=0.1672, mask=0.8944, time=0:00:05.753034

Best model saved with valid acc=0.9070785984848485

-----------------------------

Epoch 10: train loss=0.0470, acc=0.9863, fr=0.1601, lr=0.0070, time=0:00:29.662229, cin=0.003710, 0.007215, cout=0.015465, 0.035984
Epoch 10: valid loss=0.8400, acc=0.8205, fr=0.1667, mask=0.8965, time=0:00:05.867946

-----------------------------

Epoch 11: train loss=0.0232, acc=0.9927, fr=0.1600, lr=0.0070, time=0:00:29.661995, cin=0.003231, 0.007670, cout=0.016872, 0.035893
Epoch 11: valid loss=0.3500, acc=0.9099, fr=0.1670, mask=0.8985, time=0:00:05.748178

Best model saved with valid acc=0.9099195075757576

-----------------------------

Epoch 12: train loss=0.0237, acc=0.9926, fr=0.1605, lr=0.0070, time=0:00:29.849933, cin=0.003458, 0.008114, cout=0.016740, 0.035512
Epoch 12: valid loss=0.4018, acc=0.8941, fr=0.1679, mask=0.9005, time=0:00:05.853873

-----------------------------

Epoch 13: train loss=0.0194, acc=0.9941, fr=0.1609, lr=0.0070, time=0:00:29.584455, cin=0.003789, 0.006857, cout=0.013990, 0.031112
Epoch 13: valid loss=0.4412, acc=0.8859, fr=0.1676, mask=0.9025, time=0:00:05.843782

-----------------------------

Epoch 14: train loss=0.0104, acc=0.9976, fr=0.1611, lr=0.0070, time=0:00:29.713948, cin=0.003445, 0.006651, cout=0.013284, 0.029713
Epoch 14: valid loss=0.4731, acc=0.8902, fr=0.1682, mask=0.9045, time=0:00:05.648057

-----------------------------

Epoch 15: train loss=0.0081, acc=0.9982, fr=0.1613, lr=0.0049, time=0:00:29.873222, cin=0.003190, 0.007095, cout=0.013530, 0.029139
Epoch 15: valid loss=0.3328, acc=0.9214, fr=0.1684, mask=0.9065, time=0:00:05.853997

Best model saved with valid acc=0.9213620580808082

-----------------------------

Epoch 16: train loss=0.0064, acc=0.9983, fr=0.1615, lr=0.0049, time=0:00:29.907440, cin=0.003033, 0.006842, cout=0.013708, 0.029000
Epoch 16: valid loss=0.3718, acc=0.9084, fr=0.1689, mask=0.9083, time=0:00:06.054171

-----------------------------

Epoch 17: train loss=0.0163, acc=0.9955, fr=0.1619, lr=0.0049, time=0:00:30.239467, cin=0.003787, 0.006174, cout=0.012901, 0.027803
Epoch 17: valid loss=0.4467, acc=0.8973, fr=0.1693, mask=0.9101, time=0:00:05.876632

-----------------------------

Epoch 18: train loss=0.0093, acc=0.9969, fr=0.1620, lr=0.0049, time=0:00:30.812020, cin=0.003857, 0.005574, cout=0.013188, 0.026920
Epoch 18: valid loss=0.6393, acc=0.8629, fr=0.1690, mask=0.9119, time=0:00:06.821795

-----------------------------

Epoch 19: train loss=0.0054, acc=0.9988, fr=0.1619, lr=0.0034, time=0:00:34.997914, cin=0.003480, 0.005316, cout=0.012807, 0.027096
Epoch 19: valid loss=0.4958, acc=0.9038, fr=0.1691, mask=0.9137, time=0:00:07.385585

-----------------------------

Epoch 20: train loss=0.0026, acc=0.9995, fr=0.1622, lr=0.0034, time=0:00:43.018438, cin=0.003673, 0.005231, cout=0.013095, 0.027645
Epoch 20: valid loss=0.3542, acc=0.9179, fr=0.1690, mask=0.9154, time=0:00:07.332771

-----------------------------

Epoch 21: train loss=0.0021, acc=0.9996, fr=0.1620, lr=0.0034, time=0:00:41.530503, cin=0.003743, 0.005532, cout=0.013233, 0.028163
Epoch 21: valid loss=0.5537, acc=0.8882, fr=0.1689, mask=0.9171, time=0:00:07.140225

-----------------------------

Epoch 22: train loss=0.0025, acc=0.9994, fr=0.1619, lr=0.0024, time=0:00:40.726385, cin=0.003838, 0.005492, cout=0.013284, 0.027903
Epoch 22: valid loss=0.5354, acc=0.8898, fr=0.1687, mask=0.9188, time=0:00:07.175535

-----------------------------

Epoch 23: train loss=0.0018, acc=0.9999, fr=0.1619, lr=0.0024, time=0:00:40.854151, cin=0.003763, 0.005331, cout=0.013435, 0.028118
Epoch 23: valid loss=0.4319, acc=0.9123, fr=0.1690, mask=0.9204, time=0:00:07.146601

-----------------------------

Epoch 24: train loss=0.0011, acc=0.9999, fr=0.1621, lr=0.0024, time=0:00:40.755014, cin=0.003875, 0.005320, cout=0.013705, 0.028047
Epoch 24: valid loss=0.4623, acc=0.9021, fr=0.1694, mask=0.9220, time=0:00:07.066524

-----------------------------

Epoch 25: train loss=0.0010, acc=0.9999, fr=0.1622, lr=0.0017, time=0:00:40.065361, cin=0.003940, 0.005300, cout=0.013555, 0.027864
Epoch 25: valid loss=0.4407, acc=0.9079, fr=0.1692, mask=0.9236, time=0:00:07.230931

-----------------------------

Epoch 26: train loss=0.0006, acc=1.0000, fr=0.1621, lr=0.0017, time=0:00:41.204609, cin=0.003933, 0.005266, cout=0.013510, 0.027841
Epoch 26: valid loss=0.4457, acc=0.9012, fr=0.1692, mask=0.9251, time=0:00:07.208262

-----------------------------

Epoch 27: train loss=0.0006, acc=1.0000, fr=0.1621, lr=0.0017, time=0:00:40.795192, cin=0.003833, 0.005218, cout=0.013487, 0.027923
Epoch 27: valid loss=0.4480, acc=0.9017, fr=0.1692, mask=0.9267, time=0:00:07.359462

-----------------------------

Epoch 28: train loss=0.0005, acc=1.0000, fr=0.1621, lr=0.0012, time=0:00:40.873566, cin=0.003799, 0.005173, cout=0.013481, 0.027970
Epoch 28: valid loss=0.4470, acc=0.9064, fr=0.1691, mask=0.9281, time=0:00:07.265481

-----------------------------

Epoch 29: train loss=0.0005, acc=1.0000, fr=0.1620, lr=0.0012, time=0:00:41.449948, cin=0.003814, 0.005194, cout=0.013479, 0.027915
Epoch 29: valid loss=0.4658, acc=0.9034, fr=0.1691, mask=0.9295, time=0:00:07.202768

-----------------------------

Epoch 30: train loss=0.0013, acc=0.9995, fr=0.1621, lr=0.0012, time=0:00:41.253206, cin=0.003895, 0.005080, cout=0.013557, 0.027489
Epoch 30: valid loss=0.4601, acc=0.9088, fr=0.1691, mask=0.9309, time=0:00:08.280157

-----------------------------

Epoch 31: train loss=0.0005, acc=1.0000, fr=0.1621, lr=0.0008, time=0:00:41.477836, cin=0.003893, 0.005069, cout=0.013555, 0.027491
Epoch 31: valid loss=0.4434, acc=0.9062, fr=0.1691, mask=0.9322, time=0:00:07.240450

-----------------------------

Epoch 32: train loss=0.0005, acc=1.0000, fr=0.1620, lr=0.0008, time=0:00:42.028008, cin=0.003860, 0.005085, cout=0.013569, 0.027489
Epoch 32: valid loss=0.4875, acc=0.9062, fr=0.1691, mask=0.9335, time=0:00:07.244553

-----------------------------

Epoch 33: train loss=0.0006, acc=1.0000, fr=0.1620, lr=0.0008, time=0:00:41.349628, cin=0.003857, 0.005043, cout=0.013541, 0.027554
Epoch 33: valid loss=0.4500, acc=0.9110, fr=0.1691, mask=0.9348, time=0:00:07.418165

-----------------------------

Epoch 34: train loss=0.0005, acc=1.0000, fr=0.1620, lr=0.0006, time=0:00:41.545551, cin=0.003881, 0.005024, cout=0.013532, 0.027574
Epoch 34: valid loss=0.4465, acc=0.9059, fr=0.1691, mask=0.9361, time=0:00:07.225961

-----------------------------

Epoch 35: train loss=0.0004, acc=1.0000, fr=0.1620, lr=0.0006, time=0:00:40.141471, cin=0.003880, 0.005038, cout=0.013541, 0.027571
Epoch 35: valid loss=0.4892, acc=0.9032, fr=0.1691, mask=0.9374, time=0:00:07.154088

-----------------------------

Epoch 36: train loss=0.0005, acc=0.9999, fr=0.1620, lr=0.0006, time=0:00:39.372664, cin=0.003857, 0.005021, cout=0.013548, 0.027559
Epoch 36: valid loss=0.4335, acc=0.9110, fr=0.1691, mask=0.9386, time=0:00:07.260441

-----------------------------

Epoch 37: train loss=0.0005, acc=0.9999, fr=0.1620, lr=0.0004, time=0:00:41.769176, cin=0.003885, 0.005014, cout=0.013555, 0.027555
Epoch 37: valid loss=0.4749, acc=0.9021, fr=0.1691, mask=0.9398, time=0:00:07.433784

-----------------------------

Epoch 38: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0004, time=0:00:40.655259, cin=0.003896, 0.005007, cout=0.013569, 0.027530
Epoch 38: valid loss=0.4698, acc=0.9092, fr=0.1692, mask=0.9410, time=0:00:07.368727

-----------------------------

Epoch 39: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0004, time=0:00:41.765739, cin=0.003906, 0.004980, cout=0.013542, 0.027536
Epoch 39: valid loss=0.4430, acc=0.9096, fr=0.1692, mask=0.9422, time=0:00:07.244736

-----------------------------

Epoch 40: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0003, time=0:00:41.804881, cin=0.003916, 0.004977, cout=0.013528, 0.027525
Epoch 40: valid loss=0.4582, acc=0.9045, fr=0.1692, mask=0.9434, time=0:00:07.317778

-----------------------------

Epoch 41: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0003, time=0:00:41.530208, cin=0.003916, 0.004983, cout=0.013535, 0.027519
Epoch 41: valid loss=0.4540, acc=0.9077, fr=0.1692, mask=0.9445, time=0:00:07.250305

-----------------------------

Epoch 42: train loss=0.0003, acc=1.0000, fr=0.1621, lr=0.0003, time=0:00:38.478610, cin=0.003916, 0.004985, cout=0.013540, 0.027511
Epoch 42: valid loss=0.4394, acc=0.9098, fr=0.1692, mask=0.9456, time=0:00:07.201437

-----------------------------

Epoch 43: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0002, time=0:00:39.913300, cin=0.003899, 0.004996, cout=0.013576, 0.027513
Epoch 43: valid loss=0.4239, acc=0.9090, fr=0.1692, mask=0.9467, time=0:00:07.307362

-----------------------------

Epoch 44: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0002, time=0:00:39.877009, cin=0.003887, 0.004999, cout=0.013557, 0.027517
Epoch 44: valid loss=0.4489, acc=0.9066, fr=0.1693, mask=0.9478, time=0:00:07.289178

-----------------------------

Epoch 45: train loss=0.0003, acc=1.0000, fr=0.1621, lr=0.0002, time=0:00:42.216215, cin=0.003886, 0.005007, cout=0.013537, 0.027520
Epoch 45: valid loss=0.4539, acc=0.9053, fr=0.1693, mask=0.9488, time=0:00:07.163245

-----------------------------

Epoch 46: train loss=0.0003, acc=1.0000, fr=0.1621, lr=0.0001, time=0:00:40.171665, cin=0.003885, 0.005004, cout=0.013526, 0.027523
Epoch 46: valid loss=0.4525, acc=0.9043, fr=0.1692, mask=0.9498, time=0:00:07.321410

-----------------------------

Epoch 47: train loss=0.0004, acc=1.0000, fr=0.1621, lr=0.0001, time=0:00:39.663280, cin=0.003882, 0.005011, cout=0.013513, 0.027525
Epoch 47: valid loss=0.4280, acc=0.9116, fr=0.1693, mask=0.9508, time=0:00:07.301699

-----------------------------

Epoch 48: train loss=0.0003, acc=1.0000, fr=0.1621, lr=0.0001, time=0:00:40.455698, cin=0.003883, 0.005008, cout=0.013511, 0.027519
Epoch 48: valid loss=0.4468, acc=0.9077, fr=0.1693, mask=0.9508, time=0:00:07.268600

-----------------------------

Epoch 49: train loss=0.0004, acc=0.9999, fr=0.1621, lr=0.0001, time=0:00:40.245147, cin=0.003884, 0.005009, cout=0.013514, 0.027520
Epoch 49: valid loss=0.4481, acc=0.9086, fr=0.1693, mask=0.9508, time=0:00:07.404439

-----------------------------

Epoch 50: train loss=0.0003, acc=1.0000, fr=0.1621, lr=0.0001, time=0:00:40.019837, cin=0.003887, 0.005005, cout=0.013510, 0.027514
Epoch 50: valid loss=0.4512, acc=0.9062, fr=0.1693, mask=0.9508, time=0:00:07.337221

-----------------------------


Best valid acc at epoch 15: 0.9213620580808082


------ Training finished ------

