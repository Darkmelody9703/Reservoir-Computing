===== Exp configuration =====

neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		2
nb_hiddens:		128
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-26-04-05
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-26-04-05/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=128, bias=False)
      (V): Linear(in_features=128, out_features=128, bias=False)
      (norm): BatchNorm1d(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): ReadoutLayer(
      (W): Linear(in_features=128, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 109372

------ Begin training ------

Epoch 1: train loss=2.465192737057805, acc=0.3285018257472826, mean act rate=0.02593136392533779, lr=0.01, time=0:00:25.075850
Epoch 1: valid loss=1.3685217963324652, acc=0.5362215909090909, mean act rate=0.03563597798347473

Best model saved with valid acc=0.5362215909090909

-----------------------------

Epoch 2: train loss=0.8116668132133782, acc=0.7523777173913043, mean act rate=0.048877742141485214, lr=0.01, time=0:00:21.770541
Epoch 2: valid loss=0.7517914142873552, acc=0.7531565656565656, mean act rate=0.07559866458177567

Best model saved with valid acc=0.7531565656565656

-----------------------------

Epoch 3: train loss=0.4339155671186745, acc=0.8632494055706521, mean act rate=0.07284094393253326, lr=0.01, time=0:00:21.954440
Epoch 3: valid loss=0.6232103142473433, acc=0.8178267045454546, mean act rate=0.08214635401964188

Best model saved with valid acc=0.8178267045454546

-----------------------------

Epoch 4: train loss=0.267629018984735, acc=0.912215523097826, mean act rate=0.08653032779693604, lr=0.01, time=0:00:21.132432
Epoch 4: valid loss=0.7581913206312392, acc=0.7548137626262625, mean act rate=0.08788201212882996

-----------------------------

Epoch 5: train loss=0.18440720613580197, acc=0.9443624745244565, mean act rate=0.08400087803602219, lr=0.01, time=0:00:21.192387
Epoch 5: valid loss=0.35625315374798244, acc=0.8791824494949495, mean act rate=0.08917755633592606

Best model saved with valid acc=0.8791824494949495

-----------------------------

Epoch 6: train loss=0.1342517610755749, acc=0.9591595193614131, mean act rate=0.08131439983844757, lr=0.01, time=0:00:21.123245
Epoch 6: valid loss=0.373658982415994, acc=0.8735006313131313, mean act rate=0.08426778763532639

-----------------------------

Epoch 7: train loss=0.12036871933378279, acc=0.9633099099864131, mean act rate=0.08396569639444351, lr=0.01, time=0:00:21.151483
Epoch 7: valid loss=0.4565534161196815, acc=0.8619791666666666, mean act rate=0.08278769999742508

-----------------------------

Epoch 8: train loss=0.09262098514591344, acc=0.9723643427309783, mean act rate=0.08154293894767761, lr=0.01, time=0:00:21.065022
Epoch 8: valid loss=0.537729960348871, acc=0.8498263888888888, mean act rate=0.08875387907028198

-----------------------------

Epoch 9: train loss=0.06511102383956313, acc=0.98046875, mean act rate=0.0839933305978775, lr=0.006999999999999999, time=0:00:21.283307
Epoch 9: valid loss=0.41835236301024753, acc=0.8799321338383838, mean act rate=0.08918075263500214

Best model saved with valid acc=0.8799321338383838

-----------------------------

Epoch 10: train loss=0.05562571641348768, acc=0.9835948114809783, mean act rate=0.08467820286750793, lr=0.006999999999999999, time=0:00:21.287208
Epoch 10: valid loss=0.45275650007857215, acc=0.8720407196969697, mean act rate=0.09084787964820862

-----------------------------

Epoch 11: train loss=0.048995700199157, acc=0.9839132557744565, mean act rate=0.0872124508023262, lr=0.006999999999999999, time=0:00:21.010128
Epoch 11: valid loss=0.4999740198254585, acc=0.8678582702020202, mean act rate=0.08903773874044418

-----------------------------

Epoch 12: train loss=0.042285041374270804, acc=0.9879415760869565, mean act rate=0.0860283151268959, lr=0.006999999999999999, time=0:00:20.954255
Epoch 12: valid loss=0.7315704673528671, acc=0.8227193813131313, mean act rate=0.08654805272817612

-----------------------------

Epoch 13: train loss=0.034815292558050714, acc=0.9910411005434783, mean act rate=0.0859442949295044, lr=0.004899999999999999, time=0:00:21.800586
Epoch 13: valid loss=0.33467839906613034, acc=0.901199494949495, mean act rate=0.091234490275383

Best model saved with valid acc=0.901199494949495

-----------------------------

Epoch 14: train loss=0.029446777574776206, acc=0.9920176630434783, mean act rate=0.08885426819324493, lr=0.004899999999999999, time=0:00:21.558288
Epoch 14: valid loss=0.42095545679330826, acc=0.8767361111111112, mean act rate=0.0925363153219223

-----------------------------

Epoch 15: train loss=0.0260396253579529, acc=0.9921875, mean act rate=0.09162244200706482, lr=0.004899999999999999, time=0:00:21.285322
Epoch 15: valid loss=0.5200582411554124, acc=0.8662799873737375, mean act rate=0.08995245397090912

-----------------------------

Epoch 16: train loss=0.024793164895527298, acc=0.9936788807744565, mean act rate=0.09002109616994858, lr=0.004899999999999999, time=0:00:21.450528
Epoch 16: valid loss=0.40527135216527516, acc=0.8836805555555556, mean act rate=0.09504338353872299

-----------------------------

Epoch 17: train loss=0.016377771215047687, acc=0.9971923828125, mean act rate=0.0911703035235405, lr=0.003429999999999999, time=0:00:21.344904
Epoch 17: valid loss=0.44461752391523784, acc=0.8779987373737375, mean act rate=0.09343733638525009

-----------------------------

Epoch 18: train loss=0.01538363848158042, acc=0.9967041015625, mean act rate=0.09171593189239502, lr=0.003429999999999999, time=0:00:21.241166
Epoch 18: valid loss=0.37420133997996646, acc=0.8888494318181819, mean act rate=0.09591352939605713

-----------------------------

Epoch 19: train loss=0.012723570067464607, acc=0.9970225458559783, mean act rate=0.0902324765920639, lr=0.003429999999999999, time=0:00:21.293012
Epoch 19: valid loss=0.3248399810658561, acc=0.9053424873737375, mean act rate=0.09215687215328217

Best model saved with valid acc=0.9053424873737375

-----------------------------

Epoch 20: train loss=0.01552533541325829, acc=0.996337890625, mean act rate=0.08930207788944244, lr=0.003429999999999999, time=0:00:21.288045
Epoch 20: valid loss=0.42009987350967193, acc=0.8864820075757576, mean act rate=0.09462244808673859

-----------------------------

Epoch 21: train loss=0.013621039979625493, acc=0.9961680536684783, mean act rate=0.09101325273513794, lr=0.003429999999999999, time=0:00:21.254399
Epoch 21: valid loss=0.41856781227721107, acc=0.8858112373737375, mean act rate=0.09330058842897415

-----------------------------

Epoch 22: train loss=0.016010434828785947, acc=0.9951914911684783, mean act rate=0.09109029918909073, lr=0.003429999999999999, time=0:00:21.634786
Epoch 22: valid loss=0.38923466040028465, acc=0.8968592171717172, mean act rate=0.09562568366527557

-----------------------------

Epoch 23: train loss=0.010108632662195305, acc=0.9979991083559783, mean act rate=0.09237593412399292, lr=0.002400999999999999, time=0:00:21.399066
Epoch 23: valid loss=0.4747514666782485, acc=0.8767755681818181, mean act rate=0.0949409157037735

-----------------------------

Epoch 24: train loss=0.007527040967033827, acc=0.99853515625, mean act rate=0.0925101712346077, lr=0.002400999999999999, time=0:00:21.472984
Epoch 24: valid loss=0.3855234525269932, acc=0.8886521464646465, mean act rate=0.09643436968326569

-----------------------------

Epoch 25: train loss=0.007681262855840032, acc=0.9991455078125, mean act rate=0.09268444776535034, lr=0.002400999999999999, time=0:00:21.726028
Epoch 25: valid loss=0.4726356425219112, acc=0.8780381944444444, mean act rate=0.0951920673251152

-----------------------------

Epoch 26: train loss=0.007260727406901424, acc=0.9984130859375, mean act rate=0.09225725382566452, lr=0.0016806999999999992, time=0:00:21.595722
Epoch 26: valid loss=0.3694087622894181, acc=0.897332702020202, mean act rate=0.09656587243080139

-----------------------------

Epoch 27: train loss=0.00748248021955078, acc=0.99853515625, mean act rate=0.09223698824644089, lr=0.0016806999999999992, time=0:00:21.700830
Epoch 27: valid loss=0.38782580114073223, acc=0.8942945075757576, mean act rate=0.09645113348960876

-----------------------------

Epoch 28: train loss=0.006061545062038931, acc=0.9986572265625, mean act rate=0.093279629945755, lr=0.0016806999999999992, time=0:00:21.517571
Epoch 28: valid loss=0.38681470768319237, acc=0.8921243686868687, mean act rate=0.09653487056493759

-----------------------------

Epoch 29: train loss=0.0060864204988320125, acc=0.9990234375, mean act rate=0.09368434548377991, lr=0.0011764899999999994, time=0:00:21.813810
Epoch 29: valid loss=0.39118228521611953, acc=0.8987926136363638, mean act rate=0.09776179492473602

-----------------------------

Epoch 30: train loss=0.005723251301787968, acc=0.9993896484375, mean act rate=0.09351301938295364, lr=0.0011764899999999994, time=0:00:21.184234
Epoch 30: valid loss=0.4138944256636832, acc=0.8877446338383838, mean act rate=0.09657471626996994

-----------------------------

Epoch 31: train loss=0.0053496217014981085, acc=0.9990234375, mean act rate=0.0935322642326355, lr=0.0011764899999999994, time=0:00:21.738228
Epoch 31: valid loss=0.388290007909139, acc=0.8938999368686869, mean act rate=0.09713157266378403

-----------------------------

Epoch 32: train loss=0.0043631293783619185, acc=0.99951171875, mean act rate=0.09386394917964935, lr=0.0008235429999999996, time=0:00:21.455219
Epoch 32: valid loss=0.39378540797366035, acc=0.8959517045454546, mean act rate=0.09762430936098099

-----------------------------

Epoch 33: train loss=0.003956285732783726, acc=0.999755859375, mean act rate=0.09436992555856705, lr=0.0008235429999999996, time=0:00:21.609828
Epoch 33: valid loss=0.39835641781489056, acc=0.8910195707070707, mean act rate=0.09890875965356827

-----------------------------

Epoch 34: train loss=0.0036719154013553634, acc=0.99951171875, mean act rate=0.09457512199878693, lr=0.0008235429999999996, time=0:00:21.580131
Epoch 34: valid loss=0.4252464820941289, acc=0.8858112373737375, mean act rate=0.09783072769641876

-----------------------------

Epoch 35: train loss=0.0040798725585773354, acc=0.9993896484375, mean act rate=0.09463748335838318, lr=0.0005764800999999997, time=0:00:21.524168
Epoch 35: valid loss=0.4099444780084822, acc=0.8925189393939394, mean act rate=0.09902732074260712

-----------------------------

Epoch 36: train loss=0.00409962241701578, acc=0.99951171875, mean act rate=0.09519735723733902, lr=0.0005764800999999997, time=0:00:21.616711
Epoch 36: valid loss=0.38732494910558063, acc=0.8888099747474747, mean act rate=0.09869170933961868

-----------------------------

Epoch 37: train loss=0.0034996592403331306, acc=0.999755859375, mean act rate=0.09518030285835266, lr=0.0005764800999999997, time=0:00:21.773796
Epoch 37: valid loss=0.43807389090458554, acc=0.8899147727272728, mean act rate=0.09928752481937408

-----------------------------

Epoch 38: train loss=0.00337050771304348, acc=0.99951171875, mean act rate=0.0953129455447197, lr=0.00040353606999999974, time=0:00:21.534316
Epoch 38: valid loss=0.40715239114231533, acc=0.8936237373737375, mean act rate=0.099419966340065

-----------------------------

Epoch 39: train loss=0.003552769389898458, acc=0.999755859375, mean act rate=0.09556002914905548, lr=0.00040353606999999974, time=0:00:21.825667
Epoch 39: valid loss=0.4052579113178783, acc=0.8918876262626263, mean act rate=0.09944350272417068

-----------------------------

Epoch 40: train loss=0.0027780281989180367, acc=0.999755859375, mean act rate=0.09548280388116837, lr=0.00040353606999999974, time=0:00:21.833759
Epoch 40: valid loss=0.384947060710854, acc=0.8942550505050506, mean act rate=0.09913436323404312

-----------------------------

Epoch 41: train loss=0.004242469284690742, acc=0.999267578125, mean act rate=0.09548056870698929, lr=0.0002824752489999998, time=0:00:21.289907
Epoch 41: valid loss=0.3835705295205116, acc=0.8902304292929293, mean act rate=0.09997785836458206

-----------------------------

Epoch 42: train loss=0.0034774817650031764, acc=0.999267578125, mean act rate=0.09591773897409439, lr=0.0002824752489999998, time=0:00:21.421547
Epoch 42: valid loss=0.3891354492968983, acc=0.8916903409090909, mean act rate=0.10001379996538162

-----------------------------

Epoch 43: train loss=0.003392532705220219, acc=0.99951171875, mean act rate=0.09593985229730606, lr=0.0002824752489999998, time=0:00:21.617283
Epoch 43: valid loss=0.4020530689093802, acc=0.8953598484848485, mean act rate=0.09944653511047363

-----------------------------

Epoch 44: train loss=0.0028156855687484494, acc=0.9996337890625, mean act rate=0.09596763551235199, lr=0.00019773267429999984, time=0:00:23.480617
Epoch 44: valid loss=0.4059891684187783, acc=0.8931897095959597, mean act rate=0.0996992439031601

-----------------------------

Epoch 45: train loss=0.003952814403419325, acc=0.99951171875, mean act rate=0.09573755413293839, lr=0.00019773267429999984, time=0:00:21.562274
Epoch 45: valid loss=0.3895689762300915, acc=0.8929924242424243, mean act rate=0.0994415357708931

-----------------------------

Epoch 46: train loss=0.0032091321763800806, acc=0.9998779296875, mean act rate=0.09572934359312057, lr=0.00019773267429999984, time=0:00:22.323841
Epoch 46: valid loss=0.377585312558545, acc=0.897293244949495, mean act rate=0.09973233938217163

-----------------------------

Epoch 47: train loss=0.0038545776797036524, acc=0.9991455078125, mean act rate=0.09561295807361603, lr=0.00013841287200999988, time=0:00:24.372713
Epoch 47: valid loss=0.400202467209763, acc=0.8977272727272728, mean act rate=0.09989262372255325

-----------------------------

