===== Exp configuration =====
date:		08-19-20-28
save_dir:		./log/08-19-20-28
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		1
scheduler_patience:		5
scheduler_factor:		0.7
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		2.0
reg_fmin:		0.01
reg_fmax:		0.1
seed:		1692448099
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		layernorm
train_input:		False
nb_hiddens:		1024
noise_test:		0.0
device:		cuda:0

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
  (norm_read): LayerNorm((20,), eps=1e-05, elementwise_affine=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1075280

**************  Trial 1  **************
Epoch 1: loss=36.5711|6.2213, acc=5.7381|5.2562, fr=0.5483, lr=0.0150, time=11.098063
-----------------------------

Epoch 2: loss=15.1121|5.1125, acc=5.3212|6.4929, fr=0.4260, lr=0.0150, time=09.673272
-----------------------------

Epoch 3: loss=9.0600|4.0374, acc=5.9956|6.8463, fr=0.3841, lr=0.0150, time=09.694894
-----------------------------

Epoch 4: loss=6.4064|3.6446, acc=6.6699|7.3763, fr=0.3566, lr=0.0150, time=10.223057
-----------------------------

Epoch 5: loss=6.1247|3.4972, acc=7.9696|8.7898, fr=0.3495, lr=0.0150, time=10.242256
-----------------------------

Epoch 6: loss=5.9440|3.5961, acc=7.2830|7.5530, fr=0.3504, lr=0.0150, time=10.209058
-----------------------------

Epoch 7: loss=5.9041|3.4940, acc=7.6753|7.8622, fr=0.3510, lr=0.0150, time=10.118455
-----------------------------

Epoch 8: loss=5.8866|3.4566, acc=8.2761|8.3481, fr=0.3518, lr=0.0150, time=09.953477
-----------------------------

Epoch 9: loss=5.8379|3.3404, acc=8.5826|11.0866, fr=0.3561, lr=0.0150, time=09.517363
-----------------------------

Epoch 10: loss=5.8500|3.3220, acc=8.5704|10.1590, fr=0.3540, lr=0.0150, time=09.398698
-----------------------------

Epoch 11: loss=5.7922|3.2650, acc=9.6003|9.9823, fr=0.3539, lr=0.0150, time=09.454281
-----------------------------

Epoch 12: loss=5.7843|3.3074, acc=9.9681|10.9099, fr=0.3508, lr=0.0150, time=09.781597
-----------------------------

Epoch 13: loss=5.8209|3.2710, acc=10.2011|9.8057, fr=0.3552, lr=0.0150, time=10.274660
-----------------------------

Epoch 14: loss=5.8304|3.3110, acc=9.5022|10.7332, fr=0.3580, lr=0.0150, time=09.450946
-----------------------------

Epoch 15: loss=5.8140|3.2694, acc=10.3114|9.9823, fr=0.3593, lr=0.0150, time=09.573078
-----------------------------

Epoch 16: loss=5.7994|3.2880, acc=10.3850|10.3799, fr=0.3592, lr=0.0105, time=09.401655
-----------------------------

Epoch 17: loss=5.8117|3.3105, acc=10.0539|10.8657, fr=0.3603, lr=0.0105, time=09.417924
-----------------------------

Epoch 18: loss=6.0039|3.3686, acc=9.9559|9.2314, fr=0.3606, lr=0.0105, time=09.384912
-----------------------------

Epoch 19: loss=6.0940|3.3109, acc=9.6371|9.8498, fr=0.3600, lr=0.0105, time=09.482181
-----------------------------

Epoch 20: loss=6.0560|3.2721, acc=8.8279|9.4523, fr=0.3580, lr=0.0105, time=09.379050
-----------------------------

Epoch 21: loss=6.0214|3.2793, acc=10.4708|9.9823, fr=0.3588, lr=0.0105, time=09.615690
-----------------------------

Epoch 22: loss=5.9980|3.1943, acc=9.8578|10.3799, fr=0.3589, lr=0.0073, time=09.440047
-----------------------------

Epoch 23: loss=5.9240|3.2021, acc=10.9245|12.2792, fr=0.3584, lr=0.0073, time=09.467046
-----------------------------

Epoch 24: loss=5.8959|3.1447, acc=10.8509|11.6608, fr=0.3573, lr=0.0073, time=09.510366
-----------------------------

Epoch 25: loss=5.9021|3.1316, acc=11.5620|12.0141, fr=0.3557, lr=0.0073, time=09.476162
-----------------------------

Epoch 26: loss=5.8733|3.1155, acc=11.4885|12.1025, fr=0.3557, lr=0.0073, time=09.434407
-----------------------------

Epoch 27: loss=5.8756|3.0599, acc=12.2364|12.9417, fr=0.3589, lr=0.0073, time=09.399264
-----------------------------

Epoch 28: loss=5.8806|3.0785, acc=12.0525|13.6484, fr=0.3601, lr=0.0073, time=09.416799
-----------------------------

Epoch 29: loss=5.9046|3.1112, acc=12.1260|11.7933, fr=0.3620, lr=0.0073, time=09.420229
-----------------------------

Epoch 30: loss=5.9537|3.1288, acc=11.7214|11.8816, fr=0.3634, lr=0.0073, time=09.410433
-----------------------------

Epoch 31: loss=5.9331|3.0971, acc=11.4762|11.3958, fr=0.3628, lr=0.0073, time=09.445779
-----------------------------

Epoch 32: loss=5.9618|3.1666, acc=11.3291|11.9258, fr=0.3638, lr=0.0073, time=09.563787
-----------------------------

Epoch 33: loss=5.9828|3.1576, acc=11.8440|11.7933, fr=0.3655, lr=0.0073, time=09.432764
-----------------------------

Epoch 34: loss=5.9578|3.1692, acc=12.3590|11.4841, fr=0.3621, lr=0.0073, time=09.483259
-----------------------------

Epoch 35: loss=5.9438|3.1563, acc=12.1506|11.2633, fr=0.3623, lr=0.0051, time=09.444345
-----------------------------

Epoch 36: loss=5.9381|3.1615, acc=12.3590|11.1749, fr=0.3642, lr=0.0051, time=09.374428
-----------------------------

Epoch 37: loss=5.9022|3.1206, acc=11.9789|13.0300, fr=0.3636, lr=0.0051, time=09.415642
-----------------------------

Epoch 38: loss=5.9155|3.1097, acc=12.7513|12.9859, fr=0.3658, lr=0.0051, time=09.420482
-----------------------------

Epoch 39: loss=5.9271|3.1207, acc=12.1015|12.6325, fr=0.3680, lr=0.0051, time=09.512461
-----------------------------

Epoch 40: loss=5.9075|3.1131, acc=12.9720|12.6325, fr=0.3685, lr=0.0051, time=09.574983
-----------------------------

Epoch 41: loss=5.9108|3.0901, acc=12.9475|13.1625, fr=0.3685, lr=0.0036, time=09.531748
-----------------------------

Epoch 42: loss=5.8818|3.0660, acc=13.0333|13.2951, fr=0.3675, lr=0.0036, time=09.424957
-----------------------------

Epoch 43: loss=5.9044|3.0730, acc=13.2540|12.8975, fr=0.3667, lr=0.0036, time=09.473038
-----------------------------

Epoch 44: loss=5.8748|3.0935, acc=12.7759|13.5159, fr=0.3660, lr=0.0036, time=09.449871
-----------------------------

Epoch 45: loss=5.8481|3.0708, acc=13.8303|13.9576, fr=0.3664, lr=0.0036, time=09.436629
-----------------------------

Epoch 46: loss=5.8514|3.0818, acc=13.9774|12.2350, fr=0.3681, lr=0.0036, time=09.435788
-----------------------------

Epoch 47: loss=5.8272|3.0651, acc=13.3276|12.8975, fr=0.3684, lr=0.0036, time=09.469947
-----------------------------

Epoch 48: loss=5.8120|3.0682, acc=13.4134|11.9258, fr=0.3674, lr=0.0036, time=09.394053
-----------------------------

Epoch 49: loss=5.7897|3.0540, acc=13.6954|13.1625, fr=0.3667, lr=0.0036, time=09.401892
-----------------------------

Epoch 50: loss=5.7820|3.0431, acc=13.4012|12.1025, fr=0.3659, lr=0.0036, time=09.502409
-----------------------------

Epoch 51: loss=5.7499|3.0152, acc=13.3644|13.6042, fr=0.3663, lr=0.0036, time=09.574135
-----------------------------

Epoch 52: loss=5.7562|3.0614, acc=13.3276|13.5601, fr=0.3662, lr=0.0025, time=09.430901
-----------------------------

Epoch 53: loss=5.7233|3.0116, acc=13.6096|13.6926, fr=0.3669, lr=0.0025, time=09.517743
-----------------------------

Epoch 54: loss=5.7220|2.9972, acc=14.1123|14.7527, fr=0.3671, lr=0.0025, time=09.433971
-----------------------------

Epoch 55: loss=5.7181|2.9955, acc=14.4556|14.2668, fr=0.3670, lr=0.0025, time=09.513218
-----------------------------

Epoch 56: loss=5.7176|2.9943, acc=13.9284|14.5760, fr=0.3666, lr=0.0025, time=09.447192
-----------------------------

Epoch 57: loss=5.7208|3.0302, acc=14.2349|14.4435, fr=0.3672, lr=0.0025, time=09.471607
-----------------------------

Epoch 58: loss=5.7266|3.0094, acc=13.8794|14.0018, fr=0.3670, lr=0.0025, time=09.426573
-----------------------------

Epoch 59: loss=5.6990|3.0130, acc=13.9652|12.8092, fr=0.3675, lr=0.0025, time=09.430492
-----------------------------

Epoch 60: loss=5.6945|3.0236, acc=14.3453|14.1784, fr=0.3684, lr=0.0025, time=09.393161
-----------------------------

Epoch 61: loss=5.6800|2.9787, acc=14.8234|13.4276, fr=0.3679, lr=0.0018, time=09.479947
-----------------------------

Epoch 62: loss=5.6696|2.9996, acc=15.0196|13.3834, fr=0.3680, lr=0.0018, time=09.406356
-----------------------------

Epoch 63: loss=5.6743|2.9856, acc=13.8916|15.1502, fr=0.3684, lr=0.0018, time=09.475185
-----------------------------

Epoch 64: loss=5.6979|3.0023, acc=13.9161|14.1784, fr=0.3692, lr=0.0018, time=09.424781
-----------------------------

Epoch 65: loss=5.6830|2.9117, acc=14.2104|16.2544, fr=0.3678, lr=0.0018, time=09.457954
-----------------------------

Epoch 66: loss=5.6923|2.9718, acc=14.1859|15.2385, fr=0.3671, lr=0.0018, time=09.397662
-----------------------------

Epoch 67: loss=5.6644|2.9620, acc=14.7131|14.9735, fr=0.3670, lr=0.0018, time=09.420550
-----------------------------

Epoch 68: loss=5.6761|3.0140, acc=14.3943|13.6484, fr=0.3681, lr=0.0018, time=09.540335
-----------------------------

Epoch 69: loss=5.6634|2.9752, acc=14.6886|14.4435, fr=0.3687, lr=0.0018, time=09.446765
-----------------------------

Epoch 70: loss=5.7055|2.9867, acc=14.1859|14.3110, fr=0.3704, lr=0.0018, time=09.490030
-----------------------------

Epoch 71: loss=5.6918|2.9879, acc=14.4924|13.2951, fr=0.3717, lr=0.0018, time=09.540252
-----------------------------

Epoch 72: loss=5.6768|2.9918, acc=14.4188|13.9134, fr=0.3718, lr=0.0012, time=09.380831
-----------------------------

Epoch 73: loss=5.6659|2.9938, acc=14.7744|14.6201, fr=0.3724, lr=0.0012, time=09.430498
-----------------------------

Epoch 74: loss=5.6820|2.9754, acc=14.1859|14.2668, fr=0.3720, lr=0.0012, time=09.403012
-----------------------------

Epoch 75: loss=5.6623|2.9539, acc=14.5782|14.7527, fr=0.3720, lr=0.0012, time=09.429082
-----------------------------

Epoch 76: loss=5.6592|3.0152, acc=14.5782|13.2067, fr=0.3708, lr=0.0012, time=09.469043
-----------------------------

Epoch 77: loss=5.6675|2.9513, acc=14.8847|14.4435, fr=0.3714, lr=0.0012, time=09.460077
-----------------------------

Epoch 78: loss=5.6759|2.9822, acc=14.8725|14.2668, fr=0.3722, lr=0.0009, time=09.471900
-----------------------------

Epoch 79: loss=5.6737|2.9791, acc=14.3821|14.9735, fr=0.3725, lr=0.0009, time=09.415182
-----------------------------

Epoch 80: loss=5.6419|2.9758, acc=14.9215|14.3110, fr=0.3725, lr=0.0009, time=09.398345
-----------------------------

Epoch 81: loss=5.6472|3.0097, acc=15.2648|14.8410, fr=0.3725, lr=0.0009, time=09.529049
-----------------------------

Epoch 82: loss=5.6483|2.9548, acc=15.3629|15.0618, fr=0.3725, lr=0.0009, time=09.501530
-----------------------------

Epoch 83: loss=5.6424|2.9758, acc=14.3207|15.1060, fr=0.3719, lr=0.0009, time=09.446423
-----------------------------

Epoch 84: loss=5.6357|2.9911, acc=15.1300|14.1343, fr=0.3721, lr=0.0006, time=09.479292
-----------------------------

Epoch 85: loss=5.6490|2.9764, acc=14.7008|14.8410, fr=0.3722, lr=0.0006, time=09.473044
-----------------------------

Epoch 86: loss=5.6308|2.9579, acc=15.0441|15.2827, fr=0.3726, lr=0.0006, time=09.447858
-----------------------------

Epoch 87: loss=5.6416|3.0024, acc=14.6518|14.1343, fr=0.3726, lr=0.0006, time=09.476901
-----------------------------

Epoch 88: loss=5.6293|2.9792, acc=14.6763|14.0459, fr=0.3725, lr=0.0006, time=09.422317
-----------------------------

Epoch 89: loss=5.6366|2.9336, acc=14.7254|14.7968, fr=0.3716, lr=0.0006, time=09.444151
-----------------------------

Epoch 90: loss=5.6358|2.9400, acc=15.2771|14.3110, fr=0.3715, lr=0.0004, time=09.417649
-----------------------------

Epoch 91: loss=5.6472|2.9668, acc=14.1246|15.5477, fr=0.3716, lr=0.0004, time=09.549883
-----------------------------

Epoch 92: loss=5.6470|2.9592, acc=14.9215|14.3993, fr=0.3715, lr=0.0004, time=09.504951
-----------------------------

Epoch 93: loss=5.6281|2.9594, acc=14.5047|15.5035, fr=0.3717, lr=0.0004, time=09.441995
-----------------------------

Epoch 94: loss=5.6367|2.9250, acc=14.3821|15.7244, fr=0.3719, lr=0.0004, time=09.479576
-----------------------------

Epoch 95: loss=5.6250|2.9482, acc=15.1300|14.2668, fr=0.3720, lr=0.0004, time=09.475437
-----------------------------

Epoch 96: loss=5.6350|2.9745, acc=15.0809|14.7968, fr=0.3720, lr=0.0003, time=09.442958
-----------------------------

Epoch 97: loss=5.6260|2.9314, acc=14.5292|14.2226, fr=0.3715, lr=0.0003, time=09.418892
-----------------------------

Epoch 98: loss=5.6153|2.9567, acc=14.9215|15.3269, fr=0.3716, lr=0.0003, time=09.422130
-----------------------------

Epoch 99: loss=5.6379|2.9847, acc=14.8970|14.3110, fr=0.3717, lr=0.0003, time=09.493450
-----------------------------

Epoch 100: loss=5.6199|2.9301, acc=14.9951|15.8127, fr=0.3718, lr=0.0003, time=09.433091
-----------------------------


Best valid acc at epoch 0: 85

------ Training finished ------

