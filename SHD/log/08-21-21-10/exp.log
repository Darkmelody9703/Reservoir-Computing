===== Exp configuration =====
date:		08-21-21-10
save_dir:		./log/08-21-21-10
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		5
scheduler_patience:		5
scheduler_factor:		0.7
lens:		0.5
gamma:		0.5
gradient_type:		linear
scale:		6.0
hight:		0.15
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
fr_ent:		0.1
seed:		1692623414
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		batchnorm
train_input:		True
nb_hiddens:		1024
noise_test:		0.0
device:		cuda:0

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (norm_read): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1793104

**************  Trial 1  **************
Epoch 0: cin|cout=0.001585|0.014457|9.1189
-----------------------------

Epoch 1: loss=7.5519|3.6451, acc=28.6538|22.3940, fr=0.3722, cin|cout=0.007325|0.029969|4.0913, lr=0.0150, time=11.988284
-----------------------------

Epoch 2: loss=4.1751|1.4358, acc=42.4595|64.0018, fr=0.3020, cin|cout=0.010018|0.033721|3.3660, lr=0.0150, time=10.478941
-----------------------------

Epoch 3: loss=3.0247|0.9186, acc=69.3600|77.2085, fr=0.3215, cin|cout=0.010888|0.035100|3.2236, lr=0.0150, time=11.337336
-----------------------------

Epoch 4: loss=2.5372|0.4830, acc=80.4684|87.3233, fr=0.3285, cin|cout=0.011225|0.035692|3.1797, lr=0.0150, time=11.309668

Best model saved with valid acc=87.32332155477032
-----------------------------

Epoch 5: loss=2.2735|0.4973, acc=89.6150|85.5565, fr=0.3559, cin|cout=0.011409|0.035970|3.1527, lr=0.0150, time=12.017577
-----------------------------

Epoch 6: loss=2.1854|0.4780, acc=93.3055|87.0141, fr=0.3629, cin|cout=0.011469|0.036558|3.1876, lr=0.0150, time=11.831083
-----------------------------

Epoch 7: loss=2.1373|0.3976, acc=95.0221|91.1219, fr=0.3595, cin|cout=0.011504|0.036698|3.1901, lr=0.0150, time=11.658024

Best model saved with valid acc=91.12190812720848
-----------------------------

Epoch 8: loss=2.0785|0.4160, acc=96.9716|89.3993, fr=0.3593, cin|cout=0.011556|0.036754|3.1805, lr=0.0150, time=11.823664
-----------------------------

Epoch 9: loss=2.0611|0.4216, acc=97.0942|90.6360, fr=0.3657, cin|cout=0.011554|0.036879|3.1919, lr=0.0150, time=11.627551
-----------------------------

Epoch 10: loss=2.0266|0.4343, acc=98.6268|89.8852, fr=0.3611, cin|cout=0.011598|0.036795|3.1724, lr=0.0150, time=10.746524
-----------------------------

Epoch 11: loss=2.0180|0.4502, acc=98.7494|88.2951, fr=0.3681, cin|cout=0.011612|0.037012|3.1874, lr=0.0150, time=10.390456
-----------------------------

Epoch 12: loss=1.9887|0.4086, acc=99.2766|91.1661, fr=0.3706, cin|cout=0.011608|0.037119|3.1977, lr=0.0150, time=10.440073

Best model saved with valid acc=91.1660777385159
-----------------------------

Epoch 13: loss=1.9749|0.4500, acc=99.5218|88.7367, fr=0.3703, cin|cout=0.011648|0.037162|3.1905, lr=0.0150, time=10.585153
-----------------------------

Epoch 14: loss=1.9604|0.4475, acc=99.6935|90.1502, fr=0.3744, cin|cout=0.011682|0.037150|3.1801, lr=0.0150, time=11.988417
-----------------------------

Epoch 15: loss=1.9490|0.4372, acc=99.8897|90.8569, fr=0.3783, cin|cout=0.011704|0.037129|3.1724, lr=0.0150, time=12.410132
-----------------------------

Epoch 16: loss=1.9441|0.4825, acc=99.8651|89.4876, fr=0.3765, cin|cout=0.011709|0.037138|3.1718, lr=0.0150, time=11.526019
-----------------------------

Epoch 17: loss=1.9361|0.4621, acc=99.9019|90.1502, fr=0.3818, cin|cout=0.011721|0.037246|3.1778, lr=0.0150, time=11.031759
-----------------------------

Epoch 18: loss=1.9271|0.4893, acc=99.9510|89.5318, fr=0.3893, cin|cout=0.011730|0.037332|3.1826, lr=0.0150, time=10.749166
-----------------------------

Epoch 19: loss=1.9199|0.4689, acc=99.9510|90.1060, fr=0.3931, cin|cout=0.011746|0.037284|3.1741, lr=0.0105, time=10.949249
-----------------------------

Epoch 20: loss=1.9146|0.4503, acc=99.9877|90.7686, fr=0.3934, cin|cout=0.011754|0.037391|3.1811, lr=0.0105, time=12.390404
-----------------------------

Epoch 21: loss=1.9120|0.4389, acc=99.9877|92.2703, fr=0.3945, cin|cout=0.011764|0.037438|3.1825, lr=0.0105, time=12.019565

Best model saved with valid acc=92.27031802120142
-----------------------------

Epoch 22: loss=1.9091|0.4784, acc=99.9755|90.1502, fr=0.3990, cin|cout=0.011775|0.037463|3.1815, lr=0.0105, time=11.890431
-----------------------------

Epoch 23: loss=1.9066|0.5048, acc=100.0000|90.2385, fr=0.4036, cin|cout=0.011780|0.037423|3.1767, lr=0.0105, time=11.713816
-----------------------------

