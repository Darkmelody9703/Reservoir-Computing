===== Exp configuration =====
date:		08-21-20-37
save_dir:		./log/08-21-20-37
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		5
scheduler_patience:		5
scheduler_factor:		0.7
lens:		0.5
gamma:		0.5
gradient_type:		MG
scale:		6.0
hight:		0.15
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
fr_ent:		0.1
seed:		1692621462
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		batchnorm
train_input:		True
nb_hiddens:		1024
noise_test:		0.0
device:		cuda:0

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (norm_read): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1793104

**************  Trial 1  **************
Epoch 0: cin|cout=0.001517|0.014186|9.3498
Epoch 1: loss=20.1549|3.8362, acc=13.3521|8.7898, fr=0.6517, cin|cout=0.005863|0.028736|4.9010, lr=0.0150, time=10.690787
-----------------------------

Epoch 2: loss=12.0755|2.0601, acc=24.6935|43.5512, fr=0.4308, cin|cout=0.007527|0.033585|4.4621, lr=0.0150, time=09.902002
-----------------------------

Epoch 3: loss=10.3087|1.2773, acc=45.9662|61.7491, fr=0.4438, cin|cout=0.008095|0.035186|4.3465, lr=0.0150, time=09.821280
-----------------------------

Epoch 4: loss=9.2953|0.9426, acc=59.5635|72.7032, fr=0.4410, cin|cout=0.008328|0.035761|4.2939, lr=0.0150, time=10.532749
-----------------------------

Epoch 5: loss=8.9610|0.7533, acc=69.1515|78.0035, fr=0.4356, cin|cout=0.008463|0.036186|4.2757, lr=0.0150, time=09.954676
-----------------------------

Epoch 6: loss=8.7943|0.6774, acc=76.7656|79.9028, fr=0.4356, cin|cout=0.008555|0.036489|4.2652, lr=0.0150, time=10.340702
-----------------------------

Epoch 7: loss=8.7049|0.6161, acc=79.8921|81.6696, fr=0.4340, cin|cout=0.008651|0.036788|4.2524, lr=0.0150, time=10.086796
-----------------------------

Epoch 8: loss=8.6172|0.5689, acc=83.7052|83.3039, fr=0.4308, cin|cout=0.008740|0.037013|4.2350, lr=0.0150, time=09.844517
-----------------------------

Epoch 9: loss=8.5398|0.5287, acc=86.9299|83.6572, fr=0.4300, cin|cout=0.008807|0.037153|4.2187, lr=0.0150, time=10.235527
-----------------------------

Epoch 10: loss=8.4957|0.4829, acc=89.0142|86.6166, fr=0.4293, cin|cout=0.008867|0.037252|4.2013, lr=0.0150, time=10.618071

Best model saved with valid acc=86.61660777385158
-----------------------------

Epoch 11: loss=8.4568|0.4715, acc=90.7921|86.7049, fr=0.4281, cin|cout=0.008930|0.037349|4.1823, lr=0.0150, time=10.276976

Best model saved with valid acc=86.70494699646643
-----------------------------

Epoch 12: loss=8.4359|0.5742, acc=91.5645|83.2155, fr=0.4277, cin|cout=0.008988|0.037452|4.1668, lr=0.0150, time=09.582677
-----------------------------

Epoch 13: loss=8.4214|0.5044, acc=92.0304|85.5565, fr=0.4251, cin|cout=0.009045|0.037477|4.1432, lr=0.0150, time=09.821614
-----------------------------

Epoch 14: loss=8.3961|0.5060, acc=92.8151|84.9823, fr=0.4233, cin|cout=0.009085|0.037576|4.1361, lr=0.0150, time=09.731671
-----------------------------

Epoch 15: loss=8.3653|0.4728, acc=93.8082|87.1025, fr=0.4231, cin|cout=0.009124|0.037704|4.1324, lr=0.0150, time=10.235720

Best model saved with valid acc=87.10247349823321
-----------------------------

Epoch 16: loss=8.3493|0.4803, acc=94.7278|86.7933, fr=0.4223, cin|cout=0.009161|0.037774|4.1232, lr=0.0150, time=09.818721
-----------------------------

Epoch 17: loss=8.3316|0.4710, acc=95.0956|87.0583, fr=0.4206, cin|cout=0.009198|0.037872|4.1173, lr=0.0150, time=09.970027
-----------------------------

Epoch 18: loss=8.3150|0.4642, acc=95.7577|87.7208, fr=0.4204, cin|cout=0.009242|0.038018|4.1138, lr=0.0150, time=10.055002

Best model saved with valid acc=87.72084805653711
-----------------------------

Epoch 19: loss=8.3065|0.5005, acc=96.2972|85.6890, fr=0.4204, cin|cout=0.009269|0.038197|4.1208, lr=0.0150, time=10.417218
-----------------------------

Epoch 20: loss=8.3122|0.5119, acc=95.5861|87.1908, fr=0.4189, cin|cout=0.009297|0.038357|4.1255, lr=0.0150, time=10.125028
-----------------------------

Epoch 21: loss=8.2958|0.4966, acc=96.6405|86.1307, fr=0.4179, cin|cout=0.009335|0.038450|4.1191, lr=0.0150, time=10.838478
-----------------------------

Epoch 22: loss=8.2967|0.4604, acc=96.6037|87.9417, fr=0.4159, cin|cout=0.009365|0.038494|4.1105, lr=0.0150, time=09.950408

Best model saved with valid acc=87.9416961130742
-----------------------------

Epoch 23: loss=8.2809|0.4368, acc=96.9593|88.8251, fr=0.4133, cin|cout=0.009392|0.038602|4.1100, lr=0.0150, time=10.260164

Best model saved with valid acc=88.82508833922262
-----------------------------

Epoch 24: loss=8.2730|0.4461, acc=97.1923|88.4276, fr=0.4125, cin|cout=0.009418|0.038667|4.1058, lr=0.0150, time=10.774106
-----------------------------

Epoch 25: loss=8.2536|0.4522, acc=97.9034|88.2067, fr=0.4128, cin|cout=0.009438|0.038720|4.1027, lr=0.0150, time=10.220059
-----------------------------

