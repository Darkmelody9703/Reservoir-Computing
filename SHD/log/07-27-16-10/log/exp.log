===== Exp configuration =====
neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		3
nb_hiddens:		1024
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-27-16-10
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-27-16-10/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
dropout:		0.0
dropout_stop:		0.95
dropout_stepping:		0.02
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): RadLIFLayer(
      (W): Linear(in_features=1024, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (2): ReadoutLayer(
      (W): Linear(in_features=1024, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 3895356

------ Begin training ------

Epoch 1: train loss=2.1748799178749323, acc=0.3384425951086957, fr=0.10561861842870712, lr=0.01, time=0:00:31.576240
Epoch 1: valid loss=2.5747444298532276, acc=0.3871133207070707, fr=0.11385424435138702, mask=0.875, time=0:00:04.158189

Best model saved with valid acc=0.3871133207070707

-----------------------------

Epoch 2: train loss=0.7351985783316195, acc=0.7533648947010869, fr=0.10990419238805771, lr=0.01, time=0:00:28.339022
Epoch 2: valid loss=1.2546332842773862, acc=0.6538431186868687, fr=0.11829133331775665, mask=0.8785104751586914, time=0:00:04.108265

Best model saved with valid acc=0.6538431186868687

-----------------------------

Epoch 3: train loss=0.38458540942519903, acc=0.8727921195652174, fr=0.11256906390190125, lr=0.01, time=0:00:28.379409
Epoch 3: valid loss=0.7879834605587853, acc=0.770123106060606, fr=0.11840137094259262, mask=0.8809776306152344, time=0:00:04.257414

Best model saved with valid acc=0.770123106060606

-----------------------------

Epoch 4: train loss=0.2546835548710078, acc=0.918563179347826, fr=0.11320490390062332, lr=0.01, time=0:00:28.570328
Epoch 4: valid loss=0.6631183723608652, acc=0.8099747474747475, fr=0.11789917945861816, mask=0.8832969665527344, time=0:00:04.242878

Best model saved with valid acc=0.8099747474747475

-----------------------------

Epoch 5: train loss=0.18154061929089949, acc=0.9432373046875, fr=0.11319797486066818, lr=0.01, time=0:00:29.033722
Epoch 5: valid loss=0.39389759881628883, acc=0.877801452020202, fr=0.11819939315319061, mask=0.8856611251831055, time=0:00:04.219172

Best model saved with valid acc=0.877801452020202

-----------------------------

Epoch 6: train loss=0.15255921485368162, acc=0.9511506453804348, fr=0.1141500249505043, lr=0.01, time=0:00:28.611267
Epoch 6: valid loss=0.557064887550142, acc=0.8285195707070707, fr=0.11927428096532822, mask=0.8879432678222656, time=0:00:04.244236

-----------------------------

Epoch 7: train loss=0.11675906390883029, acc=0.9631135360054348, fr=0.11511516571044922, lr=0.01, time=0:00:28.530286
Epoch 7: valid loss=0.4589932585755984, acc=0.8706597222222222, fr=0.12061478197574615, mask=0.8901615142822266, time=0:00:04.260123

-----------------------------

Epoch 8: train loss=0.08527921728091314, acc=0.9740733271059783, fr=0.11581297963857651, lr=0.01, time=0:00:28.574445
Epoch 8: valid loss=0.6099105924367905, acc=0.8552320075757576, fr=0.12100750207901001, mask=0.8923282623291016, time=0:00:04.301115

-----------------------------

Epoch 9: train loss=0.052742516905709635, acc=0.9832286005434783, fr=0.11676711589097977, lr=0.006999999999999999, time=0:00:28.567930
Epoch 9: valid loss=0.5242689889338281, acc=0.8747632575757576, fr=0.12135612219572067, mask=0.8944826126098633, time=0:00:04.293965

-----------------------------

Epoch 10: train loss=0.03610206807934446, acc=0.9890879755434783, fr=0.11606074124574661, lr=0.006999999999999999, time=0:00:29.488227
Epoch 10: valid loss=0.312024953464667, acc=0.919152462121212, fr=0.12196323275566101, mask=0.8965940475463867, time=0:00:04.886874

Best model saved with valid acc=0.919152462121212

-----------------------------

Epoch 11: train loss=0.03447493769635912, acc=0.98779296875, fr=0.11631311476230621, lr=0.006999999999999999, time=0:00:29.898539
Epoch 11: valid loss=0.4517451897263527, acc=0.8960306186868687, fr=0.12161337584257126, mask=0.8986988067626953, time=0:00:04.404451

-----------------------------

Epoch 12: train loss=0.029992394644068554, acc=0.9904307489809783, fr=0.11640462279319763, lr=0.006999999999999999, time=0:00:30.203193
Epoch 12: valid loss=0.5070635187957022, acc=0.8827730429292929, fr=0.12092871218919754, mask=0.9007272720336914, time=0:00:04.521343

-----------------------------

Epoch 13: train loss=0.022558012587978737, acc=0.9923838739809783, fr=0.11724681407213211, lr=0.006999999999999999, time=0:00:30.108024
Epoch 13: valid loss=0.4590119587050544, acc=0.8877051767676768, fr=0.12246928364038467, mask=0.9027471542358398, time=0:00:04.522416

-----------------------------

Epoch 14: train loss=0.0228820596676087, acc=0.9936045771059783, fr=0.1171923354268074, lr=0.004899999999999999, time=0:00:29.864852
Epoch 14: valid loss=0.3200690431727303, acc=0.9111426767676769, fr=0.12172606587409973, mask=0.9046850204467773, time=0:00:04.583016

-----------------------------

Epoch 15: train loss=0.011157858817568922, acc=0.9970703125, fr=0.1172398179769516, lr=0.004899999999999999, time=0:00:29.781855
Epoch 15: valid loss=0.48029346846871906, acc=0.8957544191919192, fr=0.12169184535741806, mask=0.9065017700195312, time=0:00:04.479135

-----------------------------

Epoch 16: train loss=0.01236346505356778, acc=0.996337890625, fr=0.11701269447803497, lr=0.004899999999999999, time=0:00:29.942049
Epoch 16: valid loss=0.49934396478864884, acc=0.8797743055555556, fr=0.1215248703956604, mask=0.9083337783813477, time=0:00:04.816855

-----------------------------

Epoch 17: train loss=0.013561230059167428, acc=0.99609375, fr=0.11721056699752808, lr=0.003429999999999999, time=0:00:29.997931
Epoch 17: valid loss=0.37364085184203255, acc=0.9120501893939394, fr=0.12231659889221191, mask=0.9101905822753906, time=0:00:04.967969

-----------------------------

Epoch 18: train loss=0.007179311058280291, acc=0.9984130859375, fr=0.11740877479314804, lr=0.003429999999999999, time=0:00:30.276114
Epoch 18: valid loss=0.3550683164762126, acc=0.9055003156565657, fr=0.12178792804479599, mask=0.9119634628295898, time=0:00:04.554491

-----------------------------

Epoch 19: train loss=0.0032635410693728772, acc=0.9993896484375, fr=0.11752242594957352, lr=0.003429999999999999, time=0:00:29.792373
Epoch 19: valid loss=0.32525090376536053, acc=0.9148516414141414, fr=0.12271907925605774, mask=0.9137296676635742, time=0:00:04.523242

-----------------------------

Epoch 20: train loss=0.003670716882652414, acc=0.9986572265625, fr=0.11788056045770645, lr=0.002400999999999999, time=0:00:29.844096
Epoch 20: valid loss=0.42856116675668293, acc=0.9118529040404041, fr=0.12254099547863007, mask=0.9154376983642578, time=0:00:04.717914

-----------------------------

Epoch 21: train loss=0.0016641590414110397, acc=0.9996337890625, fr=0.11783380061388016, lr=0.002400999999999999, time=0:00:30.309145
Epoch 21: valid loss=0.33933882580863106, acc=0.919152462121212, fr=0.12277932465076447, mask=0.9171218872070312, time=0:00:04.619479

-----------------------------

Epoch 22: train loss=0.0016897410262117774, acc=0.99951171875, fr=0.11787285655736923, lr=0.002400999999999999, time=0:00:30.144953
Epoch 22: valid loss=0.30361124748984974, acc=0.9198626893939394, fr=0.12265539169311523, mask=0.9188556671142578, time=0:00:04.535763

Best model saved with valid acc=0.9198626893939394

-----------------------------

Epoch 23: train loss=0.0010591584566554957, acc=1.0, fr=0.11788927018642426, lr=0.002400999999999999, time=0:00:30.050027
Epoch 23: valid loss=0.33535748140679467, acc=0.9183238636363638, fr=0.12263602763414383, mask=0.9204540252685547, time=0:00:04.702055

-----------------------------

Epoch 24: train loss=0.0015575137470023037, acc=0.9998779296875, fr=0.11792398989200592, lr=0.002400999999999999, time=0:00:30.116081
Epoch 24: valid loss=0.331359329736895, acc=0.9198626893939394, fr=0.12293983995914459, mask=0.9220266342163086, time=0:00:04.867423

-----------------------------

Epoch 25: train loss=0.001341150847906647, acc=0.999755859375, fr=0.11796689033508301, lr=0.002400999999999999, time=0:00:29.945664
Epoch 25: valid loss=0.3935805501209365, acc=0.9122080176767676, fr=0.12270186841487885, mask=0.9236211776733398, time=0:00:04.537237

-----------------------------

Epoch 26: train loss=0.0008628512309769576, acc=1.0, fr=0.11796090006828308, lr=0.0016806999999999992, time=0:00:29.982709
Epoch 26: valid loss=0.41861257288191056, acc=0.9044349747474748, fr=0.12277071923017502, mask=0.9251871109008789, time=0:00:04.733245

-----------------------------

Epoch 27: train loss=0.0008008957912579717, acc=1.0, fr=0.11803551763296127, lr=0.0016806999999999992, time=0:00:30.367675
Epoch 27: valid loss=0.4143247769938575, acc=0.9085385101010102, fr=0.12286944687366486, mask=0.9267072677612305, time=0:00:04.619828

-----------------------------

Epoch 28: train loss=0.0006593483816459411, acc=0.9998779296875, fr=0.1181361973285675, lr=0.0016806999999999992, time=0:00:30.385958
Epoch 28: valid loss=0.3811643181575669, acc=0.9091698232323231, fr=0.12295646965503693, mask=0.9281692504882812, time=0:00:04.626716

-----------------------------

Epoch 29: train loss=0.0006092762702678556, acc=0.9998779296875, fr=0.11816978454589844, lr=0.0011764899999999994, time=0:00:29.949568
Epoch 29: valid loss=0.35338792701562244, acc=0.9158775252525252, fr=0.12292730063199997, mask=0.9295997619628906, time=0:00:04.650409

-----------------------------

Epoch 30: train loss=0.0007866635259006216, acc=1.0, fr=0.11810293793678284, lr=0.0011764899999999994, time=0:00:30.071704
Epoch 30: valid loss=0.3848273042175505, acc=0.9072364267676769, fr=0.12282552570104599, mask=0.9310302734375, time=0:00:04.492853

-----------------------------

Epoch 31: train loss=0.0005304570262865127, acc=1.0, fr=0.11812774091959, lr=0.0011764899999999994, time=0:00:30.151511
Epoch 31: valid loss=0.3669530658258332, acc=0.9178503787878787, fr=0.12292226403951645, mask=0.9324579238891602, time=0:00:04.648522

-----------------------------

Epoch 32: train loss=0.0008378738486953807, acc=0.9998779296875, fr=0.11815903335809708, lr=0.0008235429999999996, time=0:00:30.150485
Epoch 32: valid loss=0.35680366183320683, acc=0.9204545454545454, fr=0.1229744628071785, mask=0.9337949752807617, time=0:00:04.845358

Best model saved with valid acc=0.9204545454545454

-----------------------------

Epoch 33: train loss=0.0006197134161993745, acc=0.9998779296875, fr=0.11816629022359848, lr=0.0008235429999999996, time=0:00:29.935601
Epoch 33: valid loss=0.34770424394971794, acc=0.9243607954545454, fr=0.12297875434160233, mask=0.9351215362548828, time=0:00:04.546929

Best model saved with valid acc=0.9243607954545454

-----------------------------

Epoch 34: train loss=0.00041874289132692866, acc=1.0, fr=0.11818407475948334, lr=0.0008235429999999996, time=0:00:30.191657
Epoch 34: valid loss=0.3522212608820862, acc=0.9215198863636362, fr=0.1229577511548996, mask=0.9364194869995117, time=0:00:04.643930

-----------------------------

Epoch 35: train loss=0.0003878144497093672, acc=1.0, fr=0.11818358302116394, lr=0.0008235429999999996, time=0:00:29.948303
Epoch 35: valid loss=0.34450972866680885, acc=0.9176136363636362, fr=0.12295562028884888, mask=0.9377098083496094, time=0:00:04.732115

-----------------------------

Epoch 36: train loss=0.0007914756946547641, acc=0.999755859375, fr=0.11816993355751038, lr=0.0008235429999999996, time=0:00:30.234565
Epoch 36: valid loss=0.3888745370010535, acc=0.9126815025252526, fr=0.12289434671401978, mask=0.9389457702636719, time=0:00:04.697290

-----------------------------

Epoch 37: train loss=0.0004724497793233695, acc=1.0, fr=0.11812582612037659, lr=0.0005764800999999997, time=0:00:30.256562
Epoch 37: valid loss=0.36359791664613617, acc=0.9172190656565657, fr=0.12286195904016495, mask=0.9402313232421875, time=0:00:04.672348

-----------------------------

Epoch 38: train loss=0.0006262435501867003, acc=1.0, fr=0.11815083771944046, lr=0.0005764800999999997, time=0:00:30.234241
Epoch 38: valid loss=0.36696701496839523, acc=0.9167455808080808, fr=0.12294255942106247, mask=0.9414405822753906, time=0:00:04.738958

-----------------------------

Epoch 39: train loss=0.001038992536450678, acc=0.9996337890625, fr=0.11817359924316406, lr=0.0005764800999999997, time=0:00:30.790301
Epoch 39: valid loss=0.3597545151909192, acc=0.9161537247474748, fr=0.12293703109025955, mask=0.9426546096801758, time=0:00:04.860468

-----------------------------

Epoch 40: train loss=0.0008933491654374848, acc=0.9998779296875, fr=0.11817891150712967, lr=0.00040353606999999974, time=0:00:30.130122
Epoch 40: valid loss=0.3626618832349777, acc=0.9182844065656565, fr=0.12292132526636124, mask=0.9438180923461914, time=0:00:04.612655

-----------------------------

Epoch 41: train loss=0.0005521693265109207, acc=1.0, fr=0.11818531155586243, lr=0.00040353606999999974, time=0:00:30.221388
Epoch 41: valid loss=0.36711110381616485, acc=0.9187184343434343, fr=0.12295357137918472, mask=0.9449567794799805, time=0:00:04.593164

-----------------------------

Epoch 42: train loss=0.0004583228636647618, acc=1.0, fr=0.11820826679468155, lr=0.00040353606999999974, time=0:00:30.111326
Epoch 42: valid loss=0.3542837090790272, acc=0.9147727272727272, fr=0.12298626452684402, mask=0.9460258483886719, time=0:00:04.699554

-----------------------------

Epoch 43: train loss=0.0006165309478660674, acc=0.9998779296875, fr=0.11824160069227219, lr=0.0002824752489999998, time=0:00:30.495244
Epoch 43: valid loss=0.35843050686849487, acc=0.9150094696969696, fr=0.12299321591854095, mask=0.9471101760864258, time=0:00:04.659088

-----------------------------

Epoch 44: train loss=0.0004994805981937134, acc=0.9998779296875, fr=0.11827031522989273, lr=0.0002824752489999998, time=0:00:30.336732
Epoch 44: valid loss=0.3537559265063869, acc=0.921953914141414, fr=0.12303991615772247, mask=0.9480876922607422, time=0:00:04.706838

-----------------------------

Epoch 45: train loss=0.00036666111282102065, acc=1.0, fr=0.11829826235771179, lr=0.0002824752489999998, time=0:00:30.148399
Epoch 45: valid loss=0.3515314997898208, acc=0.9146148989898991, fr=0.12305005639791489, mask=0.9490909576416016, time=0:00:04.543482

-----------------------------

Epoch 46: train loss=0.00034343749604204277, acc=1.0, fr=0.11831162869930267, lr=0.00019773267429999984, time=0:00:32.044503
Epoch 46: valid loss=0.35194931779470706, acc=0.9200205176767676, fr=0.12306475639343262, mask=0.9501552581787109, time=0:00:05.172744

-----------------------------

Epoch 47: train loss=0.0003428426326763656, acc=1.0, fr=0.11831297725439072, lr=0.00019773267429999984, time=0:00:31.866273
Epoch 47: valid loss=0.36082106290592086, acc=0.9130760732323231, fr=0.12307924777269363, mask=0.9501552581787109, time=0:00:04.616690

-----------------------------

Epoch 48: train loss=0.0003671745607221055, acc=1.0, fr=0.11831499636173248, lr=0.00019773267429999984, time=0:00:30.220126
Epoch 48: valid loss=0.36832497351699406, acc=0.9154829545454546, fr=0.12307795137166977, mask=0.9501552581787109, time=0:00:04.610896

-----------------------------

Epoch 49: train loss=0.00044218403763807146, acc=1.0, fr=0.11832738667726517, lr=0.00013841287200999988, time=0:00:30.179361
Epoch 49: valid loss=0.35645229203833473, acc=0.9145754419191918, fr=0.12309106439352036, mask=0.9501552581787109, time=0:00:04.684805

-----------------------------

Epoch 50: train loss=0.0003045939986350277, acc=1.0, fr=0.11832933872938156, lr=0.00013841287200999988, time=0:00:30.207797
Epoch 50: valid loss=0.37382711180382305, acc=0.9195864898989898, fr=0.12304645776748657, mask=0.9501552581787109, time=0:00:04.674633

-----------------------------


Best valid acc at epoch 33: 0.9243607954545454


------ Training finished ------

Loading best model, epoch=33, valid acc=0.9243607954545454

------ Begin Testing ------

Test loss=0.35064203333523536, acc=0.9226246843434343, mean act rate=0.1229717880487442

-----------------------------


This dataset uses the same split for validation and testing.

