===== Exp configuration =====
neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		3
nb_hiddens:		1024
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-30-03-31
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-30-03-31/
dataset_name:		shd
data_folder:		data/raw/
batch_size:		128
nb_epochs:		50
dropout:		0.75
dropout_stop:		0.95
dropout_stepping:		0.02
ckpt_freq:		5
clustering:		True
clustering_factor:		[0.1, 0.25]
cin_minmax:		[0.001, 0.05]
cout_minmax:		[0.05, 0.2]
noise_test:		0.2
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda
checkpoint_dir: ./log/07-30-03-31//checkpoints/

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): RadLIFLayer(
      (W): Linear(in_features=1024, out_features=1024, bias=False)
      (V): Linear(in_features=1024, out_features=1024, bias=False)
      (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (2): ReadoutLayer(
      (W): Linear(in_features=1024, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 3895356

------ Begin training ------

Epoch 1: train loss=2.0285, acc=0.3974, fr=0.0722, lr=0.0100, time=0:00:34.333851, cin=0.009930, 0.006138, cout=0.091964, 0.066674
Epoch 1: valid loss=1.8194, acc=0.5047, fr=0.0787, mask=0.8750, time=0:00:05.527353

-----------------------------

Epoch 2: train loss=0.6151, acc=0.7946, fr=0.0739, lr=0.0100, time=0:00:30.276249, cin=0.008488, 0.004505, cout=0.166128, 0.127632
Epoch 2: valid loss=0.8801, acc=0.7274, fr=0.0793, mask=0.8785, time=0:00:05.616614

-----------------------------

Epoch 3: train loss=0.3072, acc=0.9063, fr=0.0749, lr=0.0100, time=0:00:30.325910, cin=0.004558, 0.006275, cout=0.124624, 0.115803
Epoch 3: valid loss=0.4957, acc=0.8243, fr=0.0762, mask=0.8809, time=0:00:05.460161

-----------------------------

Epoch 4: train loss=0.2394, acc=0.9263, fr=0.0717, lr=0.0100, time=0:00:31.730337, cin=0.005983, 0.005063, cout=0.106496, 0.108427
Epoch 4: valid loss=0.6725, acc=0.8001, fr=0.0765, mask=0.8833, time=0:00:06.155898

-----------------------------

Epoch 5: train loss=0.1412, acc=0.9564, fr=0.0742, lr=0.0100, time=0:00:36.450370, cin=0.009112, 0.004199, cout=0.112367, 0.101497
Epoch 5: valid loss=0.3845, acc=0.8762, fr=0.0792, mask=0.8856, time=0:00:05.958787

Best model saved with valid acc=0.8761837121212122

-----------------------------

Epoch 6: train loss=0.1044, acc=0.9669, fr=0.0752, lr=0.0100, time=0:00:31.950011, cin=0.016215, 0.004604, cout=0.106822, 0.097294
Epoch 6: valid loss=0.3357, acc=0.8945, fr=0.0788, mask=0.8879, time=0:00:05.999815

Best model saved with valid acc=0.89453125

-----------------------------

Epoch 7: train loss=0.0937, acc=0.9709, fr=0.0735, lr=0.0100, time=0:00:32.015960, cin=0.013645, 0.003732, cout=0.134419, 0.090123
Epoch 7: valid loss=0.5191, acc=0.8648, fr=0.0766, mask=0.8902, time=0:00:05.968232

-----------------------------

Epoch 8: train loss=0.0620, acc=0.9818, fr=0.0700, lr=0.0100, time=0:00:31.395550, cin=0.013006, 0.002878, cout=0.137442, 0.086325
Epoch 8: valid loss=0.4580, acc=0.8759, fr=0.0737, mask=0.8924, time=0:00:05.917270

-----------------------------

Epoch 9: train loss=0.0630, acc=0.9803, fr=0.0683, lr=0.0100, time=0:00:31.498663, cin=0.010666, 0.002657, cout=0.152282, 0.083421
Epoch 9: valid loss=0.4803, acc=0.8800, fr=0.0712, mask=0.8946, time=0:00:05.849120

-----------------------------

Epoch 10: train loss=0.0331, acc=0.9918, fr=0.0679, lr=0.0070, time=0:00:31.479329, cin=0.010719, 0.002749, cout=0.140719, 0.082859
Epoch 10: valid loss=0.3663, acc=0.8891, fr=0.0719, mask=0.8967, time=0:00:05.971334

-----------------------------

Epoch 11: train loss=0.0308, acc=0.9904, fr=0.0676, lr=0.0070, time=0:00:31.385967, cin=0.009567, 0.002468, cout=0.147796, 0.080717
Epoch 11: valid loss=0.5092, acc=0.8605, fr=0.0718, mask=0.8988, time=0:00:06.521722

-----------------------------

Epoch 12: train loss=0.0231, acc=0.9927, fr=0.0680, lr=0.0070, time=0:00:31.780893, cin=0.007892, 0.002295, cout=0.159094, 0.081714
Epoch 12: valid loss=0.5106, acc=0.8778, fr=0.0719, mask=0.9008, time=0:00:05.884525

-----------------------------

Epoch 13: train loss=0.0146, acc=0.9966, fr=0.0678, lr=0.0049, time=0:00:32.772529, cin=0.008238, 0.002655, cout=0.158984, 0.083240
Epoch 13: valid loss=0.4887, acc=0.8900, fr=0.0718, mask=0.9028, time=0:00:06.426936

-----------------------------

Epoch 14: train loss=0.0125, acc=0.9961, fr=0.0676, lr=0.0049, time=0:00:33.429610, cin=0.008336, 0.002795, cout=0.156138, 0.081044
Epoch 14: valid loss=0.4322, acc=0.8926, fr=0.0714, mask=0.9047, time=0:00:06.118990

-----------------------------

Epoch 15: train loss=0.0079, acc=0.9984, fr=0.0673, lr=0.0049, time=0:00:33.720825, cin=0.008767, 0.002701, cout=0.149141, 0.078363
Epoch 15: valid loss=0.3871, acc=0.9004, fr=0.0707, mask=0.9066, time=0:00:05.971245

Best model saved with valid acc=0.9003708964646465

-----------------------------

Epoch 16: train loss=0.0075, acc=0.9984, fr=0.0668, lr=0.0049, time=0:00:33.197608, cin=0.008187, 0.002687, cout=0.143677, 0.077781
Epoch 16: valid loss=0.3316, acc=0.9106, fr=0.0708, mask=0.9085, time=0:00:06.019417

Best model saved with valid acc=0.9106297348484849

-----------------------------

Epoch 17: train loss=0.0075, acc=0.9978, fr=0.0666, lr=0.0049, time=0:00:31.863168, cin=0.007376, 0.002621, cout=0.143249, 0.073430
Epoch 17: valid loss=0.4682, acc=0.8943, fr=0.0703, mask=0.9103, time=0:00:05.699115

-----------------------------

Epoch 18: train loss=0.0054, acc=0.9987, fr=0.0666, lr=0.0049, time=0:00:30.743337, cin=0.007135, 0.002359, cout=0.142177, 0.074363
Epoch 18: valid loss=0.3811, acc=0.9077, fr=0.0706, mask=0.9121, time=0:00:05.821046

-----------------------------

Epoch 19: train loss=0.0071, acc=0.9983, fr=0.0667, lr=0.0049, time=0:00:30.500522, cin=0.006358, 0.002308, cout=0.148571, 0.073097
Epoch 19: valid loss=0.5410, acc=0.8779, fr=0.0703, mask=0.9138, time=0:00:05.742764

-----------------------------

Epoch 20: train loss=0.0044, acc=0.9991, fr=0.0664, lr=0.0034, time=0:00:31.977532, cin=0.006498, 0.002149, cout=0.149925, 0.079464
Epoch 20: valid loss=0.3687, acc=0.9116, fr=0.0704, mask=0.9156, time=0:00:06.451810

Best model saved with valid acc=0.9116161616161617

-----------------------------

Epoch 21: train loss=0.0032, acc=0.9996, fr=0.0661, lr=0.0034, time=0:00:33.986707, cin=0.006319, 0.002158, cout=0.149995, 0.082423
Epoch 21: valid loss=0.4030, acc=0.9040, fr=0.0700, mask=0.9173, time=0:00:06.983644

-----------------------------

Epoch 22: train loss=0.0040, acc=0.9993, fr=0.0656, lr=0.0034, time=0:00:33.625476, cin=0.006451, 0.002071, cout=0.144124, 0.081101
Epoch 22: valid loss=0.3884, acc=0.9069, fr=0.0693, mask=0.9189, time=0:00:06.439460

-----------------------------

Epoch 23: train loss=0.0032, acc=0.9998, fr=0.0654, lr=0.0034, time=0:00:33.488271, cin=0.006476, 0.002297, cout=0.138300, 0.080725
Epoch 23: valid loss=0.3955, acc=0.9079, fr=0.0695, mask=0.9205, time=0:00:06.641795

-----------------------------

Epoch 24: train loss=0.0034, acc=0.9995, fr=0.0652, lr=0.0024, time=0:00:33.067252, cin=0.006888, 0.002177, cout=0.138591, 0.079252
Epoch 24: valid loss=0.4140, acc=0.9027, fr=0.0691, mask=0.9221, time=0:00:06.136379

-----------------------------

Epoch 25: train loss=0.0036, acc=0.9993, fr=0.0648, lr=0.0024, time=0:00:31.955686, cin=0.006735, 0.001955, cout=0.143972, 0.078805
Epoch 25: valid loss=0.4403, acc=0.9060, fr=0.0688, mask=0.9237, time=0:00:05.979462

-----------------------------

Epoch 26: train loss=0.0046, acc=0.9985, fr=0.0644, lr=0.0024, time=0:00:32.299622, cin=0.006362, 0.002013, cout=0.135575, 0.076360
Epoch 26: valid loss=0.3498, acc=0.9073, fr=0.0691, mask=0.9252, time=0:00:05.958153

-----------------------------

Epoch 27: train loss=0.0034, acc=0.9998, fr=0.0643, lr=0.0017, time=0:00:33.871096, cin=0.006546, 0.002073, cout=0.127426, 0.074718
Epoch 27: valid loss=0.4508, acc=0.9038, fr=0.0683, mask=0.9267, time=0:00:06.333783

-----------------------------

Epoch 28: train loss=0.0032, acc=0.9998, fr=0.0642, lr=0.0017, time=0:00:34.203193, cin=0.006202, 0.002101, cout=0.123907, 0.072196
Epoch 28: valid loss=0.4811, acc=0.8934, fr=0.0685, mask=0.9281, time=0:00:06.774136

-----------------------------

Epoch 29: train loss=0.0025, acc=0.9998, fr=0.0641, lr=0.0017, time=0:00:35.072676, cin=0.006136, 0.002293, cout=0.117561, 0.069015
Epoch 29: valid loss=0.4705, acc=0.9016, fr=0.0681, mask=0.9296, time=0:00:07.032721

-----------------------------

Epoch 30: train loss=0.0043, acc=0.9990, fr=0.0640, lr=0.0012, time=0:00:33.510910, cin=0.006069, 0.002301, cout=0.115659, 0.070134
Epoch 30: valid loss=0.4176, acc=0.9090, fr=0.0681, mask=0.9310, time=0:00:05.831031

-----------------------------

Epoch 31: train loss=0.0038, acc=0.9989, fr=0.0636, lr=0.0012, time=0:00:32.896316, cin=0.006098, 0.002492, cout=0.108895, 0.070329
Epoch 31: valid loss=0.4047, acc=0.9031, fr=0.0678, mask=0.9324, time=0:00:07.504953

-----------------------------

Epoch 32: train loss=0.0034, acc=0.9990, fr=0.0634, lr=0.0012, time=0:00:35.721732, cin=0.005768, 0.002352, cout=0.108603, 0.066838
Epoch 32: valid loss=0.4381, acc=0.9044, fr=0.0676, mask=0.9338, time=0:00:07.023394

-----------------------------

Epoch 33: train loss=0.0026, acc=0.9995, fr=0.0633, lr=0.0008, time=0:00:35.796362, cin=0.005425, 0.002217, cout=0.099555, 0.066424
Epoch 33: valid loss=0.4296, acc=0.9027, fr=0.0673, mask=0.9351, time=0:00:06.119663

-----------------------------

Epoch 34: train loss=0.0025, acc=0.9995, fr=0.0631, lr=0.0008, time=0:00:34.968304, cin=0.005316, 0.002160, cout=0.092446, 0.064218
Epoch 34: valid loss=0.3930, acc=0.9014, fr=0.0673, mask=0.9364, time=0:00:06.614246

-----------------------------

Epoch 35: train loss=0.0027, acc=0.9995, fr=0.0630, lr=0.0008, time=0:00:32.178756, cin=0.005468, 0.002278, cout=0.087867, 0.059395
Epoch 35: valid loss=0.4078, acc=0.9077, fr=0.0672, mask=0.9377, time=0:00:06.008666

-----------------------------

Epoch 36: train loss=0.0021, acc=0.9999, fr=0.0628, lr=0.0006, time=0:00:31.900950, cin=0.005713, 0.002205, cout=0.085167, 0.058837
Epoch 36: valid loss=0.4033, acc=0.9052, fr=0.0670, mask=0.9389, time=0:00:06.246964

-----------------------------

Epoch 37: train loss=0.0025, acc=0.9995, fr=0.0626, lr=0.0006, time=0:00:33.634125, cin=0.005223, 0.002051, cout=0.079925, 0.056971
Epoch 37: valid loss=0.4138, acc=0.9084, fr=0.0667, mask=0.9402, time=0:00:06.944620

-----------------------------

Epoch 38: train loss=0.0027, acc=0.9996, fr=0.0625, lr=0.0006, time=0:00:34.114944, cin=0.005214, 0.001922, cout=0.078381, 0.058456
Epoch 38: valid loss=0.4196, acc=0.9062, fr=0.0667, mask=0.9414, time=0:00:06.702842

-----------------------------

Epoch 39: train loss=0.0023, acc=1.0000, fr=0.0623, lr=0.0004, time=0:00:32.914038, cin=0.005821, 0.001923, cout=0.080105, 0.054280
Epoch 39: valid loss=0.4298, acc=0.9043, fr=0.0665, mask=0.9426, time=0:00:07.039225

-----------------------------

Epoch 40: train loss=0.0026, acc=0.9996, fr=0.0619, lr=0.0004, time=0:00:37.915800, cin=0.005964, 0.001756, cout=0.075760, 0.055214
Epoch 40: valid loss=0.4010, acc=0.9060, fr=0.0662, mask=0.9437, time=0:00:06.665030

-----------------------------

Epoch 41: train loss=0.0033, acc=0.9991, fr=0.0617, lr=0.0004, time=0:00:35.128330, cin=0.005918, 0.001786, cout=0.077753, 0.054458
Epoch 41: valid loss=0.4631, acc=0.9043, fr=0.0660, mask=0.9449, time=0:00:06.001501

-----------------------------

Epoch 42: train loss=0.0023, acc=0.9999, fr=0.0615, lr=0.0003, time=0:00:33.537767, cin=0.005621, 0.001767, cout=0.073727, 0.053836
Epoch 42: valid loss=0.4597, acc=0.9017, fr=0.0657, mask=0.9459, time=0:00:06.479805

-----------------------------

Epoch 43: train loss=0.0022, acc=0.9999, fr=0.0613, lr=0.0003, time=0:00:34.794339, cin=0.005303, 0.001743, cout=0.070792, 0.053690
Epoch 43: valid loss=0.4271, acc=0.9032, fr=0.0655, mask=0.9470, time=0:00:06.736151

-----------------------------

Epoch 44: train loss=0.0025, acc=0.9994, fr=0.0611, lr=0.0003, time=0:00:33.430564, cin=0.004889, 0.001725, cout=0.071489, 0.051660
Epoch 44: valid loss=0.4342, acc=0.8984, fr=0.0654, mask=0.9481, time=0:00:06.710801

-----------------------------

Epoch 45: train loss=0.0026, acc=0.9995, fr=0.0609, lr=0.0002, time=0:00:35.270082, cin=0.004979, 0.001901, cout=0.067216, 0.063310
Epoch 45: valid loss=0.4361, acc=0.9005, fr=0.0652, mask=0.9491, time=0:00:06.717535

-----------------------------

Epoch 46: train loss=0.0033, acc=0.9995, fr=0.0606, lr=0.0002, time=0:00:34.587108, cin=0.005328, 0.001736, cout=0.067718, 0.062238
Epoch 46: valid loss=0.4343, acc=0.8973, fr=0.0648, mask=0.9501, time=0:00:07.106541

-----------------------------

Epoch 47: train loss=0.0031, acc=0.9999, fr=0.0603, lr=0.0002, time=0:00:33.947505, cin=0.005494, 0.001680, cout=0.067287, 0.063435
Epoch 47: valid loss=0.4219, acc=0.8986, fr=0.0646, mask=0.9511, time=0:00:07.124444

-----------------------------

Epoch 48: train loss=0.0023, acc=0.9999, fr=0.0604, lr=0.0001, time=0:00:34.848517, cin=0.005498, 0.001679, cout=0.067146, 0.063438
Epoch 48: valid loss=0.4399, acc=0.8984, fr=0.0646, mask=0.9511, time=0:00:06.336448

-----------------------------

Epoch 49: train loss=0.0029, acc=0.9995, fr=0.0604, lr=0.0001, time=0:00:33.651901, cin=0.005484, 0.001679, cout=0.067157, 0.063466
Epoch 49: valid loss=0.4348, acc=0.8969, fr=0.0646, mask=0.9511, time=0:00:06.218848

-----------------------------

Epoch 50: train loss=0.0024, acc=0.9999, fr=0.0604, lr=0.0001, time=0:00:36.577091, cin=0.005491, 0.001680, cout=0.067048, 0.063438
Epoch 50: valid loss=0.4125, acc=0.9016, fr=0.0647, mask=0.9511, time=0:00:06.119937

-----------------------------


Best valid acc at epoch 20: 0.9116161616161617


------ Training finished ------

