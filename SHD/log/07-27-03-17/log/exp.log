===== Exp configuration =====
neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		3
nb_hiddens:		128
nb_steps:		100
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-27-03-17
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-27-03-17/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
dropout:		0.75
dropout_stop:		0.95
dropout_stepping:		0.02
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=128, bias=False)
      (V): Linear(in_features=128, out_features=128, bias=False)
      (norm): BatchNorm1d(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): RadLIFLayer(
      (W): Linear(in_features=128, out_features=128, bias=False)
      (V): Linear(in_features=128, out_features=128, bias=False)
      (norm): BatchNorm1d(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (2): ReadoutLayer(
      (W): Linear(in_features=128, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 14290 ww8

------ Begin training ------

Epoch 1: train loss=2.9369916189461946, acc=0.18893299932065216, fr=0.03751915320754051, lr=0.01, time=0:00:31.202454
Epoch 1: valid loss=1.9920769731203716, acc=0.36927872474747475, fr=0.04119415953755379, time=0:00:04.243624, mask=0.75

Best model saved with valid acc=0.36927872474747475

-----------------------------

Epoch 2: train loss=1.5038838535547256, acc=0.5177214249320652, fr=0.04411201551556587, lr=0.01, time=0:00:28.319820
Epoch 2: valid loss=0.8974757525655959, acc=0.6752683080808081, fr=0.05072769895195961, time=0:00:04.554968, mask=0.7635498046875

Best model saved with valid acc=0.6752683080808081

-----------------------------

Epoch 3: train loss=0.8367301374673843, acc=0.7206606657608696, fr=0.0501784048974514, lr=0.01, time=0:00:32.658678
Epoch 3: valid loss=0.6586398432652155, acc=0.7688999368686869, fr=0.05654172599315643, time=0:00:04.318528, mask=0.76824951171875

Best model saved with valid acc=0.7688999368686869

-----------------------------

Epoch 4: train loss=0.5306917889975011, acc=0.8267291525135869, fr=0.05467870086431503, lr=0.01, time=0:00:28.241900
Epoch 4: valid loss=0.7791039745012919, acc=0.7454624368686869, fr=0.06147008761763573, time=0:00:04.411566, mask=0.7740478515625

-----------------------------

Epoch 5: train loss=0.39050820050761104, acc=0.8787735648777174, fr=0.05708516016602516, lr=0.01, time=0:00:30.081295
Epoch 5: valid loss=0.5966406348678801, acc=0.8029119318181819, fr=0.06372018903493881, time=0:00:04.282295, mask=0.7783203125

Best model saved with valid acc=0.8029119318181819

-----------------------------

Epoch 6: train loss=0.29879045975394547, acc=0.9057670261548914, fr=0.06014737859368324, lr=0.01, time=0:00:28.669496
Epoch 6: valid loss=0.46164412299791974, acc=0.8511284722222222, fr=0.06296034902334213, time=0:00:04.284203, mask=0.78228759765625

Best model saved with valid acc=0.8511284722222222

-----------------------------

Epoch 7: train loss=0.24568082788027823, acc=0.919571586277174, fr=0.06190723553299904, lr=0.01, time=0:00:29.111716
Epoch 7: valid loss=0.37991943375931847, acc=0.8671875, fr=0.06831009685993195, time=0:00:04.285807, mask=0.78619384765625

Best model saved with valid acc=0.8671875

-----------------------------

Epoch 8: train loss=0.30027642380446196, acc=0.9033999235733696, fr=0.07047738134860992, lr=0.01, time=0:00:28.263519
Epoch 8: valid loss=0.5161126057306925, acc=0.8355034722222222, fr=0.07759696990251541, time=0:00:04.261746, mask=0.78955078125

-----------------------------

Epoch 9: train loss=0.2128344551892951, acc=0.9343527088994565, fr=0.07389653474092484, lr=0.01, time=0:00:27.868182
Epoch 9: valid loss=0.39304036067591774, acc=0.8708175505050505, fr=0.07755550742149353, time=0:00:04.222368, mask=0.7935791015625

Best model saved with valid acc=0.8708175505050505

-----------------------------

Epoch 10: train loss=0.18117576360236853, acc=0.9389276919157609, fr=0.07707544416189194, lr=0.01, time=0:00:27.269122
Epoch 10: valid loss=0.3045797083112929, acc=0.9053819444444444, fr=0.07990363985300064, time=0:00:04.229112, mask=0.7977294921875

Best model saved with valid acc=0.9053819444444444

-----------------------------

Epoch 11: train loss=0.1501713417819701, acc=0.9518087635869565, fr=0.07491461932659149, lr=0.01, time=0:00:27.453505
Epoch 11: valid loss=0.46973087390263873, acc=0.8595328282828283, fr=0.07723066955804825, time=0:00:04.213465, mask=0.8026123046875

-----------------------------

Epoch 12: train loss=0.1286360413650982, acc=0.9588198454483696, fr=0.0718756839632988, lr=0.01, time=0:00:27.602450
Epoch 12: valid loss=0.3754328108496136, acc=0.8814315025252525, fr=0.07210354506969452, time=0:00:04.324043, mask=0.80657958984375

-----------------------------

Epoch 13: train loss=0.1146803829469718, acc=0.9631613026494565, fr=0.06888661533594131, lr=0.01, time=0:00:27.845333
Epoch 13: valid loss=0.4249771427777078, acc=0.8647806186868687, fr=0.07374140620231628, time=0:00:04.181372, mask=0.810791015625

-----------------------------

Epoch 14: train loss=0.09697110930574127, acc=0.9709260360054348, fr=0.07132505625486374, lr=0.006999999999999999, time=0:00:27.642057
Epoch 14: valid loss=0.42157115621699226, acc=0.8775647095959597, fr=0.07550936937332153, time=0:00:04.276471, mask=0.8148193359375

-----------------------------

Epoch 15: train loss=0.0709577034576796, acc=0.9790304432744565, fr=0.07210537046194077, lr=0.006999999999999999, time=0:00:28.713623
Epoch 15: valid loss=0.3931845385167334, acc=0.8808396464646465, fr=0.0763716921210289, time=0:00:04.812384, mask=0.8189697265625

-----------------------------

Epoch 16: train loss=0.07231519668130204, acc=0.9787863026494565, fr=0.07348653674125671, lr=0.006999999999999999, time=0:00:29.406733
Epoch 16: valid loss=0.4411508846614096, acc=0.8597695707070707, fr=0.07484579086303711, time=0:00:04.436911, mask=0.822509765625

-----------------------------

Epoch 17: train loss=0.06273834765306674, acc=0.9790569802989131, fr=0.07227471470832825, lr=0.004899999999999999, time=0:00:29.280426
Epoch 17: valid loss=0.40243385401037, acc=0.8890072601010102, fr=0.0745278149843216, time=0:00:05.273216, mask=0.82635498046875

-----------------------------

Epoch 18: train loss=0.05838326504454017, acc=0.9819123641304348, fr=0.0743311196565628, lr=0.004899999999999999, time=0:00:28.509375
Epoch 18: valid loss=0.358149669236607, acc=0.9028961489898991, fr=0.07744469493627548, time=0:00:04.449346, mask=0.830078125

-----------------------------

Epoch 19: train loss=0.048795145194162615, acc=0.9849853515625, fr=0.07450654357671738, lr=0.004899999999999999, time=0:00:27.636951
Epoch 19: valid loss=0.39140408403343624, acc=0.8838383838383838, fr=0.07947961986064911, time=0:00:04.223830, mask=0.8333740234375

-----------------------------

Epoch 20: train loss=0.04203050205251202, acc=0.9863546620244565, fr=0.07515445351600647, lr=0.003429999999999999, time=0:00:27.805325
Epoch 20: valid loss=0.3958539325329993, acc=0.8918481691919192, fr=0.07772073894739151, time=0:00:04.181787, mask=0.8363037109375

-----------------------------

Epoch 21: train loss=0.041949922786443494, acc=0.9861582880434783, fr=0.07482930272817612, lr=0.003429999999999999, time=0:00:27.859502
Epoch 21: valid loss=0.3145972556538052, acc=0.899621212121212, fr=0.07770681381225586, time=0:00:04.246520, mask=0.8392333984375

-----------------------------

Epoch 22: train loss=0.035374314786167815, acc=0.9894064198369565, fr=0.07583650201559067, lr=0.003429999999999999, time=0:00:27.710021
Epoch 22: valid loss=0.3482457415925132, acc=0.896188446969697, fr=0.07820470631122589, time=0:00:04.315592, mask=0.84259033203125

-----------------------------

Epoch 23: train loss=0.03568107876344584, acc=0.9891357421875, fr=0.07548610866069794, lr=0.002400999999999999, time=0:00:27.890230
Epoch 23: valid loss=0.37583594603670967, acc=0.8968592171717172, fr=0.0773761197924614, time=0:00:04.250952, mask=0.84576416015625

-----------------------------

Epoch 24: train loss=0.02834671515302034, acc=0.991455078125, fr=0.07504409551620483, lr=0.002400999999999999, time=0:00:27.972622
Epoch 24: valid loss=0.3498602650231785, acc=0.9014362373737375, fr=0.0780344009399414, time=0:00:04.369637, mask=0.84979248046875

-----------------------------

Epoch 25: train loss=0.03071116351929959, acc=0.9920176630434783, fr=0.07591421157121658, lr=0.002400999999999999, time=0:00:27.883020
Epoch 25: valid loss=0.3321598246693611, acc=0.9070391414141414, fr=0.07946010679006577, time=0:00:04.383052, mask=0.85284423828125

Best model saved with valid acc=0.9070391414141414

-----------------------------

Epoch 26: train loss=0.02932829293422401, acc=0.991943359375, fr=0.07603228837251663, lr=0.002400999999999999, time=0:00:28.268820
Epoch 26: valid loss=0.35918447623650235, acc=0.9024621212121213, fr=0.07912931591272354, time=0:00:04.292766, mask=0.85662841796875

-----------------------------

Epoch 27: train loss=0.026271609662217088, acc=0.9926280146059783, fr=0.07578103244304657, lr=0.002400999999999999, time=0:00:28.151976
Epoch 27: valid loss=0.36965077618757886, acc=0.8953203914141414, fr=0.07866009324789047, time=0:00:04.261457, mask=0.85919189453125

-----------------------------

Epoch 28: train loss=0.03260834424872883, acc=0.9898947010869565, fr=0.07468108087778091, lr=0.002400999999999999, time=0:00:27.897720
Epoch 28: valid loss=0.38229982140991425, acc=0.8908222853535354, fr=0.07655005156993866, time=0:00:04.330662, mask=0.86199951171875

-----------------------------

Epoch 29: train loss=0.028961334290215746, acc=0.992431640625, fr=0.07409830391407013, lr=0.0016806999999999992, time=0:00:27.855243
Epoch 29: valid loss=0.3329276161061393, acc=0.898516414141414, fr=0.07745005190372467, time=0:00:04.280883, mask=0.864501953125

-----------------------------

Epoch 30: train loss=0.0246514305981691, acc=0.9925059442934783, fr=0.07429420202970505, lr=0.0016806999999999992, time=0:00:28.054312
Epoch 30: valid loss=0.3803135421541002, acc=0.8914141414141414, fr=0.07694552093744278, time=0:00:04.256552, mask=0.86688232421875

-----------------------------

Epoch 31: train loss=0.02490534233947983, acc=0.9931640625, fr=0.07366891205310822, lr=0.0016806999999999992, time=0:00:27.906511
Epoch 31: valid loss=0.345914825797081, acc=0.9067629419191918, fr=0.07659704238176346, time=0:00:04.371011, mask=0.8695068359375

-----------------------------

Epoch 32: train loss=0.020028859456942882, acc=0.9954833984375, fr=0.07393653690814972, lr=0.0011764899999999994, time=0:00:27.941851
Epoch 32: valid loss=0.39262645029359394, acc=0.8939788510101009, fr=0.07696887850761414, time=0:00:04.269033, mask=0.8720703125

-----------------------------

Epoch 33: train loss=0.021378113829996437, acc=0.9937266474184783, fr=0.07376375794410706, lr=0.0011764899999999994, time=0:00:27.724627
Epoch 33: valid loss=0.4191650566127565, acc=0.8849037247474747, fr=0.07693185657262802, time=0:00:04.275645, mask=0.87457275390625

-----------------------------

Epoch 34: train loss=0.021566231800534297, acc=0.994140625, fr=0.07400047034025192, lr=0.0011764899999999994, time=0:00:27.836856
Epoch 34: valid loss=0.3992343702250057, acc=0.8875473484848485, fr=0.07680980116128922, time=0:00:04.302249, mask=0.8770751953125

-----------------------------

Epoch 35: train loss=0.021792332972836448, acc=0.9939707880434783, fr=0.07387503236532211, lr=0.0008235429999999996, time=0:00:27.855780
Epoch 35: valid loss=0.3778761136862967, acc=0.8944128787878787, fr=0.07715127617120743, time=0:00:04.312267, mask=0.87994384765625

-----------------------------

Epoch 36: train loss=0.01929058722453192, acc=0.9952392578125, fr=0.07395514100790024, lr=0.0008235429999999996, time=0:00:27.793526
Epoch 36: valid loss=0.4006381125913726, acc=0.8896780303030304, fr=0.07652617245912552, time=0:00:04.273716, mask=0.88250732421875

-----------------------------

Epoch 37: train loss=0.020235855183273088, acc=0.9949473505434783, fr=0.07408878952264786, lr=0.0008235429999999996, time=0:00:27.848626
Epoch 37: valid loss=0.37173160082764095, acc=0.8965830176767676, fr=0.0776507630944252, time=0:00:04.420949, mask=0.88507080078125

-----------------------------

Epoch 38: train loss=0.01930717698269291, acc=0.9954833984375, fr=0.07409560680389404, lr=0.0005764800999999997, time=0:00:27.789649
Epoch 38: valid loss=0.40530867543485427, acc=0.889441287878788, fr=0.07666721940040588, time=0:00:04.406039, mask=0.88702392578125

-----------------------------

Epoch 39: train loss=0.019614250979429926, acc=0.994140625, fr=0.07368092238903046, lr=0.0005764800999999997, time=0:00:27.952349
Epoch 39: valid loss=0.38368719153934056, acc=0.8897174873737375, fr=0.07697109878063202, time=0:00:04.199090, mask=0.8905029296875

-----------------------------

Epoch 40: train loss=0.01809755977592431, acc=0.9948995838994565, fr=0.07393919676542282, lr=0.0005764800999999997, time=0:00:27.761090
Epoch 40: valid loss=0.38512078755431706, acc=0.8998184974747474, fr=0.07708486169576645, time=0:00:04.318979, mask=0.89227294921875

-----------------------------

Epoch 41: train loss=0.018293279164936393, acc=0.9960459833559783, fr=0.0740654319524765, lr=0.00040353606999999974, time=0:00:28.332302
Epoch 41: valid loss=0.36624085737599266, acc=0.905066287878788, fr=0.0770680382847786, time=0:00:04.923924, mask=0.8948974609375

-----------------------------

Epoch 42: train loss=0.02016734143035137, acc=0.994140625, fr=0.0741281509399414, lr=0.00040353606999999974, time=0:00:30.705508
Epoch 42: valid loss=0.3724217133389579, acc=0.8994239267676769, fr=0.07690386474132538, time=0:00:05.447316, mask=0.8963623046875

-----------------------------

Epoch 43: train loss=0.016094363934826106, acc=0.9959716796875, fr=0.07374649494886398, lr=0.00040353606999999974, time=0:00:29.987617
Epoch 43: valid loss=0.35408086164130104, acc=0.9041982323232324, fr=0.077291339635849, time=0:00:04.547798, mask=0.8983154296875

-----------------------------

Epoch 44: train loss=0.018639760553924134, acc=0.99560546875, fr=0.07358656823635101, lr=0.0002824752489999998, time=0:00:28.967660
Epoch 44: valid loss=0.36603788617584443, acc=0.8987531565656565, fr=0.07647328078746796, time=0:00:04.536510, mask=0.89996337890625

-----------------------------

Epoch 45: train loss=0.01913609181792708, acc=0.9944590692934783, fr=0.07348643988370895, lr=0.0002824752489999998, time=0:00:28.956348
Epoch 45: valid loss=0.36703085237079197, acc=0.9046322601010102, fr=0.07655641436576843, time=0:00:04.503979, mask=0.90234375

-----------------------------

Epoch 46: train loss=0.017941849830094725, acc=0.99560546875, fr=0.0732838436961174, lr=0.0002824752489999998, time=0:00:30.298946
Epoch 46: valid loss=0.36843648966815734, acc=0.8954782196969696, fr=0.07629133760929108, time=0:00:04.615141, mask=0.90447998046875

-----------------------------

Epoch 47: train loss=0.020335709741630126, acc=0.9942414656929348, fr=0.07293177396059036, lr=0.00019773267429999984, time=0:00:29.413139
Epoch 47: valid loss=0.36084718588325715, acc=0.8989898989898991, fr=0.07601438462734222, time=0:00:04.810902, mask=0.9061279296875

-----------------------------

Epoch 48: train loss=0.019162451513693668, acc=0.995361328125, fr=0.07264959067106247, lr=0.00019773267429999984, time=0:00:30.266158
Epoch 48: valid loss=0.37506913228167427, acc=0.8985953282828283, fr=0.07564905285835266, time=0:00:04.403814, mask=0.90826416015625

-----------------------------

Epoch 49: train loss=0.017303143547906075, acc=0.9962901239809783, fr=0.07273992896080017, lr=0.00019773267429999984, time=0:00:27.942965
Epoch 49: valid loss=0.3424687385559082, acc=0.901160037878788, fr=0.07567992806434631, time=0:00:04.351743, mask=0.909912109375

-----------------------------

Epoch 50: train loss=0.01985251878068084, acc=0.9948252802309783, fr=0.0722801461815834, lr=0.00013841287200999988, time=0:00:28.048228
Epoch 50: valid loss=0.37973156985309386, acc=0.9041982323232324, fr=0.07533455640077591, time=0:00:04.221441, mask=0.91180419921875

-----------------------------


Best valid acc at epoch 25: 0.9070391414141414


------ Training finished ------

Loading best model, epoch=25, valid acc=0.9070391414141414

------ Begin Testing ------

Test loss=0.6446168455812666, acc=0.8237452651515151, mean act rate=0.07210100442171097

-----------------------------


This dataset uses the same split for validation and testing.

