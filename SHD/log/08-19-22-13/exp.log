===== Exp configuration =====
date:		08-19-22-13
save_dir:		./log/08-19-22-13
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		1
scheduler_patience:		5
scheduler_factor:		0.7
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		2.0
reg_fmin:		0.01
reg_fmax:		0.1
fr_ent:		0.5
seed:		1692454396
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		batchnorm
train_input:		True
nb_hiddens:		1024
noise_test:		0.0
device:		cuda:0

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (norm_read): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1793104

**************  Trial 1  **************
Epoch -1: cin|cout=0.001543|0.014493
Epoch 1: loss=14.2015|4.0083, acc=24.4973|13.6484, fr=0.3736, cin|cout=0.007686|0.035403, lr=0.0150, time=10.952246
-----------------------------

Epoch 2: loss=9.1695|1.9443, acc=34.1957|49.1166, fr=0.3599, cin|cout=0.011436|0.052963, lr=0.0150, time=09.618206
-----------------------------

Epoch 3: loss=8.0113|1.2282, acc=56.3634|69.3905, fr=0.3663, cin|cout=0.014609|0.070188, lr=0.0150, time=09.800475
-----------------------------

Epoch 4: loss=7.4651|0.7707, acc=70.5370|77.7827, fr=0.3893, cin|cout=0.018015|0.088316, lr=0.0150, time=09.760515
-----------------------------

Epoch 5: loss=7.1137|0.5951, acc=81.3757|81.9788, fr=0.4029, cin|cout=0.021835|0.106196, lr=0.0150, time=10.381145
-----------------------------

Epoch 6: loss=7.0143|0.4280, acc=86.1942|88.2509, fr=0.4028, cin|cout=0.025619|0.124814, lr=0.0150, time=09.894386

Best model saved with valid acc=88.25088339222614

Parameter containing:
tensor([0.7695, 1.0265, 0.8772,  ..., 1.0502, 0.2473, 0.7908], device='cuda:0',
       requires_grad=True)
-----------------------------

Epoch 7: loss=6.8460|0.5055, acc=90.2281|85.6890, fr=0.4001, cin|cout=0.029505|0.143459, lr=0.0150, time=09.823330
-----------------------------

Epoch 8: loss=6.7849|0.4924, acc=91.3561|85.6449, fr=0.4004, cin|cout=0.033632|0.162541, lr=0.0150, time=09.915447
-----------------------------

Epoch 9: loss=6.7109|0.4466, acc=93.2197|87.8092, fr=0.4070, cin|cout=0.038088|0.181782, lr=0.0150, time=09.753378
-----------------------------

Epoch 10: loss=6.6514|0.4201, acc=95.0221|88.7809, fr=0.4171, cin|cout=0.042488|0.201889, lr=0.0150, time=09.647049

Best model saved with valid acc=88.78091872791519

Parameter containing:
tensor([0.7860, 1.0576, 0.8757,  ..., 1.0557, 0.0322, 0.7926], device='cuda:0',
       requires_grad=True)
-----------------------------

Epoch 11: loss=6.6049|0.4163, acc=96.6160|88.6926, fr=0.4139, cin|cout=0.047277|0.221718, lr=0.0150, time=09.768552
-----------------------------

Epoch 12: loss=6.5744|0.3866, acc=97.3026|89.8852, fr=0.4252, cin|cout=0.051857|0.242367, lr=0.0150, time=09.666570

Best model saved with valid acc=89.8851590106007

Parameter containing:
tensor([ 0.7961,  1.0798,  0.8746,  ...,  1.0582, -0.0101,  0.7939],
       device='cuda:0', requires_grad=True)
-----------------------------

Epoch 13: loss=6.5569|0.3990, acc=97.9524|90.4152, fr=0.4320, cin|cout=0.056721|0.262809, lr=0.0150, time=09.606614

Best model saved with valid acc=90.41519434628975

Parameter containing:
tensor([ 0.8015,  1.0922,  0.8753,  ...,  1.0593, -0.0195,  0.7945],
       device='cuda:0', requires_grad=True)
-----------------------------

Epoch 14: loss=6.5235|0.4078, acc=98.4306|90.9452, fr=0.4429, cin|cout=0.061517|0.283700, lr=0.0150, time=09.511796

Best model saved with valid acc=90.9452296819788

Parameter containing:
tensor([ 0.8069,  1.1055,  0.8766,  ...,  1.0604, -0.0265,  0.7952],
       device='cuda:0', requires_grad=True)
-----------------------------

Epoch 15: loss=6.4968|0.3980, acc=98.7494|90.9011, fr=0.4394, cin|cout=0.066349|0.304747, lr=0.0150, time=09.652603
-----------------------------

Epoch 16: loss=6.4740|0.4273, acc=98.7126|89.7968, fr=0.4416, cin|cout=0.071157|0.325986, lr=0.0150, time=10.139960
-----------------------------

Epoch 17: loss=6.4498|0.4583, acc=99.0682|89.0459, fr=0.4421, cin|cout=0.075868|0.347374, lr=0.0150, time=09.833907
-----------------------------

Epoch 18: loss=6.4453|0.4231, acc=99.1417|90.3269, fr=0.4285, cin|cout=0.080742|0.368644, lr=0.0150, time=09.631258
-----------------------------

Epoch 19: loss=6.4001|0.4131, acc=99.4115|90.6360, fr=0.4435, cin|cout=0.085585|0.390073, lr=0.0150, time=10.206418
-----------------------------

Epoch 20: loss=6.3741|0.3939, acc=99.4605|91.3428, fr=0.4522, cin|cout=0.090256|0.411684, lr=0.0150, time=09.566287

Best model saved with valid acc=91.34275618374558

Parameter containing:
tensor([0.8375, 1.2023, 0.8773,  ..., 1.0660, 0.1296, 0.8001], device='cuda:0',
       requires_grad=True)
-----------------------------

Epoch 21: loss=6.3557|0.4251, acc=99.6444|89.3110, fr=0.4619, cin|cout=0.094854|0.433392, lr=0.0150, time=09.721219
-----------------------------

Epoch 22: loss=6.3232|0.4643, acc=99.5341|89.0018, fr=0.4520, cin|cout=0.099523|0.455095, lr=0.0150, time=09.587360
-----------------------------

Epoch 23: loss=6.2919|0.4247, acc=99.6935|91.2544, fr=0.4441, cin|cout=0.104106|0.476940, lr=0.0150, time=09.530495
-----------------------------

Epoch 24: loss=6.2742|0.4608, acc=99.7793|90.1943, fr=0.4388, cin|cout=0.108760|0.498622, lr=0.0150, time=09.667985
-----------------------------

Epoch 25: loss=6.2336|0.4652, acc=99.9142|89.7968, fr=0.4409, cin|cout=0.113182|0.520487, lr=0.0150, time=09.531040
-----------------------------

Epoch 26: loss=6.2073|0.4568, acc=99.9510|90.1060, fr=0.4471, cin|cout=0.117563|0.542325, lr=0.0150, time=09.619208
-----------------------------

Epoch 27: loss=6.1963|0.4474, acc=99.9755|91.1219, fr=0.4548, cin|cout=0.120434|0.557779, lr=0.0105, time=09.516350
-----------------------------

Epoch 28: loss=6.1724|0.5123, acc=99.9632|89.1343, fr=0.4627, cin|cout=0.123409|0.573175, lr=0.0105, time=09.546893
-----------------------------

Epoch 29: loss=6.1570|0.5046, acc=99.9632|89.1784, fr=0.4601, cin|cout=0.126524|0.588426, lr=0.0105, time=09.579595
-----------------------------

Epoch 30: loss=6.1394|0.4757, acc=99.9755|89.9293, fr=0.4781, cin|cout=0.129613|0.603722, lr=0.0105, time=09.545942
-----------------------------

Epoch 31: loss=6.1254|0.4556, acc=99.9632|90.7244, fr=0.4832, cin|cout=0.132646|0.619154, lr=0.0105, time=09.706852
-----------------------------

Epoch 32: loss=6.1134|0.4853, acc=99.9877|90.1943, fr=0.4859, cin|cout=0.135847|0.634458, lr=0.0105, time=09.623820
-----------------------------

Epoch 33: loss=6.0899|0.4681, acc=100.0000|90.9894, fr=0.4974, cin|cout=0.137950|0.645300, lr=0.0073, time=09.590388
-----------------------------

Epoch 34: loss=6.0812|0.4823, acc=99.9877|91.1661, fr=0.5048, cin|cout=0.140048|0.656164, lr=0.0073, time=09.593306
-----------------------------

Epoch 35: loss=6.0680|0.4881, acc=100.0000|89.7527, fr=0.5112, cin|cout=0.142128|0.667093, lr=0.0073, time=09.589247
-----------------------------

Epoch 36: loss=6.0624|0.4737, acc=100.0000|90.0618, fr=0.5109, cin|cout=0.144188|0.678091, lr=0.0073, time=09.611666
-----------------------------

Epoch 37: loss=6.0492|0.4797, acc=100.0000|90.1502, fr=0.5171, cin|cout=0.146321|0.689051, lr=0.0073, time=09.612921
-----------------------------

Epoch 38: loss=6.0397|0.4610, acc=100.0000|90.8127, fr=0.5281, cin|cout=0.148403|0.700106, lr=0.0073, time=09.618407
-----------------------------

Epoch 39: loss=6.0326|0.4609, acc=100.0000|90.9452, fr=0.5305, cin|cout=0.149874|0.707856, lr=0.0051, time=09.618394
-----------------------------

Epoch 40: loss=6.0258|0.4987, acc=100.0000|89.8852, fr=0.5226, cin|cout=0.151280|0.715730, lr=0.0051, time=09.583244
-----------------------------

Epoch 41: loss=6.0174|0.4657, acc=100.0000|90.6802, fr=0.5225, cin|cout=0.152811|0.723503, lr=0.0051, time=09.653328
-----------------------------

Epoch 42: loss=6.0100|0.4882, acc=100.0000|90.0177, fr=0.5293, cin|cout=0.154314|0.731335, lr=0.0051, time=09.627562
-----------------------------

Epoch 43: loss=6.0026|0.5097, acc=100.0000|89.3993, fr=0.5349, cin|cout=0.155811|0.739201, lr=0.0051, time=09.564730
-----------------------------

Epoch 44: loss=5.9951|0.4833, acc=100.0000|90.2385, fr=0.5394, cin|cout=0.157301|0.747108, lr=0.0051, time=09.696191
-----------------------------

Epoch 45: loss=5.9878|0.4820, acc=100.0000|90.8569, fr=0.5458, cin|cout=0.158311|0.752696, lr=0.0036, time=09.836182
-----------------------------

Epoch 46: loss=5.9819|0.4871, acc=100.0000|90.5477, fr=0.5431, cin|cout=0.159326|0.758303, lr=0.0036, time=09.862374
-----------------------------

Epoch 47: loss=5.9767|0.4947, acc=100.0000|90.4152, fr=0.5493, cin|cout=0.160393|0.763890, lr=0.0036, time=09.613387
-----------------------------

Epoch 48: loss=5.9759|0.4679, acc=100.0000|90.4594, fr=0.5453, cin|cout=0.161435|0.769541, lr=0.0036, time=09.580195
-----------------------------

Epoch 49: loss=5.9720|0.4879, acc=100.0000|90.1502, fr=0.5428, cin|cout=0.162495|0.775197, lr=0.0036, time=09.581237
-----------------------------

Epoch 50: loss=5.9640|0.4905, acc=100.0000|90.3269, fr=0.5526, cin|cout=0.163532|0.780892, lr=0.0036, time=09.581872
-----------------------------

Epoch 51: loss=5.9577|0.4888, acc=100.0000|89.6201, fr=0.5536, cin|cout=0.164266|0.784891, lr=0.0025, time=09.633268
-----------------------------

Epoch 52: loss=5.9537|0.4917, acc=100.0000|90.1060, fr=0.5598, cin|cout=0.164981|0.788931, lr=0.0025, time=09.621847
-----------------------------

Epoch 53: loss=5.9509|0.4939, acc=100.0000|89.7527, fr=0.5591, cin|cout=0.165694|0.792989, lr=0.0025, time=09.581796
-----------------------------

Epoch 54: loss=5.9464|0.4959, acc=100.0000|89.7968, fr=0.5627, cin|cout=0.166429|0.797057, lr=0.0025, time=09.668432
-----------------------------

Epoch 55: loss=5.9427|0.4863, acc=100.0000|90.2827, fr=0.5630, cin|cout=0.167147|0.801163, lr=0.0025, time=09.582240
-----------------------------

Epoch 56: loss=5.9382|0.4918, acc=100.0000|90.4152, fr=0.5639, cin|cout=0.167890|0.805261, lr=0.0025, time=09.583514
-----------------------------

Epoch 57: loss=5.9344|0.4898, acc=100.0000|90.1502, fr=0.5694, cin|cout=0.168400|0.808151, lr=0.0018, time=09.611226
-----------------------------

Epoch 58: loss=5.9320|0.5003, acc=100.0000|90.0177, fr=0.5711, cin|cout=0.168901|0.811062, lr=0.0018, time=09.627937
-----------------------------

Epoch 59: loss=5.9295|0.4912, acc=100.0000|90.1943, fr=0.5731, cin|cout=0.169418|0.813972, lr=0.0018, time=09.633239
-----------------------------

Epoch 60: loss=5.9270|0.4851, acc=100.0000|90.4594, fr=0.5784, cin|cout=0.169940|0.816900, lr=0.0018, time=09.535712
-----------------------------

Epoch 61: loss=5.9235|0.5056, acc=100.0000|89.7968, fr=0.5819, cin|cout=0.170429|0.819866, lr=0.0018, time=09.698877
-----------------------------

Epoch 62: loss=5.9210|0.4979, acc=100.0000|89.7527, fr=0.5796, cin|cout=0.170949|0.822819, lr=0.0018, time=09.604573
-----------------------------

Epoch 63: loss=5.9181|0.4971, acc=100.0000|90.2385, fr=0.5806, cin|cout=0.171287|0.824917, lr=0.0012, time=09.844445
-----------------------------

Epoch 64: loss=5.9161|0.4913, acc=100.0000|89.8852, fr=0.5816, cin|cout=0.171649|0.827004, lr=0.0012, time=09.596707
-----------------------------

Epoch 65: loss=5.9136|0.4948, acc=100.0000|89.9293, fr=0.5867, cin|cout=0.172013|0.829099, lr=0.0012, time=09.547945
-----------------------------

Epoch 66: loss=5.9121|0.4918, acc=100.0000|90.5035, fr=0.5901, cin|cout=0.172365|0.831216, lr=0.0012, time=09.639718
-----------------------------

Epoch 67: loss=5.9104|0.4950, acc=100.0000|90.1943, fr=0.5893, cin|cout=0.172716|0.833347, lr=0.0012, time=09.642138
-----------------------------

Epoch 68: loss=5.8979|0.4895, acc=100.0000|90.1060, fr=0.5923, cin|cout=0.173083|0.835473, lr=0.0012, time=09.609521
-----------------------------

Epoch 69: loss=5.8858|0.5071, acc=100.0000|90.1943, fr=0.5966, cin|cout=0.173333|0.836973, lr=0.0009, time=09.678771
-----------------------------

Epoch 70: loss=5.8845|0.4945, acc=100.0000|90.0177, fr=0.5986, cin|cout=0.173584|0.838480, lr=0.0009, time=09.656904
-----------------------------

Epoch 71: loss=5.8831|0.4990, acc=100.0000|90.1060, fr=0.6009, cin|cout=0.173831|0.839999, lr=0.0009, time=09.688660
-----------------------------

Epoch 72: loss=5.8819|0.4999, acc=100.0000|89.9293, fr=0.5989, cin|cout=0.174070|0.841531, lr=0.0009, time=09.542676
-----------------------------

Epoch 73: loss=5.8803|0.4970, acc=100.0000|90.0618, fr=0.6011, cin|cout=0.174323|0.843058, lr=0.0009, time=09.577382
-----------------------------

Epoch 74: loss=5.8783|0.4991, acc=100.0000|90.1502, fr=0.6041, cin|cout=0.174574|0.844592, lr=0.0009, time=09.558253
-----------------------------

Epoch 75: loss=5.8771|0.4988, acc=100.0000|90.3269, fr=0.6067, cin|cout=0.174749|0.845674, lr=0.0006, time=09.581454
-----------------------------

Epoch 76: loss=5.8761|0.5017, acc=100.0000|90.0177, fr=0.6087, cin|cout=0.174922|0.846761, lr=0.0006, time=09.669731
-----------------------------

Epoch 77: loss=5.8750|0.4992, acc=100.0000|90.2385, fr=0.6111, cin|cout=0.175094|0.847853, lr=0.0006, time=09.614656
-----------------------------

Epoch 78: loss=5.8739|0.4986, acc=100.0000|89.8410, fr=0.6124, cin|cout=0.175267|0.848950, lr=0.0006, time=09.583982
-----------------------------

Epoch 79: loss=5.8730|0.4882, acc=100.0000|90.2385, fr=0.6133, cin|cout=0.175429|0.850063, lr=0.0006, time=09.589293
-----------------------------

Epoch 80: loss=5.8722|0.4992, acc=100.0000|90.5919, fr=0.6097, cin|cout=0.175597|0.851177, lr=0.0006, time=09.582013
-----------------------------

Epoch 81: loss=5.8706|0.5027, acc=100.0000|90.2827, fr=0.6104, cin|cout=0.175723|0.851950, lr=0.0004, time=09.622952
-----------------------------

Epoch 82: loss=5.8701|0.4989, acc=100.0000|90.3269, fr=0.6134, cin|cout=0.175847|0.852728, lr=0.0004, time=09.595311
-----------------------------

Epoch 83: loss=5.8694|0.4950, acc=100.0000|90.2827, fr=0.6162, cin|cout=0.175969|0.853510, lr=0.0004, time=09.620237
-----------------------------

Epoch 84: loss=5.8687|0.4997, acc=100.0000|90.0177, fr=0.6178, cin|cout=0.176081|0.854307, lr=0.0004, time=09.682223
-----------------------------

Epoch 85: loss=5.8678|0.5014, acc=100.0000|90.5919, fr=0.6177, cin|cout=0.176200|0.855101, lr=0.0004, time=09.498532
-----------------------------

Epoch 86: loss=5.8676|0.5059, acc=100.0000|90.0177, fr=0.6169, cin|cout=0.176302|0.855910, lr=0.0004, time=09.604070
-----------------------------

Epoch 87: loss=5.8664|0.5007, acc=100.0000|90.1943, fr=0.6171, cin|cout=0.176384|0.856470, lr=0.0003, time=09.586279
-----------------------------

Epoch 88: loss=5.8654|0.4960, acc=100.0000|90.0618, fr=0.6192, cin|cout=0.176471|0.857030, lr=0.0003, time=09.562888
-----------------------------

Epoch 89: loss=5.8655|0.5021, acc=100.0000|89.7085, fr=0.6207, cin|cout=0.176552|0.857596, lr=0.0003, time=09.536654
-----------------------------

Epoch 90: loss=5.8642|0.4999, acc=100.0000|89.9735, fr=0.6209, cin|cout=0.176634|0.858165, lr=0.0003, time=09.522694
-----------------------------

Epoch 91: loss=5.8634|0.5089, acc=100.0000|90.2827, fr=0.6215, cin|cout=0.176716|0.858736, lr=0.0003, time=09.681915
-----------------------------

Epoch 92: loss=5.8632|0.5065, acc=100.0000|89.7527, fr=0.6228, cin|cout=0.176802|0.859304, lr=0.0003, time=09.540463
-----------------------------

Epoch 93: loss=5.8627|0.4970, acc=100.0000|90.0618, fr=0.6245, cin|cout=0.176860|0.859706, lr=0.0002, time=09.533331
-----------------------------

Epoch 94: loss=5.8621|0.5038, acc=100.0000|89.9735, fr=0.6253, cin|cout=0.176918|0.860108, lr=0.0002, time=09.587400
-----------------------------

Epoch 95: loss=5.8621|0.4959, acc=100.0000|90.1060, fr=0.6253, cin|cout=0.176965|0.860522, lr=0.0002, time=09.535030
-----------------------------

Epoch 96: loss=5.8613|0.5081, acc=100.0000|89.8410, fr=0.6247, cin|cout=0.177022|0.860928, lr=0.0002, time=09.593303
-----------------------------

Epoch 97: loss=5.8610|0.5080, acc=100.0000|90.0618, fr=0.6260, cin|cout=0.177081|0.861335, lr=0.0002, time=09.572097
-----------------------------

Epoch 98: loss=5.8608|0.5039, acc=100.0000|89.6201, fr=0.6274, cin|cout=0.177138|0.861746, lr=0.0002, time=09.531322
-----------------------------

Epoch 99: loss=5.8601|0.5064, acc=100.0000|90.0177, fr=0.6274, cin|cout=0.177175|0.862037, lr=0.0001, time=09.618496
-----------------------------

Epoch 100: loss=5.8600|0.5035, acc=100.0000|89.8852, fr=0.6279, cin|cout=0.177216|0.862325, lr=0.0001, time=09.505687
-----------------------------


Best valid acc at epoch 20: 91.34275618374558

------ Training finished ------

