===== Exp configuration =====

neuron_type:		RadLIF
nb_inputs:		700
nb_outputs:		20
nb_layers:		2
nb_hiddens:		128
nb_steps:		200
pdrop:		0.1
normalization:		batchnorm
use_bias:		False
bidirectional:		False
date:		07-26-04-25
use_pretrained_model:		False
only_do_testing:		False
load_exp_folder:		None
new_exp_folder:		./log/07-26-04-25/
dataset_name:		shd
data_folder:		data/raw/
save_best:		True
batch_size:		128
nb_epochs:		50
start_epoch:		0
lr:		0.01
scheduler_patience:		2
scheduler_factor:		0.7
use_regularizers:		False
reg_factor:		0.5
reg_fmin:		0.01
reg_fmax:		0.1
use_augm:		False
use_readout_layer:		True
threshold:		1.0
device:		cuda

Device is set to cuda

Number of examples in train set: 8156
SHD does not have a validation split. Using test split.
Number of examples in test set: 2264

Created new spiking model:
 SNN(
  (snn): ModuleList(
    (0): RadLIFLayer(
      (W): Linear(in_features=700, out_features=128, bias=False)
      (V): Linear(in_features=128, out_features=128, bias=False)
      (norm): BatchNorm1d(128, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
    (1): ReadoutLayer(
      (W): Linear(in_features=128, out_features=20, bias=False)
      (norm): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
      (drop): Dropout(p=0.1, inplace=False)
    )
  )
)

Total number of trainable parameters is 109372

------ Begin training ------

Epoch 1: train loss=4.215658301487565, acc=0.23325513756793478, mean act rate=0.036244094371795654, lr=0.01, time=0:00:35.328255
Epoch 1: valid loss=1.8640026648839314, acc=0.3745659722222222, mean act rate=0.03781277313828468

Best model saved with valid acc=0.3745659722222222

-----------------------------

Epoch 2: train loss=1.1503667933866382, acc=0.6134351647418479, mean act rate=0.040198858827352524, lr=0.01, time=0:00:32.003596
Epoch 2: valid loss=1.4015406767527263, acc=0.5627761994949495, mean act rate=0.04520857334136963

Best model saved with valid acc=0.5627761994949495

-----------------------------

Epoch 3: train loss=0.6421609022654593, acc=0.7922310207201086, mean act rate=0.04672796279191971, lr=0.01, time=0:00:32.007589
Epoch 3: valid loss=1.0146569311618805, acc=0.706439393939394, mean act rate=0.051673900336027145

Best model saved with valid acc=0.706439393939394

-----------------------------

Epoch 4: train loss=0.43160006310790777, acc=0.8557235054347826, mean act rate=0.05437192693352699, lr=0.01, time=0:00:32.093900
Epoch 4: valid loss=0.5923041850328445, acc=0.8161695075757576, mean act rate=0.059865545481443405

Best model saved with valid acc=0.8161695075757576

-----------------------------

Epoch 5: train loss=0.30811148625798523, acc=0.9054751188858696, mean act rate=0.055027637630701065, lr=0.01, time=0:00:32.021220
Epoch 5: valid loss=0.7492315404944949, acc=0.7839330808080809, mean act rate=0.053052518516778946

-----------------------------

Epoch 6: train loss=0.21201705350540578, acc=0.9306216032608696, mean act rate=0.05483272299170494, lr=0.01, time=0:00:32.060148
Epoch 6: valid loss=0.550242950518926, acc=0.8257575757575757, mean act rate=0.05762498825788498

Best model saved with valid acc=0.8257575757575757

-----------------------------

Epoch 7: train loss=0.1723679348360747, acc=0.9487357761548914, mean act rate=0.05993454158306122, lr=0.01, time=0:00:32.638426
Epoch 7: valid loss=0.360767126083374, acc=0.8818655303030303, mean act rate=0.06312339007854462

Best model saved with valid acc=0.8818655303030303

-----------------------------

Epoch 8: train loss=0.12716096866643056, acc=0.9614788552989131, mean act rate=0.060169391334056854, lr=0.01, time=0:00:32.818949
Epoch 8: valid loss=0.8183842069572873, acc=0.8006628787878788, mean act rate=0.05743288993835449

-----------------------------

Epoch 9: train loss=0.11024605779675767, acc=0.9653108016304348, mean act rate=0.060873933136463165, lr=0.01, time=0:00:32.011660
Epoch 9: valid loss=0.669213871161143, acc=0.8218118686868687, mean act rate=0.06046757847070694

-----------------------------

Epoch 10: train loss=0.09916008805157617, acc=0.9712444802989131, mean act rate=0.06298940628767014, lr=0.01, time=0:00:32.400857
Epoch 10: valid loss=0.5196012308200201, acc=0.816958648989899, mean act rate=0.06538199633359909

-----------------------------

Epoch 11: train loss=0.07956762349931523, acc=0.9770030146059783, mean act rate=0.06058681011199951, lr=0.006999999999999999, time=0:00:32.112013
Epoch 11: valid loss=0.4524596350060569, acc=0.8770912247474747, mean act rate=0.06156942993402481

-----------------------------

Epoch 12: train loss=0.046797452872851864, acc=0.9881114130434783, mean act rate=0.0611795037984848, lr=0.006999999999999999, time=0:00:32.199902
Epoch 12: valid loss=0.4799431396855248, acc=0.8665167297979798, mean act rate=0.06285643577575684

-----------------------------

Epoch 13: train loss=0.03884885224397294, acc=0.990478515625, mean act rate=0.0611296147108078, lr=0.006999999999999999, time=0:00:32.239817
Epoch 13: valid loss=0.5535962217383914, acc=0.8509311868686869, mean act rate=0.06246542930603027

-----------------------------

Epoch 14: train loss=0.029205358601757325, acc=0.9925802479619565, mean act rate=0.061767127364873886, lr=0.004899999999999999, time=0:00:32.155986
Epoch 14: valid loss=0.4669750846094555, acc=0.8675820707070707, mean act rate=0.062170352786779404

-----------------------------

Epoch 15: train loss=0.022330891952151433, acc=0.9951914911684783, mean act rate=0.06191396713256836, lr=0.004899999999999999, time=0:00:32.378264
Epoch 15: valid loss=0.5343293067481782, acc=0.8680160984848485, mean act rate=0.06142877787351608

-----------------------------

Epoch 16: train loss=0.022288778483925853, acc=0.994873046875, mean act rate=0.061625976115465164, lr=0.004899999999999999, time=0:00:33.085220
Epoch 16: valid loss=0.43069111307462055, acc=0.8747238005050505, mean act rate=0.06472700834274292

-----------------------------

Epoch 17: train loss=0.017590779934835155, acc=0.9967041015625, mean act rate=0.06327845901250839, lr=0.003429999999999999, time=0:00:32.428602
Epoch 17: valid loss=0.40019625342554516, acc=0.8916508838383839, mean act rate=0.06362822651863098

Best model saved with valid acc=0.8916508838383839

-----------------------------

Epoch 18: train loss=0.016911957696720492, acc=0.9967041015625, mean act rate=0.06290137022733688, lr=0.003429999999999999, time=0:00:32.305981
Epoch 18: valid loss=0.4154668202002843, acc=0.8883759469696969, mean act rate=0.06450313329696655

-----------------------------

Epoch 19: train loss=0.016255768459814135, acc=0.9968527088994565, mean act rate=0.0633985847234726, lr=0.003429999999999999, time=0:00:32.606652
Epoch 19: valid loss=0.42051633612977135, acc=0.8875473484848485, mean act rate=0.06480509787797928

-----------------------------

Epoch 20: train loss=0.014355004928802373, acc=0.9970225458559783, mean act rate=0.0627325102686882, lr=0.003429999999999999, time=0:00:32.340847
Epoch 20: valid loss=0.43538374039861893, acc=0.8823390151515151, mean act rate=0.06503287702798843

-----------------------------

Epoch 21: train loss=0.012918190735945245, acc=0.9979248046875, mean act rate=0.06297644972801208, lr=0.002400999999999999, time=0:00:32.310342
Epoch 21: valid loss=0.5280186086893082, acc=0.8675820707070707, mean act rate=0.06399605423212051

-----------------------------

Epoch 22: train loss=0.012391060528898379, acc=0.9970968495244565, mean act rate=0.06254928559064865, lr=0.002400999999999999, time=0:00:32.439511
Epoch 22: valid loss=0.45061733822027844, acc=0.8875473484848485, mean act rate=0.06455481052398682

-----------------------------

Epoch 23: train loss=0.012628348187718075, acc=0.99755859375, mean act rate=0.06242554634809494, lr=0.002400999999999999, time=0:00:32.654150
Epoch 23: valid loss=0.44279957479900783, acc=0.8858112373737375, mean act rate=0.06532371789216995

-----------------------------

Epoch 24: train loss=0.008563990999391535, acc=0.998779296875, mean act rate=0.0635111927986145, lr=0.0016806999999999992, time=0:00:33.285412
Epoch 24: valid loss=0.4512042957875464, acc=0.8821022727272727, mean act rate=0.0650203600525856

-----------------------------

Epoch 25: train loss=0.00888866023706214, acc=0.9984130859375, mean act rate=0.06357356160879135, lr=0.0016806999999999992, time=0:00:33.074517
Epoch 25: valid loss=0.5425313396586312, acc=0.8662799873737375, mean act rate=0.06407176703214645

-----------------------------

Epoch 26: train loss=0.008593463429861004, acc=0.99853515625, mean act rate=0.06272037327289581, lr=0.0016806999999999992, time=0:00:32.725281
Epoch 26: valid loss=0.4050772181815571, acc=0.8903093434343435, mean act rate=0.0648634135723114

-----------------------------

Epoch 27: train loss=0.006491019825261901, acc=0.999755859375, mean act rate=0.06316497176885605, lr=0.0011764899999999994, time=0:00:32.858460
Epoch 27: valid loss=0.41657303604814744, acc=0.8918481691919192, mean act rate=0.06494304537773132

Best model saved with valid acc=0.8918481691919192

-----------------------------

Epoch 28: train loss=0.007058452511046198, acc=0.9991455078125, mean act rate=0.06334961205720901, lr=0.0011764899999999994, time=0:00:32.934700
Epoch 28: valid loss=0.4446447143952052, acc=0.8862058080808081, mean act rate=0.0653328076004982

-----------------------------

Epoch 29: train loss=0.007432580201566452, acc=0.9991455078125, mean act rate=0.06341934949159622, lr=0.0011764899999999994, time=0:00:32.701516
Epoch 29: valid loss=0.4242206886410713, acc=0.8873500631313131, mean act rate=0.06493928283452988

-----------------------------

Epoch 30: train loss=0.006415103447579895, acc=0.99951171875, mean act rate=0.06374780833721161, lr=0.0011764899999999994, time=0:00:32.715264
Epoch 30: valid loss=0.45275421771738267, acc=0.8806029040404041, mean act rate=0.06550659984350204

-----------------------------

Epoch 31: train loss=0.007605134913319489, acc=0.99951171875, mean act rate=0.06341054290533066, lr=0.0008235429999999996, time=0:00:32.741305
Epoch 31: valid loss=0.5065871526797613, acc=0.8734611742424243, mean act rate=0.06443335860967636

-----------------------------

Epoch 32: train loss=0.005787773558040499, acc=0.9993896484375, mean act rate=0.0635359063744545, lr=0.0008235429999999996, time=0:00:33.398530
Epoch 32: valid loss=0.44560835013786954, acc=0.8890467171717172, mean act rate=0.06564778834581375

-----------------------------

Epoch 33: train loss=0.005853395399753936, acc=0.99951171875, mean act rate=0.06373792141675949, lr=0.0008235429999999996, time=0:00:32.642613
Epoch 33: valid loss=0.46727745566103196, acc=0.8808001893939393, mean act rate=0.06531736254692078

-----------------------------

Epoch 34: train loss=0.005609000882031978, acc=0.999755859375, mean act rate=0.063742995262146, lr=0.0005764800999999997, time=0:00:32.873954
Epoch 34: valid loss=0.5096573465400271, acc=0.8717250631313131, mean act rate=0.0661873146891594

-----------------------------

Epoch 35: train loss=0.004677882239775499, acc=0.9998779296875, mean act rate=0.06439054012298584, lr=0.0005764800999999997, time=0:00:32.989768
Epoch 35: valid loss=0.4500563368201256, acc=0.8905066287878787, mean act rate=0.06568253040313721

-----------------------------

Epoch 36: train loss=0.005069063323389855, acc=0.9996337890625, mean act rate=0.0640912875533104, lr=0.0005764800999999997, time=0:00:33.182341
Epoch 36: valid loss=0.47163621087869007, acc=0.8814315025252525, mean act rate=0.06553571671247482

-----------------------------

Epoch 37: train loss=0.004408988024806604, acc=0.9996337890625, mean act rate=0.06427858024835587, lr=0.00040353606999999974, time=0:00:33.000047
Epoch 37: valid loss=0.4586687237024307, acc=0.8831676136363636, mean act rate=0.06601041555404663

-----------------------------

Epoch 38: train loss=0.005204691757171531, acc=0.999755859375, mean act rate=0.06420602649450302, lr=0.00040353606999999974, time=0:00:33.040883
Epoch 38: valid loss=0.4813443016674783, acc=0.8836016414141414, mean act rate=0.06545571237802505

-----------------------------

Epoch 39: train loss=0.005216948715315084, acc=0.999755859375, mean act rate=0.06410513073205948, lr=0.00040353606999999974, time=0:00:33.126074
Epoch 39: valid loss=0.45283740427758956, acc=0.8853772095959597, mean act rate=0.06565725803375244

-----------------------------

Epoch 40: train loss=0.0048885575070016785, acc=0.999755859375, mean act rate=0.06397959589958191, lr=0.0002824752489999998, time=0:00:33.716505
Epoch 40: valid loss=0.48347144822279614, acc=0.8775252525252525, mean act rate=0.06546888500452042

-----------------------------

Epoch 41: train loss=0.004418138039909536, acc=0.999755859375, mean act rate=0.06406566500663757, lr=0.0002824752489999998, time=0:00:32.902715
Epoch 41: valid loss=0.4733946654531691, acc=0.8827335858585859, mean act rate=0.06544928252696991

-----------------------------

Epoch 42: train loss=0.004583580175676616, acc=0.9996337890625, mean act rate=0.06403228640556335, lr=0.0002824752489999998, time=0:00:33.021524
Epoch 42: valid loss=0.46657034589184654, acc=0.8818655303030303, mean act rate=0.06591720134019852

-----------------------------

Epoch 43: train loss=0.005062171610916266, acc=0.99951171875, mean act rate=0.06416770070791245, lr=0.00019773267429999984, time=0:00:32.907495
Epoch 43: valid loss=0.4755907389852736, acc=0.8777619949494949, mean act rate=0.06584598869085312

-----------------------------

Epoch 44: train loss=0.005597328243311495, acc=0.999267578125, mean act rate=0.06430178880691528, lr=0.00019773267429999984, time=0:00:33.184284
Epoch 44: valid loss=0.4780655453602473, acc=0.8810369318181819, mean act rate=0.06586326658725739

-----------------------------

Epoch 45: train loss=0.005372751602408243, acc=0.999267578125, mean act rate=0.06436887383460999, lr=0.00019773267429999984, time=0:00:32.878507
Epoch 45: valid loss=0.4495822423034244, acc=0.8810369318181819, mean act rate=0.06587700545787811

-----------------------------

Epoch 46: train loss=0.004330769092121045, acc=0.999755859375, mean act rate=0.06447731703519821, lr=0.00013841287200999988, time=0:00:33.195837
Epoch 46: valid loss=0.46593152897225487, acc=0.8849431818181819, mean act rate=0.06599633395671844

-----------------------------

Epoch 47: train loss=0.0040298474359588, acc=0.9998779296875, mean act rate=0.0644523948431015, lr=0.00013841287200999988, time=0:00:33.084584
Epoch 47: valid loss=0.45604629400703645, acc=0.883364898989899, mean act rate=0.06608083099126816

-----------------------------

Epoch 48: train loss=0.004300550939660752, acc=0.9996337890625, mean act rate=0.06446012854576111, lr=0.00013841287200999988, time=0:00:33.543716
Epoch 48: valid loss=0.47085842655764687, acc=0.8821417297979798, mean act rate=0.06633329391479492

-----------------------------

Epoch 49: train loss=0.004381118144010543, acc=0.9996337890625, mean act rate=0.06449868530035019, lr=9.688901040699991e-05, time=0:00:33.597751
Epoch 49: valid loss=0.4840020040671031, acc=0.8766571969696969, mean act rate=0.06607159227132797

-----------------------------

Epoch 50: train loss=0.005591900353465462, acc=0.9991455078125, mean act rate=0.06451138108968735, lr=9.688901040699991e-05, time=0:00:33.161947
Epoch 50: valid loss=0.4516724977228377, acc=0.8840356691919191, mean act rate=0.06616005301475525

-----------------------------


Best valid acc at epoch 27: 0.8918481691919192


------ Training finished ------

Loading best model, epoch=27, valid acc=0.8918481691919192

------ Begin Testing ------

Test loss=0.4099040726820628, acc=0.8918481691919192, mean act rate=0.0648903176188469

-----------------------------


This dataset uses the same split for validation and testing.

