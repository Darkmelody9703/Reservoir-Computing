===== Exp configuration =====
date:		08-19-23-16
save_dir:		./log/08-19-23-16
dataset_name:		shd
data_folder:		./data/raw/
input_dim:		700
output_dim:		20
nb_steps:		100
trials:		1
scheduler_patience:		5
scheduler_factor:		0.7
batch_size:		512
nb_epochs:		100
lr:		0.015
weight_decay:		1e-05
reg_factor:		2.0
reg_fmin:		0.01
reg_fmax:		0.1
fr_ent:		0.1
seed:		1692458182
ckpt_freq:		10
threshold:		1.0
smoothing:		0.1
pdrop:		0.1
normalization:		batchnorm
train_input:		True
nb_hiddens:		1024
noise_test:		0.0
device:		cuda:0

Created new spiking model:
 RC(
  (W): Linear(in_features=700, out_features=1024, bias=True)
  (V): Linear(in_features=1024, out_features=1024, bias=False)
  (read): Linear(in_features=1024, out_features=20, bias=True)
  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (norm_read): BatchNorm1d(20, eps=1e-05, momentum=0.05, affine=True, track_running_stats=True)
  (drop): Dropout(p=0.1, inplace=False)
)

Total number of trainable parameters is 1793104

**************  Trial 1  **************
Epoch -1: cin|cout=0.001478|0.014295|9.6727
Epoch 1: loss=17.0073|4.7023, acc=24.1417|13.1184, fr=0.3624, cin|cout=0.007215|0.031428|4.3562, lr=0.0150, time=10.855778
-----------------------------

Epoch 2: loss=9.7451|2.2538, acc=34.2079|45.0088, fr=0.3156, cin|cout=0.009676|0.035135|3.6311, lr=0.0150, time=09.662484
-----------------------------

Epoch 3: loss=8.1234|1.1949, acc=56.2776|69.3021, fr=0.3224, cin|cout=0.010566|0.036042|3.4111, lr=0.0150, time=09.929333
-----------------------------

Epoch 4: loss=7.5984|0.8653, acc=72.9279|79.3728, fr=0.3595, cin|cout=0.010863|0.036412|3.3518, lr=0.0150, time=09.809072
-----------------------------

Epoch 5: loss=7.3296|0.6640, acc=80.6891|78.4452, fr=0.3546, cin|cout=0.010973|0.036585|3.3342, lr=0.0150, time=10.188964
-----------------------------

Epoch 6: loss=7.1191|0.4601, acc=86.8808|88.6042, fr=0.3726, cin|cout=0.011043|0.036494|3.3048, lr=0.0150, time=10.191272

Best model saved with valid acc=88.60424028268551
-----------------------------

Epoch 7: loss=7.0330|0.4498, acc=90.0441|88.8693, fr=0.3851, cin|cout=0.011078|0.036433|3.2888, lr=0.0150, time=11.122823

Best model saved with valid acc=88.86925795053004
-----------------------------

Epoch 8: loss=7.0265|0.4876, acc=91.6871|86.0424, fr=0.3742, cin|cout=0.011124|0.036319|3.2650, lr=0.0150, time=09.848037
-----------------------------

Epoch 9: loss=6.9617|0.4474, acc=94.4213|89.0018, fr=0.3725, cin|cout=0.011128|0.036446|3.2752, lr=0.0150, time=09.787899

Best model saved with valid acc=89.0017667844523
-----------------------------

Epoch 10: loss=6.9007|0.3627, acc=95.6351|91.6078, fr=0.3728, cin|cout=0.011158|0.036837|3.3014, lr=0.0150, time=09.622814

Best model saved with valid acc=91.60777385159011
-----------------------------

Epoch 11: loss=6.8590|0.3844, acc=96.1010|90.4152, fr=0.3801, cin|cout=0.011210|0.036758|3.2789, lr=0.0150, time=09.642772
-----------------------------

Epoch 12: loss=6.8160|0.3898, acc=96.9103|90.4594, fr=0.3866, cin|cout=0.011270|0.036726|3.2588, lr=0.0150, time=09.626397
-----------------------------

Epoch 13: loss=6.8179|0.4057, acc=97.1432|89.1784, fr=0.3869, cin|cout=0.011297|0.036760|3.2540, lr=0.0150, time=09.852411
-----------------------------

Epoch 14: loss=6.7941|0.4082, acc=98.1609|90.6360, fr=0.3943, cin|cout=0.011319|0.036705|3.2426, lr=0.0150, time=09.638415
-----------------------------

Epoch 15: loss=6.6987|0.4097, acc=98.7003|90.8127, fr=0.3952, cin|cout=0.011331|0.036943|3.2605, lr=0.0150, time=09.610366
-----------------------------

Epoch 16: loss=6.7027|0.4184, acc=98.7739|90.1502, fr=0.3971, cin|cout=0.011360|0.036850|3.2439, lr=0.0150, time=09.637098
-----------------------------

Epoch 17: loss=6.6898|0.3937, acc=99.1663|92.5795, fr=0.3981, cin|cout=0.011372|0.036873|3.2425, lr=0.0105, time=09.687573

Best model saved with valid acc=92.57950530035336
-----------------------------

Epoch 18: loss=6.6792|0.4010, acc=99.3379|91.4753, fr=0.4011, cin|cout=0.011383|0.036798|3.2328, lr=0.0105, time=09.678970
-----------------------------

Epoch 19: loss=6.6676|0.4057, acc=99.5709|91.0777, fr=0.4072, cin|cout=0.011398|0.036885|3.2361, lr=0.0105, time=09.572552
-----------------------------

Epoch 20: loss=6.6631|0.4241, acc=99.6812|90.8569, fr=0.4099, cin|cout=0.011394|0.037016|3.2488, lr=0.0105, time=09.585539
-----------------------------

Epoch 21: loss=6.6528|0.4155, acc=99.7670|91.4753, fr=0.4140, cin|cout=0.011412|0.036989|3.2411, lr=0.0105, time=09.694283
-----------------------------

Epoch 22: loss=6.6490|0.4159, acc=99.8283|91.5194, fr=0.4204, cin|cout=0.011429|0.036973|3.2349, lr=0.0105, time=09.582188
-----------------------------

Epoch 23: loss=6.6459|0.4079, acc=99.8161|91.5194, fr=0.4221, cin|cout=0.011434|0.036960|3.2323, lr=0.0105, time=09.619331
-----------------------------

Epoch 24: loss=6.6411|0.4366, acc=99.8651|91.2544, fr=0.4221, cin|cout=0.011447|0.036964|3.2291, lr=0.0073, time=09.641554
-----------------------------

Epoch 25: loss=6.6379|0.4469, acc=99.9019|91.2102, fr=0.4273, cin|cout=0.011458|0.036954|3.2252, lr=0.0073, time=09.561516
-----------------------------

Epoch 26: loss=6.6351|0.4543, acc=99.9387|90.6802, fr=0.4321, cin|cout=0.011463|0.037014|3.2289, lr=0.0073, time=09.641987
-----------------------------

Epoch 27: loss=6.6313|0.4617, acc=99.9632|90.5477, fr=0.4365, cin|cout=0.011467|0.037081|3.2337, lr=0.0073, time=09.602883
-----------------------------

Epoch 28: loss=6.6299|0.4552, acc=99.9632|90.5035, fr=0.4417, cin|cout=0.011470|0.037139|3.2380, lr=0.0073, time=09.593455
-----------------------------

Epoch 29: loss=6.6283|0.4554, acc=99.9755|90.7244, fr=0.4457, cin|cout=0.011474|0.037158|3.2386, lr=0.0073, time=09.605251
-----------------------------

Epoch 30: loss=6.6254|0.4523, acc=99.9755|91.5636, fr=0.4463, cin|cout=0.011478|0.037157|3.2372, lr=0.0051, time=09.610387
-----------------------------

Epoch 31: loss=6.6245|0.4614, acc=100.0000|91.0777, fr=0.4485, cin|cout=0.011484|0.037190|3.2385, lr=0.0051, time=10.430219
-----------------------------

Epoch 32: loss=6.6223|0.4511, acc=100.0000|90.8127, fr=0.4513, cin|cout=0.011488|0.037216|3.2395, lr=0.0051, time=09.561076
-----------------------------

Epoch 33: loss=6.6150|0.4445, acc=99.9755|91.1661, fr=0.4502, cin|cout=0.011492|0.037190|3.2362, lr=0.0051, time=09.642208
-----------------------------

Epoch 34: loss=6.6000|0.4673, acc=99.9877|90.9011, fr=0.4502, cin|cout=0.011499|0.037206|3.2356, lr=0.0051, time=09.539815
-----------------------------

Epoch 35: loss=6.5999|0.4757, acc=99.9877|90.7686, fr=0.4527, cin|cout=0.011506|0.037198|3.2330, lr=0.0051, time=09.571849
-----------------------------

Epoch 36: loss=6.5954|0.4800, acc=99.9755|89.9735, fr=0.4542, cin|cout=0.011508|0.037205|3.2329, lr=0.0036, time=09.582096
-----------------------------

Epoch 37: loss=6.5954|0.4666, acc=99.9755|90.9452, fr=0.4571, cin|cout=0.011511|0.037208|3.2322, lr=0.0036, time=09.567290
-----------------------------

Epoch 38: loss=6.5941|0.4819, acc=99.9877|90.3269, fr=0.4606, cin|cout=0.011517|0.037215|3.2315, lr=0.0036, time=09.598095
-----------------------------

Epoch 39: loss=6.5928|0.4765, acc=100.0000|90.6360, fr=0.4615, cin|cout=0.011516|0.037153|3.2262, lr=0.0036, time=09.619330
-----------------------------

Epoch 40: loss=6.5927|0.4933, acc=100.0000|90.5919, fr=0.4623, cin|cout=0.011521|0.037158|3.2252, lr=0.0036, time=09.608553
-----------------------------

Epoch 41: loss=6.5922|0.4819, acc=100.0000|90.7244, fr=0.4656, cin|cout=0.011526|0.037156|3.2238, lr=0.0036, time=09.607012
-----------------------------

Epoch 42: loss=6.5910|0.4790, acc=100.0000|91.0336, fr=0.4675, cin|cout=0.011528|0.037171|3.2244, lr=0.0025, time=09.606970
-----------------------------

Epoch 43: loss=6.5896|0.4946, acc=100.0000|90.6360, fr=0.4699, cin|cout=0.011532|0.037189|3.2249, lr=0.0025, time=09.608756
-----------------------------

Epoch 44: loss=6.5894|0.4903, acc=100.0000|90.3269, fr=0.4723, cin|cout=0.011532|0.037192|3.2250, lr=0.0025, time=09.587283
-----------------------------

Epoch 45: loss=6.5894|0.4765, acc=99.9877|91.1219, fr=0.4714, cin|cout=0.011536|0.037173|3.2224, lr=0.0025, time=09.544992
-----------------------------

Epoch 46: loss=6.5879|0.5000, acc=100.0000|90.1502, fr=0.4741, cin|cout=0.011538|0.037177|3.2222, lr=0.0025, time=09.653293
-----------------------------

Epoch 47: loss=6.5880|0.4814, acc=100.0000|90.5035, fr=0.4760, cin|cout=0.011541|0.037188|3.2222, lr=0.0025, time=09.600398
-----------------------------

Epoch 48: loss=6.5877|0.4791, acc=100.0000|91.2102, fr=0.4777, cin|cout=0.011543|0.037189|3.2218, lr=0.0018, time=09.624570
-----------------------------

Epoch 49: loss=6.5879|0.4768, acc=100.0000|90.6360, fr=0.4776, cin|cout=0.011546|0.037181|3.2203, lr=0.0018, time=09.540425
-----------------------------

Epoch 50: loss=6.5874|0.4954, acc=99.9877|90.4152, fr=0.4791, cin|cout=0.011546|0.037187|3.2207, lr=0.0018, time=09.647386
-----------------------------

Epoch 51: loss=6.5864|0.4768, acc=100.0000|91.1661, fr=0.4788, cin|cout=0.011547|0.037189|3.2208, lr=0.0018, time=09.704109
-----------------------------

Epoch 52: loss=6.5863|0.4847, acc=100.0000|90.8569, fr=0.4806, cin|cout=0.011548|0.037198|3.2211, lr=0.0018, time=09.621658
-----------------------------

Epoch 53: loss=6.5863|0.4826, acc=100.0000|90.5919, fr=0.4829, cin|cout=0.011550|0.037200|3.2209, lr=0.0018, time=09.572635
-----------------------------

Epoch 54: loss=6.5860|0.4903, acc=100.0000|90.6360, fr=0.4833, cin|cout=0.011550|0.037208|3.2214, lr=0.0012, time=09.627816
-----------------------------

Epoch 55: loss=6.5855|0.4882, acc=100.0000|90.3710, fr=0.4828, cin|cout=0.011552|0.037210|3.2211, lr=0.0012, time=09.630387
-----------------------------

Epoch 56: loss=6.5852|0.4835, acc=99.9877|90.7244, fr=0.4843, cin|cout=0.011554|0.037214|3.2210, lr=0.0012, time=09.568709
-----------------------------

Epoch 57: loss=6.5850|0.4965, acc=100.0000|90.5919, fr=0.4851, cin|cout=0.011553|0.037218|3.2216, lr=0.0012, time=09.611359
-----------------------------

Epoch 58: loss=6.5853|0.4887, acc=100.0000|90.3269, fr=0.4806, cin|cout=0.011552|0.037222|3.2222, lr=0.0012, time=09.647351
-----------------------------

Epoch 59: loss=6.5848|0.4973, acc=100.0000|90.5477, fr=0.4814, cin|cout=0.011554|0.037228|3.2221, lr=0.0012, time=09.600310
-----------------------------

Epoch 60: loss=6.5846|0.4887, acc=100.0000|90.6360, fr=0.4828, cin|cout=0.011555|0.037233|3.2223, lr=0.0009, time=09.559402
-----------------------------

Epoch 61: loss=6.5842|0.4942, acc=100.0000|90.5477, fr=0.4832, cin|cout=0.011556|0.037234|3.2222, lr=0.0009, time=09.713464
-----------------------------

Epoch 62: loss=6.5841|0.5036, acc=99.9877|90.2827, fr=0.4837, cin|cout=0.011557|0.037234|3.2217, lr=0.0009, time=09.574120
-----------------------------

Epoch 63: loss=6.5839|0.5029, acc=100.0000|90.3710, fr=0.4849, cin|cout=0.011559|0.037238|3.2216, lr=0.0009, time=09.589763
-----------------------------

Epoch 64: loss=6.5835|0.4922, acc=100.0000|90.7244, fr=0.4858, cin|cout=0.011560|0.037238|3.2213, lr=0.0009, time=09.637892
-----------------------------

Epoch 65: loss=6.5837|0.4974, acc=100.0000|90.1060, fr=0.4873, cin|cout=0.011561|0.037242|3.2214, lr=0.0009, time=09.555085
-----------------------------

Epoch 66: loss=6.5832|0.4855, acc=100.0000|90.7686, fr=0.4883, cin|cout=0.011562|0.037244|3.2213, lr=0.0006, time=09.612337
-----------------------------

Epoch 67: loss=6.5832|0.4999, acc=100.0000|90.2827, fr=0.4890, cin|cout=0.011561|0.037239|3.2210, lr=0.0006, time=09.553440
-----------------------------

Epoch 68: loss=6.5822|0.4903, acc=100.0000|91.2544, fr=0.4887, cin|cout=0.011562|0.037234|3.2204, lr=0.0006, time=09.541682
-----------------------------

Epoch 69: loss=6.5829|0.4993, acc=100.0000|90.9011, fr=0.4894, cin|cout=0.011562|0.037235|3.2203, lr=0.0006, time=09.638456
-----------------------------

Epoch 70: loss=6.5824|0.4936, acc=100.0000|90.7244, fr=0.4905, cin|cout=0.011563|0.037237|3.2204, lr=0.0006, time=09.558731
-----------------------------

Epoch 71: loss=6.5821|0.4962, acc=100.0000|90.7244, fr=0.4909, cin|cout=0.011564|0.037239|3.2203, lr=0.0006, time=09.677545
-----------------------------

Epoch 72: loss=6.5826|0.4876, acc=100.0000|90.9011, fr=0.4919, cin|cout=0.011564|0.037242|3.2204, lr=0.0004, time=09.602350
-----------------------------

Epoch 73: loss=6.5826|0.4994, acc=100.0000|90.5477, fr=0.4919, cin|cout=0.011565|0.037240|3.2201, lr=0.0004, time=09.572863
-----------------------------

Epoch 74: loss=6.5823|0.4994, acc=100.0000|90.4594, fr=0.4912, cin|cout=0.011565|0.037237|3.2197, lr=0.0004, time=09.588354
-----------------------------

Epoch 75: loss=6.5824|0.4974, acc=100.0000|90.7686, fr=0.4920, cin|cout=0.011565|0.037238|3.2197, lr=0.0004, time=09.559329
-----------------------------

Epoch 76: loss=6.5818|0.5027, acc=100.0000|90.5477, fr=0.4916, cin|cout=0.011565|0.037238|3.2198, lr=0.0004, time=09.641952
-----------------------------

Epoch 77: loss=6.5826|0.4963, acc=100.0000|90.6360, fr=0.4920, cin|cout=0.011566|0.037239|3.2198, lr=0.0004, time=09.577750
-----------------------------

Epoch 78: loss=6.5814|0.4995, acc=99.9877|90.6360, fr=0.4928, cin|cout=0.011566|0.037239|3.2197, lr=0.0003, time=09.658330
-----------------------------

Epoch 79: loss=6.5819|0.4937, acc=100.0000|90.5919, fr=0.4930, cin|cout=0.011566|0.037240|3.2196, lr=0.0003, time=09.616453
-----------------------------

Epoch 80: loss=6.5817|0.5000, acc=100.0000|90.8127, fr=0.4931, cin|cout=0.011566|0.037237|3.2195, lr=0.0003, time=09.592322
-----------------------------

Epoch 81: loss=6.5820|0.4946, acc=100.0000|90.4594, fr=0.4934, cin|cout=0.011566|0.037237|3.2195, lr=0.0003, time=09.695030
-----------------------------

Epoch 82: loss=6.5817|0.4989, acc=100.0000|90.6360, fr=0.4939, cin|cout=0.011566|0.037239|3.2196, lr=0.0003, time=09.627905
-----------------------------

Epoch 83: loss=6.5818|0.4925, acc=100.0000|90.7686, fr=0.4947, cin|cout=0.011567|0.037239|3.2195, lr=0.0003, time=09.588410
-----------------------------

Epoch 84: loss=6.5818|0.5041, acc=100.0000|90.4594, fr=0.4948, cin|cout=0.011567|0.037239|3.2195, lr=0.0002, time=09.636302
-----------------------------

Epoch 85: loss=6.5817|0.4964, acc=100.0000|90.7244, fr=0.4950, cin|cout=0.011567|0.037239|3.2193, lr=0.0002, time=09.580279
-----------------------------

Epoch 86: loss=6.5814|0.4945, acc=100.0000|90.5035, fr=0.4951, cin|cout=0.011568|0.037238|3.2191, lr=0.0002, time=09.609072
-----------------------------

Epoch 87: loss=6.5816|0.5001, acc=100.0000|90.6360, fr=0.4956, cin|cout=0.011568|0.037238|3.2189, lr=0.0002, time=09.683514
-----------------------------

Epoch 88: loss=6.5811|0.4946, acc=100.0000|90.9452, fr=0.4958, cin|cout=0.011569|0.037238|3.2189, lr=0.0002, time=09.607219
-----------------------------

Epoch 89: loss=6.5811|0.5040, acc=100.0000|91.0336, fr=0.4960, cin|cout=0.011569|0.037238|3.2188, lr=0.0002, time=09.563303
-----------------------------

Epoch 90: loss=6.5816|0.4929, acc=100.0000|90.8569, fr=0.4962, cin|cout=0.011569|0.037238|3.2188, lr=0.0001, time=09.857841
-----------------------------

Epoch 91: loss=6.5814|0.4993, acc=100.0000|90.4594, fr=0.4965, cin|cout=0.011569|0.037238|3.2188, lr=0.0001, time=09.792180
-----------------------------

Epoch 92: loss=6.5814|0.4996, acc=100.0000|90.4594, fr=0.4968, cin|cout=0.011569|0.037239|3.2187, lr=0.0001, time=09.584835
-----------------------------

Epoch 93: loss=6.5810|0.4940, acc=100.0000|91.0336, fr=0.4967, cin|cout=0.011569|0.037240|3.2188, lr=0.0001, time=09.626418
-----------------------------

Epoch 94: loss=6.5813|0.4921, acc=100.0000|90.8127, fr=0.4969, cin|cout=0.011570|0.037241|3.2188, lr=0.0001, time=09.589750
-----------------------------

Epoch 95: loss=6.5810|0.5005, acc=100.0000|90.5919, fr=0.4973, cin|cout=0.011570|0.037241|3.2188, lr=0.0001, time=09.626067
-----------------------------

Epoch 96: loss=6.5810|0.5023, acc=100.0000|90.7244, fr=0.4975, cin|cout=0.011570|0.037242|3.2188, lr=0.0001, time=09.630549
-----------------------------

Epoch 97: loss=6.5808|0.5045, acc=100.0000|90.3710, fr=0.4977, cin|cout=0.011570|0.037243|3.2189, lr=0.0001, time=09.611815
-----------------------------

Epoch 98: loss=6.5815|0.5009, acc=100.0000|90.5035, fr=0.4976, cin|cout=0.011570|0.037242|3.2188, lr=0.0001, time=09.641116
-----------------------------

Epoch 99: loss=6.5809|0.4998, acc=100.0000|90.9452, fr=0.4980, cin|cout=0.011570|0.037243|3.2188, lr=0.0001, time=09.650428
-----------------------------

Epoch 100: loss=6.5805|0.4974, acc=100.0000|90.3269, fr=0.4981, cin|cout=0.011571|0.037243|3.2188, lr=0.0001, time=09.634688
-----------------------------


Best valid acc at epoch 17: 92.57950530035336

------ Training finished ------

